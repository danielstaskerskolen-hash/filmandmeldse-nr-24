/*!
 * SDK version: 1.10.50
 * Commit: be8a8032b
 */
(()=>{"use strict";var e;Object.defineProperty&&function(){try{return Object.defineProperty({},"x",{}),!0}catch(e){return!1}}()||(Object.defineProperty=function(e,t,n){e[t]=n.value});var t=function(){var e,t,n,a,r;return{getContainer:function(){return e||(e=r.querySelector("#ancookie-container")),e},getMessageElement:function(){return t||(t=r.querySelector("#ancookie-msg")),t},getSliderElement:function(){return n||(n=r.querySelector("#ancookie-slider")),n},getNav:function(){return a||(a=r.querySelector("#ancookie-nav div")),a},setParentNode:function(e){r=e}}}();function n(e){return e.offsetWidth}var a="http://ib.adnxs.com/seg?add=1&redir=",r="//ib.adnxs.com/getuidj",i=!1;function s(){i||(i=!0,/^((?!chrome|android).)*safari/i.test(navigator.userAgent)?(function(){if("true"!==document.cookie.replace(/(?:(?:^|.*;\s*)anCookiesetFooter\s*\=\s*([^;]*).*$)|^.*$/,"$1")){var a=((r=document.createElement("div")).id="cookiemsg-slider",r.innerHTML='<style media="screen">.ancookie-header {\n  background: #d3d3d3;\n  text-overflow: ellipsis;\n  border-collapse: collapse;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  min-height: 38px;\n}\n\n.ancookie-header * {\n  font-size: 12px;\n  font-family: Verdana, Arial, Helvetica, sans-serif !important;\n  color: #555;\n  line-height: normal !important;\n  margin: 0;\n  padding: 0;\n}\n\n.ancookie-header p {\n  padding: 10px 10px 10px 38px;\n  text-align: left;\n}\n\n.ancookie-header a:link,\n.ancookie-header a:hover,\n.ancookie-header a:visited,\n.ancookie-header a:active {\n  color: #e6e6e6;\n  text-decoration: underline;\n  font-weight: 700;\n}\n\n.ancookie-header {\n  position: fixed;\n  opacity: 0.9;\n}\n\n.ancookie-header * {\n  font-size: 11px !important;\n}\n\n#ancookie-msg {\n  height: 34px;\n  opacity: 0;\n}\n\n@media only screen and (min-width: 1224px) {\n  .ancookie-header * {\n    font-size: 12px !important;\n  }\n\n  #ancookie-msg {\n    height: 20px;\n    opacity: 0;\n  }\n}\n\n@media only screen and (min-device-width: 768px) and (max-device-width: 1024px) {\n  .ancookie-header {\n    position: fixed;\n  }\n}\n\n.ancookie-header {\n  z-index: 9999;\n  opacity: 1;\n}\n\n#ancookie-slider {\n  overflow: hidden;\n  padding: 10px;\n  box-sizing: border-box;\n}\n\n#ancookie-slider p {\n  position: relative;\n  margin: 0;\n  padding: 0;\n  opacity: 0;\n  -webkit-column-gap: 20px;\n  -webkit-column-rule-width: 0;\n}\n\n#ancookie-nav {\n  position: absolute;\n  right: 0;\n  left: 0;\n  top: -11px;\n  z-index: 200;\n  text-align: center;\n}\n\n#ancookie-nav div {\n  display: inline-block;\n  padding: 0 10px;\n  background-color: #d3d3d3;\n  border-radius: 10px 10px 0 0;\n}\n\n#ancookie-nav span {\n  display: inline-block;\n  width: 6px;\n  height: 6px;\n  background-color: #e6e6e6;\n  border-radius: 50%;\n  margin: 1px 2px;\n  box-sizing: border-box;\n  -webkit-transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);\n  -webkit-opacity: 0.5;\n}\n\n#ancookie-nav span.selected {\n  background-color: #555;\n  -webkit-transition: all 0.5s cubic-bezier(0.23, 1, 0.32, 1);\n  -webkit-opacity: 1;\n}\n\n#ancookie-close {\n  position: absolute;\n  right: 5px;\n  bottom: 20px;\n  cursor: pointer;\n  -webkit-transform: scale(1.5);\n  transform: scale(1.5);\n}\n</style><div class="ancookie-header" id="ancookie-container">\n  <div id="ancookie-nav">\n    <div></div>\n  </div>\n  <div id="ancookie-slider">\n    <p id="ancookie-msg">Your browser blocks 3rd party cookies by default. By clicking on page you allow our partner AppNexus to place cookies to show relevant ads. Read more or opt out of these cookies <a href="https://www.appnexus.com/en/company/platform-privacy-policy#choices" target="_blank" style="color: #4f4f4f;">here</a>. This notice appears once </p>\n    <div id="ancookie-close">&times</div>\n  </div>\n</div>\n',r);document.body.appendChild(a),function(a){t.setParentNode(a),t.getContainer().querySelector("#ancookie-close").addEventListener("click",function(){a.remove()});var r,i=function(){var a=t.getSliderElement(),i=n(a),s=t.getMessageElement();s.setAttribute("style","-webkit-transition: none; -webkit-transform: translateX(0); -webkit-column-width: "+i+"px;");var o=t.getNav();o.innerHTML="",clearTimeout(r),r=setTimeout(function(){clearInterval(e),s.style.webkitTransition="opacity 0.3s ease-out",s.style.opacity=1;var r=a.scrollWidth+10;1<Math.round(r/i)&&(function(e){for(var t="<span class=selected></span>",n=1;n<2;n++)t+="<span></span>";e.innerHTML=t}(o),function(){var a,r=n(t.getSliderElement()),i={cycles:2,isFirstSlide:!0};e=setInterval(function(){i.cycles||clearInterval(e),a=i.isFirstSlide?1:0,i=function(e,n,a){var r=t.getMessageElement();r.style.webkitTransition="opacity 0.3s ease-out, -webkit-transform 1.2s cubic-bezier(0.23, 1, 0.32, 1)",r.style.webkitTransform="translateX("+e+"px)",0==e&&a.cycles--,a.isFirstSlide=!a.isFirstSlide;for(var i=t.getContainer().querySelectorAll("span"),s=0;s<i.length;s++)"selected"===i[s].className?i[s].removeAttribute("class"):i[s].setAttribute("class","selected");return a}(-1*a*r,0,i)},3e3)}())},300)};i(),window.addEventListener("resize",i)}(a),document.cookie="anCookiesetFooter=true; expires=Fri, 31 Dec 9999 23:59:59 GMT"}var r}(),function(e,t){var n;try{n=new XMLHttpRequest}catch(e){return}n.open("GET",e),n.withCredentials=!0,n.onreadystatechange=function(){if(4===n.readyState&&200===n.status)try{var e=JSON.parse(n.responseText);t(e)}catch(e){console.error(e)}},n.send()}(r,o)):console.log("Not safari, skipping link override"))}function o(e){console.log(e.uid),0===(parseInt(e.uid,10)||0)&&function(){console.log("Perfoming link override.");for(var e=0;e<document.links.length;e++){var t=document.links[e];t.href=a+encodeURIComponent(t.href)}}()}const d={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let c;const l=new Uint8Array(16);function u(){if(!c){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");c=crypto.getRandomValues.bind(crypto)}return c(l)}const p=[];for(let e=0;e<256;++e)p.push((e+256).toString(16).slice(1));const g=function(e,t,n){if(d.randomUUID&&!t&&!e)return d.randomUUID();const a=(e=e||{}).random||(e.rng||u)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=a[e];return t}return function(e,t=0){return(p[e[t+0]]+p[e[t+1]]+p[e[t+2]]+p[e[t+3]]+"-"+p[e[t+4]]+p[e[t+5]]+"-"+p[e[t+6]]+p[e[t+7]]+"-"+p[e[t+8]]+p[e[t+9]]+"-"+p[e[t+10]]+p[e[t+11]]+p[e[t+12]]+p[e[t+13]]+p[e[t+14]]+p[e[t+15]]).toLowerCase()}(a)};function m(e="",t=""){return!!location.href.includes("pleaseTrackMeAdTelemetry")||!!t&&(["adsdk.microsoft.com","adsdkprod.azureedge.net","adsdkpreprod.azureedge.net","adsdk.bing.net"].some(t=>e.includes(t))&&e.includes(`/${t}/`))}function f(...e){return e.filter(Boolean).join(".")}function h(e){return JSON.stringify(e,(e,t)=>t instanceof Error?{name:t.name,message:t.message,stack:t.stack}:t)}const y=()=>{try{return window.top?.location.href}catch(e){return window.location.ancestorOrigins?.length>0?window.location.ancestorOrigins[window.location.ancestorOrigins.length-1]:window.location.href}},b=()=>{const e=y();if(e){const t=300;return e.split("?")[0].substring(0,t)}};function v(e){return e.includes("ast/ast.js")}const w=new class{constructor(){this.sessionData={},this.placementData={},this.sampleRate=1,this.skipLogging=!1,this.inited=!1,this.populateSessionData()}populateSessionData(){const e=function(){const e=window?.devicePixelRatio||1,t=window?.screen.width,n=window?.screen.height;return{devicePixelRatio:e,width:t,height:n}}(),t=function(){const e=navigator?.connection||navigator?.mozConnection||navigator?.webkitConnection||null;return e?.effectiveType??"none"}();this.sessionData={sessionUuid:g(),ua:window.navigator.userAgent,url:b(),sdkType:"ast",sdkVersion:"1.10.50",screenWidth:Math.floor(e.width??0),screenHeight:Math.floor(e.height??0),dpr:e.devicePixelRatio,networkType:t,lang:navigator.language}}setSampleRate(e){this.sampleRate=y()?.includes("allowAdTelemetry=1")?1:e,this.skipLogging=this.skipLoggingBySampleRate()}skipLoggingBySampleRate(){return Math.random()>this.sampleRate}addSessionData(e){this.sessionData={...this.sessionData,...e}}addPlacementData(e,t){this.placementData[e]||(this.placementData[e]={}),this.placementData[e]={...this.placementData[e],...t}}getSessionData(){return this.sessionData}getPlacementData(e){return e?this.placementData[e]??{}:{}}};let I={endpoint:"https://bat.bing.net/adsdk/logs"};class k{skipLogging(e){if(e?.forceLogging)return!1;if(w.getSessionData().url?.includes("//localhost"))return!0;if(w.skipLogging){if(e?.sampling){const t=Math.max(0,Math.min(1,e.sampling));return Math.random()>t}return!0}return!1}isServiceAlreadyInited(e){{const t=Symbol.for(`isServiceAlreadyInited:ast:${e}`),n=!!window[t];return n||(window[t]=!0),n}}runOnlyIfLoggingEnabled(e){this.skipLogging()||e()}log(e,t,n){const a={...w.getSessionData(),...w.getPlacementData(t),...e,timestamp:(new Date).getTime()};if(!w.inited)throw Error(`Telemetry is not inited, call initTelemetry first. Event with type=${a.type} is ignored.`);this.skipLogging(n)||fetch(I.endpoint,{method:"POST",body:h(a),headers:{"Content-Type":"application/json"},credentials:"omit"})?.catch(e=>{})}}const E=new class extends k{trackEvent(e,t){this.log("string"==typeof e?{type:e}:e,t)}trackCustomEvent({type:e,...t},n,a){this.log({type:f("custom",e),data:t},n,a)}};var T;!function(e){e[e.Critical=1]="Critical",e[e.HighImpact=2]="HighImpact",e[e.Alert=3]="Alert"}(T||(T={}));const S=new class extends k{logError(e,t,n,a){const r=n;this.log({severity:e,type:f("error",t),message:n?.message,data:n?{filename:r?.filename,lineno:r?.lineno,colno:r?.colno,stack:r?.stack||n?.error?.stack,type:n?.type,debugData:n?.debugData}:void 0},a)}trackCriticalError(e,t,n){this.logError(T.Critical,e,t,n)}trackHighImpactError(e,t,n){this.logError(T.HighImpact,e,t,n)}trackAlertError(e,t,n){this.logError(T.Alert,e,t,n)}},_="impression",C="adClick",A=e=>f("mediation",e);var x,D;A("optIn"),A("optOut"),A("adServerRequest"),A("adServerRequestFill"),A("adServerRequestNoFill"),A("impression"),A("mrcView"),A("adClick"),A("timeout"),function(e){e.resource="resource",e.paint="paint",e.measure="measure"}(x||(x={})),function(e){e.firstContentfulPaint="first-contentful-paint",e.firstPaint="first-paint"}(D||(D={}));const $=new class extends k{constructor(){super(...arguments),this.resourcesToTrackFilters={sdksFiles:{filterFn:e=>m(e,"ast"),options:{serverTimings:!1}}},this.defaultOptions={logPaint:!1,logResources:!0,paintEventsToLog:[D.firstContentfulPaint]},this.options=this.defaultOptions,this.logPerformanceEntry=e=>{const{duration:t,name:n,startTime:a,entryType:r}=e;if(n.includes(I.endpoint))return;const i=(e,n={})=>{this.log({type:e,data:{startTime:Math.ceil(a),duration:Math.ceil(t),perfNow:performance.now(),...n}})};switch(!0){case this.options.logPaint&&r===x.paint:this.options.paintEventsToLog.includes(n)&&i(f("perf",x.paint,n));break;case this.options.logResources&&r===x.resource:for(const[t,{filterFn:a,options:r}]of Object.entries(this.resourcesToTrackFilters))if(a(n)){const a=e,s=r?.serverTimings?this.extractServerTimings(a):null,o={name:n,...s?{ttfb:s.ttfb,dnsLookup:s.dnsLookup,contentDownloadTime:s.contentDownloadTime,tcpHandshake:s.tcpHandshake,tlsTime:s.tlsTime,redirectTime:s.redirectTime,queueTime:s.queueTime,...s.serverTimings}:{}};if("sdksFiles"===t){const e=v(n);i(f("perf",x.resource,t),{...o,isMainSDKFile:e,...e?{websiteLoadStartTime:performance.timeOrigin}:{}})}else i(f("perf",x.resource,t),o);break}}}}disconnectPerfObserver(){this.observer&&this.observer.disconnect()}createStartMark(e){performance.mark(`${e}_start`)}trackMark(e,t,n){performance.mark(`${e}_end`),this.logMarks({measureName:e,startMarkName:`${e}_start`,endMarkName:`${e}_end`},t,n)}logMarks({measureName:e,startMarkName:t,endMarkName:n},a,r){const i=performance.measure(e,t,n);if(!i)return;const{duration:s}=i;this.log({type:f("perf",x.measure,e),data:{...a,duration:Math.ceil(s)}},r)}init(e){this.initOptions(e),this.connectPerfObserver(),this.options.logResources&&this.sendResourcesTiming(),this.options.logPaint&&this.sendPaintTiming()}initOptions(e){this.options={...this.defaultOptions,...e}}sendTimingPerfType(e){performance.getEntriesByType&&window.performance.getEntriesByType(e).forEach(this.logPerformanceEntry)}sendResourcesTiming(){this.sendTimingPerfType(x.resource)}sendPaintTiming(){this.sendTimingPerfType(x.paint)}connectPerfObserver(){if(window.PerformanceObserver&&!this.isServiceAlreadyInited("performance")){this.observer=new PerformanceObserver(e=>{e.getEntries().forEach(e=>this.logPerformanceEntry(e))});const e=[];this.options.logPaint&&e.push(x.paint),this.options.logResources&&e.push(x.resource),e.forEach(e=>{this.observer?.observe({type:e,buffered:!0})})}}addResourceToTrack(e,t,n){this.resourcesToTrackFilters[e]={filterFn:t,options:n}}extractServerTimings(e){const t=e.redirectEnd>0?e.redirectEnd-e.redirectStart:0,n=e.responseStart>0&&e.requestStart>0?e.responseStart-e.requestStart:0,a=e.domainLookupEnd>0?e.domainLookupEnd-e.domainLookupStart:0,r=e.responseEnd>0&&e.responseStart>0?e.responseEnd-e.responseStart:0,i=e.connectEnd>0?e.connectEnd-e.connectStart:0,s=e.secureConnectionStart>0?e.connectEnd-e.secureConnectionStart:0,o=e.domainLookupStart>0&&e.fetchStart>0?Math.max(0,e.domainLookupStart-e.fetchStart-t):0,d={},c=e.serverTiming;return c&&c.length>0&&c.forEach(e=>{d[`serverTiming_${e.name}`]=Math.ceil(e.duration||0)}),{ttfb:Math.ceil(n),dnsLookup:Math.ceil(a),contentDownloadTime:Math.ceil(r),tcpHandshake:Math.ceil(i),tlsTime:Math.ceil(s),redirectTime:Math.ceil(t),queueTime:Math.ceil(o),serverTimings:d}}};function q(e){return e}function M(e){return null!=e&&"function"!=typeof e&&function(e){return Number.isSafeInteger(e)&&e>=0}(e.length)}function R(e,t=q){if(!e)return e;const n=M(e)||Array.isArray(e)?function(e,t,n=1){if(null==t&&(t=e,e=0),!Number.isInteger(n)||0===n)throw new Error("The step value must be a non-zero integer.");const a=Math.max(Math.ceil((t-e)/n),0),r=new Array(a);for(let t=0;t<a;t++)r[t]=e+t*n;return r}(0,e.length):Object.keys(e);for(let a=0;a<n.length;a++){const r=n[a];if(!1===t(e[r],r,e))break}return e}function O(e){return Object.values(e)}function P(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}function L(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function N(e){if(null==e)return!0;if(M(e))return!!("function"==typeof e.splice||"string"==typeof e||"undefined"!=typeof Buffer&&Buffer.isBuffer(e)||(t=e,L(t))||function(e){return null!==e&&"object"==typeof e&&"[object Arguments]"===P(e)}(e))&&0===e.length;var t;if("object"==typeof e){if(e instanceof Map||e instanceof Set)return 0===e.size;const t=Object.keys(e);return function(e){const t=e?.constructor;return e===("function"==typeof t?t.prototype:Object.prototype)}(e)?0===t.filter(e=>"constructor"!==e).length:0===t.length}return!0}function U(e){return"number"==typeof e||e instanceof Number}function j(e){return"function"==typeof e}function F(e){return"string"==typeof e}const B=JSON.parse('{"H3":{"p":"utif_","C":"div_utif_"},"$9":{"Z":"WARN"},"Oi":{"M":"ast_debug","d2":"ast_dongle","c8":"ast_debug_member","AI":"ast_debug_bidder","Ux":"ast_test","Me":"ast_toolkit","eC":{"BASE":"ast_override_","DIV":"div","INDEX":"index","TAG_ID":"tag_id","INV_CODE":"inv_code","PUBLISHER_ID":"publisher_id"}},"ZJ":{"ZH":"undefined","qv":"object","uk":"number"},"Ss":{"IE":"msie","E":"opera"},"Sz":{"S":"loaded"},"sR":{"Yh":"/ut/v3","hK":"ib.adnxs.com","sp":"ib.adnxs-simple.com","VW":"/ut/v3/prebid","HM":"msft-ssp.adnxs.com"},"Me":{"Ve":"ad_type","D4":"banner","KB":"content"},"Ap":{"s6":"native"},"AD":{"Wy":"creative_id","Wo":"notify_url","JN":"no_ad_url","w$":"impression_urls","Q9":"trackers"},"AI":{"FF":"rtb","wm":"csm","A_":"ssm"},"Ve":{"D4":"banner","s6":"native","G_":"video"},"i$":{"Ji":"https://adsdkprod.azureedge.net/assets/video-mediation/v2.2.2/AstMediationManager.js","hn":"https://adsdkprod.azureedge.net/assets/mediation/v2.16.0/mediation.js","xF":"https://adsdkprod.azureedge.net/assets/sf/v1.0.0-1/safeframe-v2.html","I2":"https://adsdkprod.azureedge.net/assets/sf/v1.0.0-4/safeframe-v2.html","no":"https://acdn.adnxs.com/dmp/async_usersync.html","up":"https://adsdkprod.azureedge.net","_F":"https://adsdkprod.azureedge.net/assets/scripts/om/omid-verification-client-v1.js"},"qY":{"REQUEST":"adRequested","AVAILABLE":"adAvailable","LOADED":"adLoaded","LOADED_MEDIATED":"adLoadedMediated","LOADED_MEDIATED_VIDEO":"adLoadedMediatedVideo","AD_SLOT_RENDER_START":"adSlotRenderStart","NO_BID_MEDIATED":"adNoBidMediated","REQUEST_FAIL":"adRequestFailure","NO_BID":"adNoBid","DEFAULT":"adDefault","ERROR":"adError","COLLAPSE":"adCollapse","BAD_REQUEST":"adBadRequest","MRC_VIEW":"mrcView"},"eZ":{"FIRST_CONTENTFUL_PAINT":"first-contentful-paint","IFRAME_RENDER_START":"iframe-render-start"},"ZE":{"An":"String","pF":"Number","HX":"Boolean"},"l2":{"D":3000,"X":{"gH":"expanded","g":"collapsed","AR":"focus-change","VD":"geom-update","dl":"cmp"}},"uK":{"CREATIVE":"creative"},"nP":{"G":{"W":"adresponse","D":"impression"}},"H6":{"u":{"INITIAL":"initial","AZURE":"azure","INITIAL_PATCHED":"initialPatched"}},"Gy":{"L":{"lS":"kvParseError","Qs":"dvScriptError","R5":"adResponseError","Ny":"endpointError","SI":"omidLoadError","NV":"loggingError","im":"perfObserverError","PL":"paintEventError"}}}'),z=B.ZE.pF;let W=!1;const V=B.Oi.M,H=B.ZJ.ZH,G=B.AI.FF,J=B.AI.wm,X=B.AI.A_,Z=B.uK;let Y=null;try{Y="object"==typeof console.info&&null!==console.info?console.info:console.info.bind(window.console)}catch(e){}const K=function(e,t,n,a){e.addEventListener?e.addEventListener(t,n,a):e.attachEvent&&e.attachEvent(`on${t}`,n)},Q=function(e,t,n,a){e.removeEventListener?e.removeEventListener(t,n,a):e.detachEvent&&e.detachEvent(`on${t}`,n)},ee=function(){return window.console&&window.console.log},te=function(){const e=new Date;return`[${e.getHours()}:${e.getMinutes()}:${e.getSeconds()}:${e.getMilliseconds()}] `},ne=function(e,...t){if(le()&&ee()){const n=te(),a=Ie()?"SAFEFRAME MESSAGE: ":"MESSAGE: ";console.log(n+a+e,...t)}},ae=function(e,...t){if(le()&&ee()){const n=te(),a=Ie()?"SAFEFRAME WARN: ":"WARN: ";console.warn?console.warn(n+a+e,...t):console.log(n+a+e,...t)}},re=function(e,t,...n){if(le()&&ee()){const a=t||"GENERAL_ERROR",r=te(),i=Ie()?"SAFEFRAME ":"";console.error?console.error(`${r+i+a}: ${e}`,...n):console.log(`${r+i+a}: ${e}`,...n)}},ie=function(e){le()&&ee()&&console.timeStamp&&console.timeStamp(e)},se=function(e,t){if(le()&&ee()){const n=te();if(Y){t&&0!==t.length||(t="");const a=Ie()?"SAFEFRAME INFO: ":"INFO: ";Y(n+a+e+(""===t?"":" : params : "),t)}}},oe=function(e,t,n){{const a=e.document,r=a.createElement("script");r.type="text/javascript",r.async=!0,n&&"function"==typeof n&&(r.readyState?r.onreadystatechange=function(){"loaded"!==r.readyState&&"complete"!==r.readyState||(r.onreadystatechange=null,n())}:r.onload=function(){n()}),r.src=t;let i=a.getElementsByTagName("head");return i=i.length?i:a.getElementsByTagName("body"),i.length&&(i=i[0],i.insertBefore(r,i.firstChild)),r}},de=function(){let e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})},ce=function(e,t,n){let a;if(n=`anx_${n}${(new Date).getTime()}`,e&&t){a=new Image,a.id=n,a.src=t,a.height=0,a.width=0,a.style.display="none";try{e.insertBefore(a,e.firstChild);const t=setTimeout(()=>{if(a.parentNode)try{a.parentNode.removeChild(a)}catch(e){}clearTimeout(t)},5e3)}catch(e){re(`Error logging impression for tag: ${n} :${e.message}`)}return a}},le=function(){return!(!Ie()&&(ve().apntag=ve().apntag||{},apntag&&!1===apntag.debug&&!1===W&&(apntag.debug="TRUE"===ge(V).toUpperCase(),W=!0),!apntag||!apntag.debug))},ue=function(e){const t=apntag.requests.tags[e],n=t&&t.initCollapsed,a=n&&n.expandBy&&O(Z).indexOf(n.expandBy)>=0;return n&&a},pe=function(){try{return window.top.location.search}catch(e){try{return window.location.search}catch(e){return""}}},ge=function(e,t){const n=new RegExp(`[\\?&]${e}=([^&#]*)`).exec(t||pe());return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))},me=function(e,t){return e.hasOwnProperty?e.hasOwnProperty(t):typeof e[t]!==H&&e.constructor.prototype[t]!==e[t]},fe=function(e){let t=[];return Array.isArray(e)?t=e:F(e)&&t.push(e),t},he=function(e,t){if(N(e))return[];if(j(e.map))return e.map(t);const n=[];return R(e,(a,r)=>{n.push(t(a,r,e))}),n},ye=function(e,t,n){return null==t?n:F(t)?t:U(t)?t.toString():void ae(`Unsuported type for param: ${e} required type: String`)},be=function(e,t,n,a){return null==t?a:Object.prototype.toString.call(t)===`[object ${n}]`?t:(ae(`Unsuported type for param: ${e} required type: ${n}`),n===z&&(t=Number(t)),isNaN(t)?a:t)},ve=function(){return window},we=function(e){if(e&&e.length>0){if(e[0][G])return e[0][G];if(e[0][J])return e[0][J];if(e[0][X])return e[0][X]}};function Ie(){return!(typeof $sf===H||!$sf.ext||!$sf.ext.debug)}const ke=function(e){return B.H3.C+e?.targetId},Ee=function(){return B.i$.up},Te=function(e,t){let n;if(j(e))return function(){return e&&(n=e.apply(t||this,arguments),e=null),n}},Se=function(e,t){const n={};return["debug","displayed","initialHeight","initialWidth","invCode","member","showTagCalled","sizes","targetId","utCalled","utDivId","utiframeId","uuid","keywords"].forEach(t=>{n[t]=e[t]}),t&&(n.on=t.on,n.off=t.off,n.modifyTag=t.modifyTag,n.setKeywords=t.setKeywords),n},_e=function(e){apntag.requests.tags=apntag.requests.tags||{};let t=!0;return typeof apntag.requests.tags[e]===H&&(t=!1),t},Ce=function(){apntag.requests.hasLeft=!1,R(apntag.requests.tags,(e,t)=>{e.displayed||e.prebid||e.isMediated||(ae(`${t} is not displayed.`,B.$9.Z),apntag.requests.hasLeft=!0)}),apntag.requests.hasLeft||ne("all Tags are displayed.")},Ae=function(){let e=0;return function(){return e++,e}}(),xe=function(e){const t=[];let n={};if(Array.isArray(e)&&2===e.length&&!Array.isArray(e[0]))n.width=parseInt(e[0],10),n.height=parseInt(e[1],10),t.push(n);else if("object"==typeof e&&null!==e)for(let a=0;a<e.length;a++){const r=e[a];n={},n.width=parseInt(r[0],10),n.height=parseInt(r[1],10),t.push(n)}return t};function De(e){let t=["auto","auto"];if(e){const n=function(e){let t,n;if(Array.isArray(e)&&e.length>0)if(Array.isArray(e[0])&&e[0].length>0){const a=e[0];2===a.length&&"number"==typeof a[0]&&"number"==typeof a[1]&&(n=a[0],t=a[1])}else 2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&(n=e[0],t=e[1]);return[n,t]}(e);0!==n[0]&&1!==n[0]&&0!==n[1]&&1!==n[1]&&2!==n[1]&&(t=n)}return t}const $e=(e,t)=>{const n=t||document.getElementById(e);let a={},r={};if(n){a={width:n.offsetWidth,height:n.offsetHeight};const e=n.getBoundingClientRect();r={left:e.left+window.scrollX,top:e.top+window.scrollY}}return{size:a,position:r}},qe=function(e){return!(e&&apntag.requests.tags[e]&&!apntag.requests.tags[e].startRemove)},Me=(e,t,n,a,r)=>{let i;return i=e||(n?n.message:"Unable to identify error AST encountered, please try to check browser console for any errors on the page."),{code:a,errMessage:i,exception:n,targetId:t,tagData:r}},Re=Array.prototype.slice,Oe=he(B.qY,e=>e),Pe=function(){const e={},t={on:function(t,n,a){if(function(e){return Oe.includes(e)}(t)){const r={};r[n]=a,e[t]=e[t]||[],e[t].push(r)}else re(`Wrong event name : ${t} Valid event names :${Oe}`)},emit:function(t){!function(t,n){const a=n[0],r=Re.call(n,1);ne(`Emitting event for: ${t} for ad tag: ${a}`),R(e[t],e=>{let t="";if(t=me(e,"*")?e["*"]:e[a],null!=t&&"function"==typeof t)try{t.apply(null,r)}catch(e){re(`events._dispatch: Error executing event handler function: ${e.message}`)}})}(t,Re.call(arguments,1))},off:function(t,n,a){N(e[t])||R(e[t],e=>{"*"===n&&null!==e[Object.keys(e)[0]]&&void 0!==e[Object.keys(e)[0]]?void 0!==a&&Object.values(e)!==a||(e[Object.keys(e)[0]]=null):null!==e[n]&&void 0!==e[n]&&(void 0!==a&&e[n]!==a||(e[n]=null))})},get:function(){return e}};return t}(),Le=[];let Ne=!1;const Ue=B.i$.Ji,je=B.i$.hn,Fe=B.Me.Ve,Be=B.Ve.D4,ze=B.Ve.G_,We=B.qY.LOADED_MEDIATED,Ve=function(e,t,n,a){e===ze&&(null!==t&&Le.push(t),Ne&&window.APNVideo_AstMediationManager?R(Le,e=>{if(!e.called)try{window.APNVideo_AstMediationManager.selectAd(e.uuid,e,n,a),e.called=!0}catch(e){re("Error invoking video mediation","mediationmanager.js",null,e)}}):($.addResourceToTrack("AstMediationManager",e=>e.includes(Ue)),oe(window,Ue,()=>{Ve(ze,null,n,a)}),Ne=!0))},He=function(e){return e.isMediated||e.isRtbVideoFallback?e.adResponse.ad:e.adResponse.ads[0]},Ge=function(e){const t=e.content_source,n=e.ad_type;if(t)return e[t][n]},Je=new class{constructor(){this.config=null,this.activeFlights={},this.activeFlightsForTelemetry={}}init(e){const t=window.location.href,n=new URLSearchParams(new URL(t).search).get("ad-sdk-flights");n?"none"===n?(this.activeFlightsForTelemetry={},this.activeFlights={}):(this.setActiveFlightsFromQueryString(n),this.activeFlightsForTelemetry={}):(this.config=e,this.generateActiveFlights(),this.activeFlightsForTelemetry={...this.activeFlights})}generateActiveFlights(){if(!this.config)throw new Error("Config not initialized");for(const[e,t]of Object.entries(this.config.distributionGroups)){let n=0;for(const e of Object.values(t))n+=e.traffic;if(n>100)throw new Error(`Combined traffic for distribution group "${e}" exceeds 100`);const a=Math.floor(100*Math.random())+1;let r=0,i=null,s={traffic:0,samples:[]};for(const[e,n]of Object.entries(t))if(r+=n.traffic,a<=r){i=e,s=n;break}if(s.samples.length>0&&i){const e=Math.floor(Math.random()*s.traffic)+1;let t,n=0;for(const a of s.samples)if(n+=s.traffic/s.samples.length,e<=n){t=a;break}t&&(this.activeFlights[i]=t)}}}setActiveFlightsFromQueryString(e){const t=e.split(",");for(const e of t){const[t,n]=e.split(":");this.activeFlights[t]={name:n}}}getActiveFlightsForTelemetry(){return Object.entries(this.activeFlightsForTelemetry).map(([e,t])=>({name:e,sampleName:t.name}))}getActiveFlightsByName(e){return this.activeFlights[e]||null}reset(){this.config=null,this.activeFlights={}}};Je.init({distributionGroups:{safeFrame:{safeFrame_flight:{traffic:5,samples:[{name:"sfControl"},{name:"sfTreatment"}]}},outstream:{outstream_flight:{traffic:50,samples:[{name:"outstreamControl"},{name:"outstreamTreatment"}]}}}});const Xe=Je.getActiveFlightsForTelemetry();w.addSessionData({flights:Xe});const Ze=Je.getActiveFlightsByName("safeFrame_flight")?.name,Ye=Je.getActiveFlightsByName("outstream_flight")?.name,Ke=B.AI.FF,Qe=B.Me.D4,et=B.Me.KB,tt=(window.document.location.protocol,{}),nt={},at=function(e){const t=e.strategy,n=e.data,a=e.domElement,r=ve().document.createElement("iframe");return r.width=0,r.height=0,r.border="0",r.hspace="0",r.vspace="0",r.marginWidth="0",r.marginHeight="0",r.style.border="0",r.style.display="none",r.scrolling="no",r.frameBorder="0","WithContent"===t&&function(e,t,n){rt(e,n),e.contentWindow.document.open(),e.contentWindow.document.write(t),e.contentWindow.document.close()}(r,n,a),"WithAttributes"===t&&function(e,t,n){e.src=t.src,e.id=t.id,e.name=t.name,t.allow&&(e.allow=t.allow),t.sandbox&&(e.sandbox=t.sandbox),rt(e,n)}(r,n,a),"WithContentAndAttributes"===t&&function(e,t,n){{const a=t.content,r=t.attributes;rt(e,n),a&&(e.contentWindow.document.open(),e.contentWindow.document.write(a),e.contentWindow.document.close());for(const t in r)r.hasOwnProperty(t)&&e.setAttribute(t,r[t])}}(r,n,a),r};function rt(e,t){const n=ve();if(t){const a=t instanceof Element?t:n.document.getElementById(t);a&&a.appendChild(e)}else{const t=n.document.getElementsByTagName("body");t.length&&t[0].appendChild(e)}}function it(e){const t=e.targetId;let n="";return e.isMediated?(n=e.ad.mediatedContent,ne(`Invoking mediation for displaying banner ad: ${t}`)):e.adResponse&&1===e.adResponse.ads.length&&(n=we(e.adResponse.ads)[Qe][et]),function(e,t,n){const a=function(e,t){return t?"":`window.onerror = function(e) {\n        if(window.parent && window.parent.apntag) {\n          window.parent.apntag.recordErrorEvent(e,"${e}");\n          return true;\n        }\n      };`}(e,n),r=apntag.requests.tags[e],i={targetId:e,batchId:r?.batchId,adomain:r?.adResponse?.ads[0]?.adomain||"",buyerMemberId:r?.adResponse?.ads[0]?.buyer_member_id,msxCreativeId:r?.adResponse?.ads[0]?.msft?.msx_creative_id||"",crids:r?.adResponse?.ads[0]?.msft?.crids||"",auctionId:r?.adResponse?.auction_id||"",bidderId:r?.adResponse?.ads[0]?.bidder_id||""},s=function(e,t,n,a,r,i,s,o){return`(${function(e,t,n,a,r,i,s,o){let d=!1;try{new PerformanceObserver(function(c){const l=!(!window.$sf||!window.$sf.ext);c.getEntries().forEach(c=>{if("first-contentful-paint"===c.name&&!d){d=!0;const u={targetId:e,eventName:"first-contentful-paint",duration:c.duration,startTime:c.startTime,loadTime:c.loadTime,safeframe:l,adomain:n,buyerMemberId:a,msxCreativeId:r,crids:i,auctionId:s,bidderId:o,batchId:t};window.top&&(l?window.top.postMessage(u,"*"):window.top.postMessage(u))}})}).observe({entryTypes:["paint"]})}catch(t){window.top&&window.top.postMessage({targetId:e,eventName:"perfObserverError",error:t.message},"*")}}.toString()})("${e}", ${t}, "${n}", ${a}, "${r}", "${i}", "${s}", "${o}");`}(i.targetId,i.batchId,i.adomain,i.buyerMemberId,i.msxCreativeId,i.crids,i.auctionId,i.bidderId);return`<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd"><html><head>\n    <script>inDapIF=true;\n    apntag_targetId = "${e}";\n    ${a}\n    ${s}\n    <\/script>\n    </head>\n    <body>\n    <script>\n    document.body.id = "${e}";\n    <\/script>\n    ${t}\n    </body></html>`}(t,n,e.alwaysUseXDomainIframe||e.enableSafeFrame)}const st=(e,t)=>e.some(e=>e.brand.toLowerCase()===t),ot=window.navigator?.userAgentData??void 0,dt=window.navigator?.userAgent??"",ct=()=>{if(ot&&"platform"in ot){const e=ot.platform.toLowerCase();return/iphone/i.test(e)}return/iphone/i.test(dt.toLowerCase())},lt=function(){let e,t={};return{getInstance:function(){return e||(e={add:function(e,n){t[e]=n},getIframe:function(e){return me(t,e)?t[e]:null},getIframes:function(){return t},resetInstance:function(){t={}},removeIframe:function(e){return me(t,e)?(delete t[e],t):null}}),e}}}(),ut=B.H6.u,pt="https://acdn.adnxs-simple.com/ast/test/video/ANOutstreamVideo_test.js",gt="https://adsdk.microsoft.com/outstream/ANOutstreamVideo.js",mt=["start","pause","resume","complete","ClickTracking","impression","error","creativeView","RendererInitialized","loaded","firstQuartile"];function ft(e){switch(!0){case e===pt:return ut.INITIAL_PATCHED;case e===gt:return ut.AZURE;default:return ut.INITIAL}}function ht(e){return null!==e&&("object"==typeof e||"function"==typeof e)}const yt=function(){{let e={},t=[],n="";return{invokeNotify:r,loadRenderer:o,setRendererStatus:d,registerRenderer:c,clearState:a};function a(){e={},t=[]}function r(n,a,r){t.push(p(n,a,r)),R(e,e=>{e.addNotifyMessage(p(n,a,r)),e.status!==wt&&u(e)})}function i(e){return j(e)?{renderAd:e,notify:function(){}}:ht(e)&&j(e.renderAd)?{renderAd:e.renderAd,notify:e.notify}:void 0}function s(e,t,n){if(qe(t.targetId))ae(`Ad slot for this ad's renderer is not available.  It may have been removed by a removeTag call.  Bid: ${t}`);else{const r=He(t),i=(a=r.renderer_url,a?.includes("ANOutstreamVideo"));if(i&&t.rendererOptions&&function(e,t){if(!e||!t)return void ae("Invalid parameters for Outstream event monitoring setup");const{tagId:n,targetId:a,batchId:r}=e,i=function(e,t,n){return function(a,r,i,s,o){if(!mt.includes(r))return;const d={type:`outstream.${r}`,source:a,notificationType:r,targetId:i||t,performance:performance.now(),batchId:n};s&&(d.vastData=function(e){return e&&"object"==typeof e?{duration:e.duration,width:e.width,height:e.height,adType:e.adType,hasError:!!e.error}:{}}(s)),o&&(d.adUnitData=function(e){return e&&"object"==typeof e?{width:e.width,height:e.height,isExpanded:e.isExpanded,isCompleted:e.isCompleted,currentTime:e.currentTime}:{}}(o)),E.trackCustomEvent(d,e,{forceLogging:!0})}}(n,a,r);if(t.cbNotification){const e=t.cbNotification;t.cbNotification=function(t,n,a,r,s){i(t,n,a,r,s),e(t,n,a,r,s)}}else t.cbNotification=i}(t,t.rendererOptions),j(e)?e.call(apntag,t,n):ht(e)&&(j(e.renderFn)?e.renderFn.call(apntag,t,n):re("Error invoking rendererObj.renderAd(). renderAd must be a function")),i){const e=ft(r.renderer_url);E.trackCustomEvent({type:"outstream.astRendererRenderInvoked",rendererSource:e,rendererUrl:r.renderer_url,batchId:t.batchId})}}var a}function o(t,n){const a=n.renderer_url?.includes("ANOutstreamVideo.js");let r=kt.INITIAL;if(a){!0===apntag.requests.loadOutstreamUpgradeUrl&&(n.renderer_url=pt);const e=ft(n.renderer_url);"outstreamTreatment"===Ye&&(n.renderer_url=gt),r=ft(n.renderer_url),E.trackCustomEvent({type:"outstream.setRendererUrl",rendererSource:r,originalRendererSource:e,rendererUrl:n.renderer_url,batchId:t.batchId})}let i=n.renderer_id;if(t.enableSafeFrame&&(!window.$sf||!window.$sf.ext))return i=f(t,n),void(e[i]=m(n.renderer_url,i,t));const o=e[i];if(o){const n=e[i];o.status===It?(b(t),s(n,t,l),t.displayed=!0):o.addTag(t)}else{const s=function(){a&&E.trackCustomEvent({type:"outstream.astRendererScriptLoaded",rendererUrl:n.renderer_url,batchId:t.batchId,rendererSource:r})};oe(window,n.renderer_url,s),e[i]=m(n.renderer_url,i,t),a&&E.trackCustomEvent({type:"outstream.astRendererInited",rendererUrl:n.renderer_url,batchId:t.batchId,rendererSource:r})}}function d(t,n){const a=e[t];a&&(a.status=n,u(a))}function c(t,a,r){if(n=r,a=i(a),t&&e[t]&&ht(a)){const n=e[t];n.renderFn=a.renderAd,n.notifyFn=a.notify,n.status=It,window.currentTag&&window.currentTag.enableSafeFrame&&y(window.currentTag,t,It),u(n),R(n.getTags(),e=>{e.displayed||(b(e),s(n.renderFn,e,(e,t)=>{l(e,t,n)}),e.displayed=!0)})}else re("ast.js",null,"registerRenderer must be called with (id, cbFn)")}function l(e,t,n){n&&n.isSafeFrame?w(e,t,n):apntag.emitEvent(e,t)}function u(e){j(e.notifyFn)&&R(e.getNotifyMessages(),t=>{t.sent||(t.sent=!0,e.notifyFn(t.messageType,t.messagePayload,t.targetId))})}function p(e,t,n){return{messageType:e,messagePayload:t,targetId:n,sent:!1}}function g(e,t,n){const a=[],r=[];this.getTags=function(){return a},this.addTag=function(e){a.push(e)},this.addNotifyMessage=function(e){r.push(e)},this.getNotifyMessages=function(){return r},this.url=e,this.id=t,this.status=wt,this.renderFn=function(){},this.notifyFn=h,this.isSafeFrame=n.enableSafeFrame||!1,this.safeFrameSizes=n.sizes,this.addTag(n)}function m(e,t,n){const a=new g(e,t,n);return v(a),a}function f(e,t){return`${t.renderer_id}_${e.targetId}`}function h(e,t,n){n=n||this.getTags()[0].targetId,ca(e,t,n)}function y(e,t,a){const r={name:"updateRenderStatus",targetId:e.targetId,rId:t,status:a};Et(window.parent,r,n)}function b(e){if(e&&e.isMediated)return;const t=He(e);ce(window.document.body,t[bt],t[vt])}function v(e){R(t,t=>{e.addNotifyMessage(t)})}function w(e,t,a){const r={name:"emitEvent",cmd:[e,t]};if(Et(window.parent,r,n),apntag.mockSfListner&&apntag.mockSfListner.handler){apntag.mockSfListner.handler(apntag.mockSfListner.adObj);const t={name:"resizeAd",targetId:e,cmd:De(a.safeFrameSizes)};Et(window.parent,t,n)}}}}(),bt=B.AD.Wo,vt=B.AD.Wy,wt="loading",It="loaded",kt=B.H6.u,Et=function(e,t,n){"string"!=typeof t&&(t=JSON.stringify(t)),e?e.postMessage(t,n):ne("Safeframe not yet rendered")};var Tt=window.document,St="compatMode",_t="documentElement",Ct="nodeType",At="hidden",xt="auto",Dt="contains",$t="scroll",qt="clip",Mt=window.Number,Rt=Mt&&Mt.MAX_VALUE,Ot=-1*Rt,Pt="compareDocumentPosition",Lt="number",Nt="toLowerCase",Ut="toFixed",jt="elementFromPoint",Ft="length",Bt="overflow",zt="document",Wt="onscroll",Vt=window.String,Ht=window.Math,Gt=Math.max,Jt=Math.min,Xt=Math.round,Zt=window,Yt=window.navigator,Kt=Yt.userAgent||"",Qt=!(!window.ActiveXObject&&"ActiveXObject"in window)&&Zt&&"ActiveXObject"in Zt,en=null,tn=!0,nn=!1,an=function(){var e,t={};t.ie=t.opera=t.gecko=t.webkit=t.safari=t.chrome=t.air=t.ipod=t.ipad=t.iphone=t.android=t.webos=t.silk=t.nodejs=t.phantomjs=0,t.mobile=t.ios=t.caja=Yt&&Yt.cajaVersion;var n=Kt;return n&&(Dn(/KHTML/,n)&&(t.webkit=1),Dn(/IEMobile|XBLWP7/,n)&&(t.mobile="windows"),Dn(/Fennec/,n)&&(t.mobile="gecko"),(e=xn(n,/AppleWebKit\/([^\s]*)/,1))&&(t.webkit=An(e),t.safari=t.webkit,Dn(/PhantomJS/,n)&&(e=xn(n,/PhantomJS\/([^\s]*)/,1))&&(t.phantomjs=An(e)),Dn(/ Mobile\//,n)||Dn(/iPad|iPod|iPhone/,n)?(t.mobile="Apple",e=(e=xn(n,/OS ([^\s]*)/,1))&&An(e.replace("_",".")),t.ios=e,t.ipad=t.ipod=t.iphone=0,(e=xn(n,/iPad|iPod|iPhone/,0))&&(t[e[Nt]()]=t.ios)):((e=xn(n,/NokiaN[^\/]*|Android \d\.\d|webOS\/\d\.\d/,0))&&(t.mobile=e),Dn(/webOS/,n)&&(t.mobile="WebOS",(e=xn(n,/webOS\/([^\s]*);/,1))&&(t.webos=An(e))),Dn(/ Android/,n)&&(t.mobile="Android",(e=xn(n,/Android ([^\s]*);/,1))&&(t.android=An(e))),Dn(/Silk/,n)&&(e=xn(n,/Silk\/([^\s]*)\)/,1))&&(t.silk=An(e))),(e=n.match(/(Chrome|CrMo)\/([^\s]*)/))&&e[1]&&e[2]?(t.chrome=An(e[2]),t.safari=0,"CrMo"===e[1]&&(t.mobile="chrome")):(e=xn(n,/AdobeAIR\/([^\s]*)/))&&(t.air=e[0])),t.webkit||((e=xn(n,/Opera[\s\/]([^\s]*)/,1))?(t.opera=An(e),(e=xn(n,/Opera Mini[^;]*/,0))&&(t.mobile=e)):(e=xn(n,/MSIE\s([^;]*)/,1))?t.ie=An(e):(e=xn(n,/Gecko\/([^\s]*)/))&&(t.gecko=1,(e=xn(n,/rv:([^\s\)]*)/,1))&&(t.gecko=An(e))))),t}(),rn=an.ie||0,sn=an.webkit||0,on=an.gecko||0,dn=an.opera||0,cn=0,ln={},un=$t+"Width",pn=$t+"Height",gn=$t+"Top",mn=$t+"Left",fn="offset",hn=fn+"Parent",yn=fn+"Top",bn=fn+"Left",vn=fn+"Width",wn=fn+"Height",In="clientWidth",kn="clientHeight";function En(e){var t,n,a,r,i,s,o,d,c,l={t:0,l:0,r:0,b:0,w:0,h:0,z:0},u="getBoundingClientRect",p=0,g=0,m=0,f=0,h=nn,y=On(e)||Zt[zt],b=y[St],v=y.documentMode||0;if(Tn(e))try{if(i=qn(e),t=Pn(e),n=zn(e),l.l=e[bn]||0,l.t=e[yn]||0,a=e,r=en,h=on||sn>519,e!==t&&u&&e[u])Qt&&(!v||v>0&&v<8||"BackCompat"===b)&&(o=t.clientLeft,d=t.clientTop),c=e[u](),l.t=c.top,l.l=c.left,(o||d)&&(l.l-=o,l.t-=d),(n.y||n.x)&&(!an.ios||an.ios>=4.2)&&(l.l+=n.x,l.t+=n.y);else{for(;(a=a[hn])&&Tn(a)&&r!==a;)o=a[bn],d=a[yn],l.t+=d,l.l+=o,h&&(l=Mn(a,l)),r=a;if("fixed"!=i.position){for(a=e,r=en;(a=a.parentNode)&&Tn(a)&&r!==a&&a!=t;)p=a[gn],g=a[mn],on&&"visible"!=(s=qn(a))[Bt]&&(l=Mn(a,l,s)),(p||g)&&(l.l-=g,l.t-=p),r=a;l.l+=n.x,l.t+=n.y}else l.l+=n.x,l.t+=n.y}e==t?(f=e[kn],m=e[In]):(f=e[wn],m=e[vn]),l.b=l.t+f,l.r=l.l+m,l.w=Gt(m,0),l.h=Gt(f,0),l.z=i.zIndex}catch(e){l={t:0,l:0,r:0,b:0,w:0,h:0,z:0}}return l}function Tn(e){return 1===Sn(e)}function Sn(e){return Nn(e&&e.nodeType,-1)}function _n(e){return(e=Cn(e))&&-1==e.search(/\D+/g)||e&&-1!=e.search(/px/gi)?tn:void 0}function Cn(e){var t=typeof e;return"string"==t?e:t!=Lt||e?"object"==t&&e&&e.join?e.join(""):!1===e?"false":!0===e?"true":e?Vt(e):"":"0"}function An(e){var t=0;return parseFloat(e.replace(/\./g,function(){return 1==t++?"":"."}))}function xn(e,t,n){var a=e&&e.match(t);return n==en?a:a&&a[n]||en}function Dn(e,t){return e.test(t)}function $n(e){var t,n=en,a="parentWindow",r="defaultView";try{e&&((n=e[a]||e[r]||en)||(n=(t=On(e))&&(t[a]||t[r])||en))}catch(e){n=en}return n}function qn(e){var t;if($n(e).getComputedStyle)try{t=$n(e).getComputedStyle(e,en)}catch(e){t=en}else try{t=e.currentStyle}catch(e){t=en}return t}function Mn(e,t,n){var a=0,r=0;return(n=n||qn(e))&&(a=n.borderTopWidth,r=n.borderLeftWidth,a=_n(a)?Nn(a,0):0,r=_n(r)?Nn(r,0):0,on&&/^t(?:able|d|h|r|head|foot)$/i.test(jn(e))&&(a=r=0)),(t=t||{t:0,l:0}).t+=a,t.l+=r,t}function Rn(e){return e&&(e.parentNode||e.parentElement)}function On(e){var t=en;try{e&&(t=9==Sn(e)?e:e[zt]||e.ownerDocument||en)}catch(e){t=en}return t}function Pn(e){var t=e&&On(e)||Tt,n=t[St],a=t[_t];return n&&!dn&&"CSS1Compat"!=n&&(a=t.body),a}function Ln(e){var t,n,a,r,i=[-1,-1,-1,-1],s=[qt+"Top",qt+"Right",qt+"Bottom",qt+"Left"],o=0;if(!e)return i;if(rn)for(;n=s[o];)_n(t=e[n])&&(t=Nn(t,-1))>=0&&(i[o]=t),o++;else if((t=e[qt])&&-1!=t.search(/\d+/g))for(r=(i=(i=(t=t.replace(/\w+\(([^\)]*?)\)/g,"$1")).split(" "))[Ft]<=1?i.split(","):i)[Ft],o=0;r--;)_n(a=i[o])?i[o]=Nn(a,-1):i[o]=-1,o++;return i}function Nn(e,t,n,a){if(typeof e!=Lt)try{e=e?parseFloat(e):Mt.NaN}catch(t){e=Mt.NaN}return a==en&&(a=Rt),n==en&&(n=Ot),(isNaN(e)||e<n||e>a)&&t!=en?t:e}function Un(e,t){var n=nn,a=e&&e[Ct]||-1,r=t&&t[Ct]||-1;if(1==a&&-1!=r)if(e[Dt])if(dn||1==r)n=e[Dt](t);else for(;t;){if(e===t){n=tn;break}t=t.parentNode}else e[Pt]&&(n=e===t||!!(16&e[Pt](t)));return n}function jn(e){return e&&1==e[Ct]&&e.tagName[Nt]()||""}function Fn(e,t,n){try{arguments[Ft]>2?n===en?e.removeAttribute(t):(n=Cn(n),"class"==t[Nt]()?e.className=n:e.setAttribute(t,n)):n=Cn(e.getAttribute(t))}catch(e){n=""}return n}function Bn(e){return Cn([e||"","_",(new Date).getTime(),"_",Ht.round(100*Ht.random()),"_",cn++])}function zn(e){var t,n,a,r,i={x:0,y:0,w:0,h:0},s={scrollLeft:0,scrollTop:0,scrollWidth:0,scrollHeight:0},o=0,d=0;return n=(t=On(e)||Tt)[_t]||s,r=t.body||s,(a=t.defaultView)&&(o=Nn(a.pageXOffset,0),d=Nn(a.pageYOffset,0)),i.x=Gt(n.scrollLeft,r.scrollLeft,o),i.y=Gt(n.scrollTop,r.scrollTop,d),i.w=Gt(n.scrollWidth,r.scrollWidth,0),i.h=Gt(n.scrollHeight,r.scrollHeight,0),i}function Wn(e,t,n){var a,r,i,s,o,d,c,l,u,p,g,m,f={},h={};if(function(e,t,n){var a,r,i,s,o,d,c,l,u,p,g,m,f,h,y,b,v,w,I,k,E,T,S,_,C,A,x,D,$,q,M,R,O,P,L,N=e&&Rn(e),U=Pn(e),j=En(e),F=En(U),B=zn(U),z=function(e){var t=Pn(e),n=0,a=0;return t&&(n=t.scrollWidth||0,a=t.scrollHeight||0),{t:0,l:0,b:a,r:n,w:n,h:a}}(e),W={t:0,l:0,r:0,b:0,w:0,h:0},V={t:0,l:0,r:0,b:0,xs:0,ys:0,xiv:0,yiv:0,iv:0,w:0,h:0},H=[],G=nn,J={left:en,right:en,top:en,bottom:en};if(t=t&&"object"==typeof t?t:{},N)for(a=F.t,r=F.l,i=F.r,s=F.b;(c=qn(N))&&("block"!=c.display&&"absolute"!=c.position&&"none"==c.float&&"none"==c.clear||(G=N==U,p=(P=En(N)).t,g=P.l,m=P.r,f=P.b,k=c[Bt+"X"],E=c[Bt+"Y"],T=c[Bt],S=G?[-1,-1,-1,-1]:Ln(c),L=nn,G?(h=B.w,v=B.h):(h=N[un],v=N[pn]),y=N[vn],w=N[wn],b=N[In],I=N[kn],!d&&y>b&&(d=y-b),!o&&w>I&&(o=w-I),G?(h>b&&((g=0)>r&&(r=g),(m=(Zt.innerWidth||y)+B.x)<i&&(i=m)),v>I&&((p=0)>a&&(a=p),(f=(Zt.innerHeight||w)+B.y)<s&&(s=f))):(d&&m-g==y&&(m-=d),o&&f-p==w&&(f-=o),k!=At&&k!=$t&&k!=xt&&T!=At&&T!=$t&&T!=xt||(g>r&&(r=g,J.left=N),m<i&&(i=m,J.right=N),(k==$t||T==$t||(k==xt||T==xt)&&h>b)&&(H.push(N),L=tn)),S[3]>0&&(D=g+S[3])>r&&(r=D,J.left=N),S[1]>0&&($=m+S[1])<i&&(i=$,J.right=N),E!=At&&E!=$t&&E!=xt&&T!=At&&T!=$t&&T!=xt||(p>a&&(a=p,J.top=N),f<s&&(s=f,J.bottom=N),L||(E==$t||T==$t||(E==xt||T==xt)&&v>I)&&(H.push(N),L=tn)),S[0]>0&&(A=p+S[0])>a&&(a=A,J.top=N),S[2]>0&&(x=P.t+S[2])<s&&(s=x,J.bottom=N))),N!=U)&&(N=Rn(N))&&jn(N););(W={t:Gt(a,0),l:Gt(r,0),r:Gt(i,0),b:Gt(s,0)}).w=Gt(W.r-W.l,0),W.h=Gt(W.b-W.t,0),g=j.l,m=j.r,p=j.t,l=m-g,u=(f=j.b)-p,D=W.l,$=W.r,A=W.t,x=W.b,C=(C=(C=Jt(f,x)-Gt(p,A))<0?0:C)>u?u:C,_=(_=(_=Jt(m,$)-Gt(g,D))<0?0:_)>l?l:_,V.t=A<p?x<=p?0:Gt(p-A,0):0,V.b=x>f?f<=A?0:Gt(x-f,0):0,V.l=D<g?$<=g||x<=p||f<=A?0:Gt(g-D,0):0,V.r=$>m?m<=D||x<=p?0:Gt($-m,0):0,V.w=Gt(V.r-V.l,0),V.h=Gt(V.b-V.t,0),V.xiv=l>0?Nn((_/l)[Ut](2)):0,V.yiv=u>0?Nn((C/u)[Ut](2)):0,V.iv=l>0||u>0?Nn((_*C/(l*u))[Ut](2)):0,V.civ=0,n&&V.iv>.49&&(O=function(e){var t,n,a,r,i,s,o,d,c,l,u,p,g,m,f,h,y=En(e),b=On(e),v=Pn(b),w=y.t,I=y.l,k=[],E=0;if(k.on=0,t=y.w,n=y.h,i=a=Xt(t/10),s=r=Xt(n/10),t<=1||n<=1||a<1||r<1)return k;if(f=(h=zn()).y,m=h.x,p=I+t,g=w+n,b&&v&&b[jt]){for(;i<t;){for(s=r;s<n;)d=w+s,(o=I+i)<=p&&d<=g&&k.push({x:o,y:d,on:0}),s+=r;i+=a}for(;c=k[E++];)o=Gt(c.x-m,0),o=Jt(o,c.x),d=Gt(c.y-f,0),d=Jt(d,c.y),0!=o?0!=d?(u=b[jt](o,d))&&u!==v&&u!==e&&!Un(u,e)&&((l=Fn(u,"id"))||Fn(u,"id",l=Bn("geom_inter")),c.on=l,k.on++):(c.on="!y-offscreen",k.on++):(c.on="!x-offscreen",k.on++)}return k}(e),q=O[Ft],(M=Nn(O.on,0))&&(R=1-Nn((M/q)[Ut](2),0),V.civ=V.iv=R)),t.rect=j,t.clipRect=W,t.docRect=z,H[Ft]?(t.isRoot=nn,t.canScroll=tn,V.xs=!!o,V.ys=!!d):F.b>=W.b||F.r>=W.r?(t.isRoot=tn,V.xs=!!(z.w>F.w&&o),V.ys=!!(z.h>F.h&&d),t.canScroll=z.w>F.w||z.h>F.h):V.ys=V.xs=t.isRoot=t.canScroll=nn,t.scrollNodes=H,t.clipNodes=J,t.expRect=V}(t,h,tn),!n&&!h.isRoot&&h.canScroll&&((r=h.expRect).xs||r.ys)){Hn(e),a=[],ln[e]=a;for(var y=0;y<h.scrollNodes.length;y++){var b=h.scrollNodes[y],v={};v.node=b,v[Wt]=function(t){Vn(0,e,b)},K(b,$t,v[Wt]),a.push(v)}}return f.win=(d=(o=Zt).innerHeight||0,c=o.innerWidth||0,u=d+(l=o.screenY||o.screenTop||0),g=c+(p=o.screenX||o.screenLeft||0),m=Pn(s),d||c||!m||(d=m.clientHeight||0,g=p+(c=m.clientWidth||0),u=l+d),{t:l,l:p,b:u,r:g,w:c,h:d}),f.par=h.clipRect,r=h.expRect,(i=h.rect).iv=r.iv,i.xiv=r.xiv,i.yiv=r.yiv,delete r.iv,delete r.xiv,delete r.yiv,f.exp=r,f.self=i,f}function Vn(e,t,n){var a=ln[t];if(a)for(var r=0;r<a.length;r++){var i=a[r];if(i.node===n){i.tID&&(clearTimeout(i.tID),delete i.tID),i.tID=setTimeout(function(){var e=lt.getInstance().getIframe(t);e&&oa(e.iframe,t,Wn(t,e.iframe,tn))},ta);break}}}function Hn(e){var t,n=ln[e];if(n)for(;t=n.pop();)t.tID&&clearTimeout(t.tID),Q(t.node,$t,t[Wt]),t.node=t[Wt]=en,ln[e]=en;delete ln[e]}let Gn,Jn,Xn=!0;const Zn=function(e,t){Jn=e;const n=t;let a,r;function i(e){const t=Xn?"tcString":"consentData";Xn&&e&&e.gdprApplies&&(e.purpose&&e.purpose.consents&&!e.purpose.consents[1]?Na(!0):e.purpose&&e.purpose.consents&&!0===e.purpose.consents[1]&&Na(!1));const n={consent_string:e?e[t]:void 0,consent_required:e?e.gdprApplies:void 0};if(e&&e.addtlConsent&&"string"==typeof e.addtlConsent&&-1!==e.addtlConsent.indexOf("~")){const t=e.addtlConsent.substring(e.addtlConsent.indexOf("~")+1);n.addtl_consent=he(t.split("."),e=>parseInt(e,10))}Jn.gdpr_consent=n}function s(e){clearTimeout(a),i(Gn),Te(o(e))}function o(e){e&&ae(`${e} Resuming request without consent information.`),n()}if(Jn.consentManagement&&(Jn.consentManagement.disabled||Jn.consentManagement.tcf&&Jn.consentManagement.tcf.disabled))return se("TCF Consent module was disabled."),Te(o());let d=1e4;if(Jn.consentManagement&&U(Jn.consentManagement.timeout)&&(d=Jn.consentManagement.timeout),Gn)return i(Gn),Te(o());a=setTimeout(function(){s(Gn?"":"CMP workflow exceeded timeout threshold.")},d),function(e,t){const n={};try{r=window.__tcfapi||window.top.__tcfapi,r||(r=window.__cmp||window.top.__cmp,r&&(Xn=!1))}catch(e){}if(j(r))r(Xn?"addEventListener":"getConsentData",null,e);else if(window.$sf&&window.$sf.ext&&"function"==typeof window.$sf.ext.cmp)Xn=!1,function(){const t=Object.keys(Jn.tags),n=xe(Jn.tags[t[0]].sizes);window.$sf.ext.register(n[0].width,n[0].height,function(t,n){"cmpReturn"===t&&e(n.vendorConsentData)}),window.$sf.ext.cmp("getConsentData")}();else{let a,r=window;for(;!a;){try{(r.frames.__tcfapiLocator||r.frames.__cmpLocator)&&(a=r),r.frames.__cmpLocator&&(Xn=!1)}catch(e){}if(r===window.top)break;r=r.parent}if(!a)return t("TCF CMP not found.");!function(t){const a=Xn?"__tcfapi":"__cmp";function r(e){const t=Xn?"__tcfapiReturn":"__cmpReturn",a="string"==typeof e.data&&e.data.includes(t)?JSON.parse(e.data):e.data;if(a[t]){const e=a[t];n[e.callId](e.returnValue,e.success),Xn||delete n[e.callId]}}function i(t,n){Xn||Q(window,"message",r,!1),e(t,n)}window[a]=function(e,r,i){const s=`${Math.random()}`,o={[`${a}Call`]:{command:e,parameter:r,callId:s}};n[s]=i,t.postMessage(o,"*")},K(window,"message",r,!1),Xn?window.__tcfapi("addEventListener",null,i):window.__cmp("getConsentData",null,i)}(a)}}(function(e,t){Xn?!t||"object"!=typeof e||null===e||!0===e.gdprApplies&&"string"!=typeof e.tcString?s(`TCF CMP returned unexpected consentObject during lookup process; returned value was (${e})`):"useractioncomplete"===e.eventStatus||"tcloaded"===e.eventStatus?(clearTimeout(a),Gn=e,i(Gn),Te(o())):"cmpuishown"===e.eventStatus&&(Gn=e,e.tcString&&e.purposeOneTreatment&&(clearTimeout(a),i(Gn),Te(o()))):"object"!=typeof e||null===e||"string"!=typeof e.consentData||""===e.consentData?s(`CMP returned unexpected consentObject during lookup process; returned value was (${e})`):(clearTimeout(a),Gn=e,i(Gn),Te(o()))},s)},Yn=B.ZE.pF;let Kn=0,Qn=0,ea=0;const ta=500,na=function(e,t){{const n=Wn(e,t);return n.anx=function(){try{if(void 0!==window.top.location.href){let e=window,t=0,n=0;do{t+=e.pageYOffset||e.document.documentElement.scrollTop||e.document.body.scrollTop,n+=e.pageXOffset||e.document.documentElement.scrollLeft||e.document.body.scrollLeft,e=e.parent}while(e.parent!==window.top);return{scrollTop:t,scrollLeft:n}}}catch(e){}return{scrollTop:0,scrollLeft:0}}(),n}},aa=function(){ia(!0)},ra=function(){ia(!1)};function ia(e){sa(),Qn=window.setTimeout(()=>{var t;t=e,R(lt.getInstance().getIframes(),(e,n)=>{const a=apntag.requests.tags[n];if(a.alwaysUseXDomainIframe||a.enableSafeFrame){const a=e.iframe.contentWindow,r={};r.targetId=n,r.value=t,r.status=B.l2.X.AR,Et(a,JSON.stringify(r),Ee())}}),sa()},2)}function sa(){Qn&&(clearTimeout(Qn),Qn=0)}const oa=function(e,t,n){{const a=e.contentWindow,r={};r.targetId=t,r.geom=n,r.status=B.l2.X.VD,Et(a,JSON.stringify(r),Ee())}},da=function(){Kn||(Kn=window.setTimeout(la,ta))},ca=function(e,t,n){{const a=lt.getInstance().getIframe(n).iframe.contentWindow;Et(a,{messageType:e,messagePayload:t,status:"notify",targetId:n},Ee())}};function la(){R(lt.getInstance().getIframes(),(e,t)=>{const n=apntag.requests.tags[t];(n.alwaysUseXDomainIframe||n.enableSafeFrame)&&function(e,t){oa(e,t,na(t,e))}(e.iframe,t)}),Kn&&(clearTimeout(Kn),Kn=0)}const ua=ve();function pa(e){at({strategy:"WithAttributes",data:{id:"itunes-launch-store",src:e.detail.url}})}const ga=[],ma={},fa={},ha=[],ya={},ba=Te(function(){K(ua,"focus",aa),K(ua,"blur",ra),K(ua,"resize",da),K(ua,"scroll",da),K(ua,"pagehide",()=>{try{Q(ua,"focus",aa),Q(ua,"blur",ra),Q(ua,"resize",da),Q(ua,"scroll",da),R(lt.getInstance().getIframes(),(e,t)=>{const n=apntag.requests.tags[t];(n.alwaysUseXDomainIframe||n.enableSafeFrame)&&(clearInterval(ea),ea=0,Hn(t))})}catch(e){}})}),va=ve(),wa=/^http(s)?:\/\/outlook(-sdf)?\.(live|office(365)?|cloud)\.(com|microsoft)$/,Ia=/^http(s)?:\/\/.*\.msn\.com$/;let ka,Ea=!1,Ta=!1,Sa=!1,_a={},Ca=null,Aa=null,xa=!0,Da={};const $a=()=>_a,qa=e=>{_a=e},Ma=()=>Da,Ra=e=>{Da=e},Oa=()=>Aa,Pa=()=>Ca,La=(e,t=!1)=>{e?(Ta=t,ka=e.includes("http")||e.includes("https")?e:`https://${e}`,ne(`Setting endpoint to: ${ka}`)):re("Cannot set an empty endpoint")},Na=e=>{Ea=e},Ua=()=>Ea;function ja(e,{async:t=!1,attrs:n={},parent:a="head"}={}){return new Promise((r,i)=>{const s=document.createElement("script");s.type="text/javascript",s.src=e,s.crossOrigin="anonymous",t&&(s.async=!0);for(const[e,t]of Object.entries(n))s.setAttribute(e,t);s.addEventListener("load",()=>r()),s.addEventListener("error",i),"body"===a?document.body.appendChild(s):document.head.appendChild(s)})}var Fa;Error,document.createElement("div"),function(e){e[e.NONE=0]="NONE",e[e.SLOW_TWO_G=1]="SLOW_TWO_G",e[e.TWO_G=2]="TWO_G",e[e.THREE_G=3]="THREE_G",e[e.FOUR_G=4]="FOUR_G"}(Fa||(Fa={})),new Map([["none",Fa.NONE],["slow-2g",Fa.SLOW_TWO_G],["2g",Fa.TWO_G],["3g",Fa.THREE_G],["4g",Fa.FOUR_G]]);class Ba{static get defaultSettings(){const e=Boolean(!1),t=Boolean(!1),n=new URLSearchParams(window.location.search).keys();return{enabled:e||t||[...n].some(e=>e.includes("debug")),timeStamp:!0}}static getTimeStampString(){return Ba.settings.timeStamp?`[${(new Date).toUTCString()}]`:""}static resetSettings(){Ba.settings=Ba.defaultSettings}static log(...e){if(!Ba.settings.enabled)return;const t=Ba.getTimeStampString();console.log("%cDebugLog:: ","color: blue",t,...e)}static error(...e){if(!Ba.settings.enabled)return;const t=Ba.settings.timeStamp?`[${(new Date).toLocaleString()}]`:"";console.error("%cDebugLog:: ","color: red",t,...e)}static warn(...e){if(!Ba.settings.enabled)return;const t=Ba.settings.timeStamp?`[${(new Date).toLocaleString()}]`:"";console.warn("%cDebugLog:: ","color: orange",t,...e)}}Ba.settings=Ba.defaultSettings;const za=/^\{[a-zA-Z0-9]+:[a-zA-Z0-9]+(?:,[a-zA-Z0-9]+:[a-zA-Z0-9]+)*\}$/,Wa=["ctx","cmp","sid","plc","crt","advid","adsrv","dup","autt","dvtagver","ppid","auevent","auadv","aucmp","aucrtv","auplc","auxch","audvc","pltfrm","aufilter2","auip","DVPX_PP_AUCTION_UA","aubndl","turl","c1","c2","c3","c4","c5","gdpr","gdpr_consent"],Va={Initialized:"Initialization",Impression:"MRCImpression",Viewable:"IABViewableImpression",Error:"RuntimeError"};var Ha,Ga;!function(e){e.IAS="IAS",e.DV="DV"}(Ha||(Ha={})),function(e){e.CREATE="create",e.INIT="init",e.LOADED="loaded",e.UNKNOWN="unknown",e.VIEWABLE="viewable"}(Ga||(Ga={}));const Ja={tagtype:"display",mon:"1",blk:"0",gdpr:"${GDPR}",gdpr_consent:"${GDPR_CONSENT_126}"};Ha.IAS,Ha.DV;const Xa=e=>"ias"===e.data?.origin,Za=e=>Xa(e)&&"pingTime"===e.data.name,Ya=e=>Xa(e)&&"jsdiag"===e.data.name;function Ka(e){return"dv"===e.data?.origin}const Qa={[Ha.IAS]:class{constructor(e,t,n=window){this.iasData=e,this.elementId=t,this.windowRef=n,this.jsScriptPromise=null,this.errorCallback=null,this.listenOnInitialized=e=>{this.jsScriptPromise&&this.jsScriptPromise.then(()=>{e(this.sharedTelemetryData)}).catch(()=>{this.notifyError("IAS script failed to load",{...this.iasData})})}}get sharedTelemetryData(){const{data:e}=this.iasData,{adventityid:t,pubentityid:n}=e;return{adventityid:t,pubentityid:n}}load(e,t){const{data:n,url:a}=this.iasData;this.jsScriptPromise=((e,t,n,a)=>{let r=`https://adsdkprod.azureedge.net/assets/ias/${n}/fw.js`;return a&&(r=a),ja(r,{attrs:{"data-ias-container":t,"data-ias-parameters":JSON.stringify({config:`/rjss/st/${e.adventityid}/${e.pubentityid}/skeleton.js?iasProxyPartnerId=2`}),"data-ias-force-append":"true"},parent:"body"})})(n,this.elementId,e,a),t(this.sharedTelemetryData)}listenOnViewable(e){const t=n=>{Za(n)&&n.data.value>0&&(e({...this.sharedTelemetryData,value:n.data.value}),this.windowRef.removeEventListener("message",t,!1))};this.windowRef.addEventListener("message",t,!1)}listenOnError(e){this.errorCallback=e,this.windowRef.addEventListener("message",e=>{Ya(e)&&this.notifyError("IAS script error",e.data)})}listenOnCustomEvents(e){this.windowRef.addEventListener("message",t=>{Za(t)&&e({type:"pingTime",...this.sharedTelemetryData,value:t.data})})}listenOnUnknownEvents(e){this.windowRef.addEventListener("message",t=>{Za(t)||Ya(t)||Xa(t)&&e({...this.sharedTelemetryData,data:t.data})})}notifyError(e,t){if(this.errorCallback){const n=new Error(e);n.debugData={...this.sharedTelemetryData,event:t},this.errorCallback(n)}}},[Ha.DV]:class{constructor(e,t=window){this.dvData=e,this.windowRef=t,this.jsFileUrl=null,this.errorCallback=null,this.jsFileUrl=this.dvData.url||null}get sharedTelemetryData(){return this.dvData.data}load(e,t){this.jsFileUrl||(this.jsFileUrl=`https://adsdkprod.azureedge.net/assets/dv/v${e}/msftdvbm.js`);const n={...Ja,...this.dvData.data},a=new URLSearchParams(n).toString(),r=`${this.jsFileUrl}#${a}`;ja(r).then(()=>{t({...this.sharedTelemetryData,dvScriptUrl:r})}).catch(()=>{this.notifyError("DV script failed to load",{dvScriptUrl:r})})}listenOnInitialized(e){this.windowRef.addEventListener("message",t=>{Ka(t)&&t.data.type===Va.Initialized&&e({...this.sharedTelemetryData,dvScriptUrl:this.jsFileUrl,value:t.data})})}listenOnCustomEvents(e){this.windowRef.addEventListener("message",t=>{Ka(t)&&t.data.type===Va.Impression&&e({type:t.data.type,...this.sharedTelemetryData,dvScriptUrl:this.jsFileUrl,value:t.data})})}listenOnUnknownEvents(e){this.windowRef.addEventListener("message",t=>{Ka(t)&&!function(e){return-1!==Object.values(Va).indexOf(e.data?.type)}(t)&&e({...this.sharedTelemetryData,dvScriptUrl:this.jsFileUrl||"",data:t.data})})}listenOnViewable(e){this.windowRef.addEventListener("message",t=>{Ka(t)&&t.data.type===Va.Viewable&&e({...this.sharedTelemetryData,dvScriptUrl:this.jsFileUrl,value:t.data})})}notifyError(e,t){if(this.errorCallback){const n=new Error(e);n.debugData={...this.sharedTelemetryData,dvScriptUrl:this.jsFileUrl,event:t},this.errorCallback(n)}}listenOnError(e){this.errorCallback=e,this.windowRef.addEventListener("message",e=>{Ka(e)&&e.data.type===Va.Error&&this.notifyError("DV script error",e.data)})}}};Ha.IAS,Ha.DV;const er=/https:\/\/adsdkprod\.azureedge\.net\/assets\/dv\/(v\d+)\/msftdvbm\.js/i;function tr(e,t,n){!function(e){const t=e.tagId,n=function(e){return e?.native?.sdkKV||e?.native?.ortb?.ext?.msft?.sdk_kv}(e);if(n){let e=null;try{e=function(e){if("string"!=typeof e||!za.test(e))return null;const t={};return e.slice(1,-1).split(",").forEach(e=>{const[n,a]=e.split(":");t[n.trim()]=a.trim()}),t}(JSON.parse(n).uxParams)}catch(e){e.debugData={sdkKV:n},S.trackCriticalError(B.Gy.L.lS,e)}const a=w.getSessionData()?.flights||[],r=w.getPlacementData(t)?.flights||[];w.addPlacementData(t,{flights:[...a,...r,{raw:n,active:e}]})}}(e);const a=e.tagId,r=function(e){return e?.native?.omidTrackers||e?.native?.ortb?.eventtrackers}(e);var i;(i=r,i&&Array.isArray(i)?i.map(e=>{if(!e||!e.url)return null;let t=e.vendor_key,n=e.verification_parameters;if(e?.ext?.vendorKey&&(t=e.ext.vendorKey,n=e.ext.verification_parameters),"doubleverify.com-omid"!==t)return null;const a=function(e){return"object"==typeof e&&null!==e&&(t=e,!(0===Object.keys(t).length));var t}(r=((e,t=";",n=":")=>{const a={};return e&&"string"==typeof e?(e.split(t).filter(e=>!!e).forEach(e=>{const t=e.indexOf(n);if(-1===t)return;const r=e.slice(0,t),i=e.slice(t+1);a[r]=i}),a):a})(n,"&","="))&&"ctx"in r&&"cmp"in r&&"sid"in r&&"plc"in r&&"advid"in r&&"adsrv"in r&&"dup"in r?"string"!=typeof r.ctx||"string"!=typeof r.cmp||"string"!=typeof r.sid||"string"!=typeof r.plc||"string"!=typeof r.advid||"string"!=typeof r.adsrv||"string"!=typeof r.dup?null:Wa.reduce((e,t)=>{const n=r[t];return"string"==typeof n&&(e[t]=n),e},{}):null;var r;return null===a?null:{url:e.url,params:a}}).filter(Boolean):[]).forEach(e=>{!function(e,t,n,a){const r=Oa();if(r){const t=function(e){const t=er.exec(e);return t&&t.length>1?t[1]:null}(e.url);if(!t)return void S.trackCriticalError(B.Gy.L.Qs,{message:"DV script doesn't have a valid version",debugData:{...e.params,dvScriptUrl:e.url}});e.url=r.replace("{version}",t)}E.trackCustomEvent({dvScriptUrl:e.url,...e.params,type:`DV.${Ga.CREATE}`},a);const i=function(e,t,n){const a={...Ja,...t,btreg:n||""};return`${e}#${new URLSearchParams(a).toString()}`}(e.url,e.params,n),s=at({strategy:"WithContent",data:`<script type="text/javascript" async="true" src="${i}"><\/script>`,domElement:t});!function(e,t,n,a,r,i){const s=new e({url:a,data:r},t.contentWindow);s.listenOnInitialized((e={})=>{E.trackCustomEvent({...e,type:`${n}.${Ga.INIT}`},i)}),s.listenOnCustomEvents((e={})=>{const t=e.type||"customEvent";E.trackCustomEvent({...e,type:`${n}.${t}`},i)}),s.listenOnUnknownEvents((e={})=>{E.trackCustomEvent({...e,type:`${n}.${Ga.UNKNOWN}`},i)}),s.listenOnViewable((e={})=>{E.trackCustomEvent({...e,type:`${n}.${Ga.VIEWABLE}`},i)}),s.listenOnError(e=>{S.trackHighImpactError("dv",e)})}(Qa[Ha.DV],s,"DV",e.url,e.params,a)}(e,t,n,a)})}let nr={};function ar(e,t){const n=function(e){let t={};return R(apntag.requests.tags,n=>{e===n.uuid&&(t=n)}),t.uuid||(t.notFound=!0),t}(e.uuid);if(n.notFound&&(this.tagNotFound=!0),this.targetId=n.targetId,this.uuid=e.uuid,e.nobid)return this.nobid=!0,this.tagId=e.tag_id,this.auctionId=e.auction_id,this;e.ads&&e.ads.length,this.tagId=e.tag_id,this.auctionId=e.auction_id;const a=t||e.ads[0],r=this;let i,s;var o;R({adType:(o=a).ad_type,buyerMemberId:o.buyer_member_id,source:o.content_source,cpm:o.cpm,cpm_publisher_currency:o.cpm_publisher_currency,publisher_currency_code:o.publisher_currency_code,creativeId:o.creative_id,mediaSubtypeId:o.media_subtype_id,mediaTypeId:o.media_type_id,brandCategoryId:o.brand_category_id,dealId:o.deal_id,isExclusive:o.is_sov,isRoadblock:o.is_roadblock},(e,t)=>{r[t]=e});const d=function(e){let t=[];return N(e.sizes)||(t=xe(e.sizes)),t}(n);Array.isArray(d)&&d[0]&&(i=d[0].height,s=d[0].width),a.msft&&(this.msft=a.msft),a.dsa&&(this.dsa=a.dsa),a.feedback_url&&(this.feedbackUrl=a.feedback_url);const c=a.content_source?a.content_source:"rtb";if(a[c]&&a[c].banner)this.banner={width:a[c].banner.width,height:a[c].banner.height,content:a[c].banner.content,trackers:a[c].trackers},i=a[c].banner.height,s=a[c].banner.width;else if(a.rtb&&a.rtb.video){const e=a.rtb.video;this.video={duration:e.duration_ms,playbackMethods:e.playback_methods,frameworks:e.frameworks,content:e.content,trackers:a.rtb.trackers}}else if(a.rtb&&(a.rtb[B.Ap.s6]||a.rtb.openrtb_native)){const e=a.rtb.openrtb_native||a.rtb[B.Ap.s6];if(this[B.Ap.s6]=function(e){if("string"==typeof e)try{return{ortb:JSON.parse(e)}}catch(t){re("Saw issue trying to parse the native ortb response data.  Native object provided by impbus",e)}return{type:e.type,title:e.title,body:e.desc,desc2:e.desc2,fullText:e.full_text,icon:e.icon,image:e.main_img,cta:e.ctatext,sponsoredBy:e.sponsored,impressionTrackers:e.impression_trackers,omidTrackers:e.omid_trackers,clickTrackers:e.link&&e.link.click_trackers,clickUrl:e.link&&e.link.url,clickFallbackUrl:e.link&&e.link.fallback_url,javascriptTrackers:e.javascript_trackers,video:e.video,privacyLink:e.privacy_link,rating:e.rating,displayUrl:e.displayurl,likes:e.likes,downloads:e.downloads,price:e.price,salePrice:e.saleprice,phone:e.phone,address:e.address,custom:e.custom,sdkKV:e.msft?.sdk_kv,customTitle1:e.title1,customTitle2:e.title2,customTitle3:e.title3,customTitle4:e.title4,customTitle5:e.title5,customBody1:e.body1,customBody2:e.body2,customBody3:e.body3,customBody4:e.body4,customBody5:e.body5,customCta1:e.ctatext1,customCta2:e.ctatext2,customCta3:e.ctatext3,customCta4:e.ctatext4,customCta5:e.ctatext5,customDisplayUrl1:e.displayurl1,customDisplayUrl2:e.displayurl2,customDisplayUrl3:e.displayurl3,customDisplayUrl4:e.displayurl4,customDisplayUrl5:e.displayurl5,customSocialUrl1:e.socialurl1,customSocialUrl2:e.socialurl2,customSocialUrl3:e.socialurl3,customSocialUrl4:e.socialurl4,customSocialUrl5:e.socialurl5,customImage1:e.image1,customImage2:e.image2,customImage3:e.image3,customImage4:e.image4,customImage5:e.image5,customIcon1:e.icon1,customIcon2:e.icon2,customIcon3:e.icon3,customIcon4:e.icon4,customIcon5:e.icon5,customSocialIcon1:e.socialicon1,customSocialIcon2:e.socialicon2,customSocialIcon3:e.socialicon3,customSocialIcon4:e.socialicon4,customSocialIcon5:e.socialicon5}}(e),!n.trackingManagement||!n.trackingManagement.native||n.trackingManagement.native.loadViewScriptAt!==B.nP.G.D){const e=n.wcElement||document.getElementById(n.targetId);se("Loading native viewability script during adResponse phase"),ir(a,this,this.targetId,e)}}this.height=i,this.width=s,this.bidderId=a.bidder_id,this.adomain=a.adomain,a.renderer_id&&(this.renderer_id=a.renderer_id),a.renderer_url&&(this.renderer_url=a.renderer_url)}const rr=function(e,t){if(!e||!e.uuid)return{};if(nr[e.uuid]&&!t)return nr[e.uuid];try{const n=function(e,t){return new ar(e,t)}(e,t);return t||(nr[e.uuid]=n),n}catch(e){re(`adManager.getAdObj: Error trying to instantiate new adObj: ${e.message}`)}};const ir=function(e,t,n,a){const r=`ast_${n}_${e?.creative_id}_trkjs`;if(e.viewability&&e.viewability.config){let t=e.viewability.config;"string"==typeof n&&(t=t.replace("%native_dom_id%",n),le()&&null===document.getElementById(n)&&ae(`No element found in the page for the native creative ${n}, see https://docs.xandr.com/bundle/seller-tag/page/seller-tag/define-tag.html 'targetId'`),a&&a.getRootNode()instanceof ShadowRoot&&(window[r]=a,t=t.replace(`dom_id=${n}`,`dom_elt_var=${r}`)));const i=/https?:\/\/[\w\.\/-]+\.js/;Pa()&&(t=t.replace(i,Pa())),at({strategy:"WithContentAndAttributes",data:{content:t,attributes:{"data-anxtracker":n||""}},domElement:a})}xa&&tr(t,a,n)},sr=function(e){apntag.requests.trackingManagement=apntag.requests.trackingManagement||{},apntag.requests.trackingManagement.native||(apntag.requests.trackingManagement.native={loadViewScriptAt:B.nP.G.W}),apntag.requests.trackingManagement.mobileOmidImpTracking="boolean"==typeof e.trackingManagement?.mobileOmidImpTracking&&e.trackingManagement.mobileOmidImpTracking,apntag.requests.trackingManagement.mobileOmidImpTracking&&or()},or=function(){if(window.om||window.OmidVerificationClient){const e="omid verification client already loaded";ne(e),E.trackCustomEvent({type:"omidAlreadyLoaded",msg:e})}else apntag.requests.trackingManagement.scriptLoadPromise=function(e,t){return new Promise((n,a)=>{try{oe(e,t,()=>n())}catch(e){a(e)}})}(window,B.i$._F)};function dr(e,t,n,a=new Map,r=void 0){const i=r?.(e,t,n,a);if(null!=i)return i;if(null==(s=e)||"object"!=typeof s&&"function"!=typeof s)return e;var s;if(a.has(e))return a.get(e);if(Array.isArray(e)){const t=new Array(e.length);a.set(e,t);for(let i=0;i<e.length;i++)t[i]=dr(e[i],i,n,a,r);return Object.hasOwn(e,"index")&&(t.index=e.index),Object.hasOwn(e,"input")&&(t.input=e.input),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){const t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t}if(e instanceof Map){const t=new Map;a.set(e,t);for(const[i,s]of e)t.set(i,dr(s,i,n,a,r));return t}if(e instanceof Set){const t=new Set;a.set(e,t);for(const i of e)t.add(dr(i,void 0,n,a,r));return t}if("undefined"!=typeof Buffer&&Buffer.isBuffer(e))return e.subarray();if(L(e)){const t=new(Object.getPrototypeOf(e).constructor)(e.length);a.set(e,t);for(let i=0;i<e.length;i++)t[i]=dr(e[i],i,n,a,r);return t}if(e instanceof ArrayBuffer||"undefined"!=typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){const t=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return a.set(e,t),cr(t,e,n,a,r),t}if("undefined"!=typeof File&&e instanceof File){const t=new File([e],e.name,{type:e.type});return a.set(e,t),cr(t,e,n,a,r),t}if(e instanceof Blob){const t=new Blob([e],{type:e.type});return a.set(e,t),cr(t,e,n,a,r),t}if(e instanceof Error){const t=new e.constructor;return a.set(e,t),t.message=e.message,t.name=e.name,t.stack=e.stack,t.cause=e.cause,cr(t,e,n,a,r),t}if("object"==typeof e&&function(e){switch(P(e)){case"[object Arguments]":case"[object Array]":case"[object ArrayBuffer]":case"[object DataView]":case"[object Boolean]":case"[object Date]":case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Map]":case"[object Number]":case"[object Object]":case"[object RegExp]":case"[object Set]":case"[object String]":case"[object Symbol]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return!0;default:return!1}}(e)){const t=Object.create(Object.getPrototypeOf(e));return a.set(e,t),cr(t,e,n,a,r),t}return e}function cr(e,t,n=e,a,r){const i=[...Object.keys(t),...(s=t,Object.getOwnPropertySymbols(s).filter(e=>Object.prototype.propertyIsEnumerable.call(s,e)))];var s;for(let s=0;s<i.length;s++){const o=i[s],d=Object.getOwnPropertyDescriptor(e,o);(null==d||d.writable)&&(e[o]=dr(t[o],o,n,a,r))}}function lr(e){return dr(e,void 0,e,new Map,void 0)}const ur=B.ZJ.ZH,pr=B.nP.G.W;function gr(e,t){let n=!1,a=e;if(2===arguments.length?(a=va.apntag.requests.tags[t],(e.sizes&&a.sizeMapping||e.sizeMapping&&!a.sizeMapping)&&(n=!0)):(t=e.targetId,e.sizes&&e.sizeMapping&&(n=!0)),n)return re(`sizes and sizeMapping both cannot be defined for targetId: ${t}`),!1;if(e.sizeMapping){const t=function(e){if(t=e.sizeMapping,!(Array.isArray(t)&&t.length>0||(se("No size mapping defined"),0)))return e.sizes;var t;const n=function(){const e=ve(),t=e.document;return e.innerWidth?e.innerWidth:t.body.clientWidth?t.body.clientWidth:t.documentElement.clientWidth?t.documentElement.clientWidth:0}();let a;if(!n){a=e.sizeMapping[0];for(let t=0;t<e.sizeMapping.length;t++)parseInt(e.sizeMapping[t].minWidth,10)>parseInt(a.minWidth,10)&&(a=e.sizeMapping[t]);return a.sizes?a.sizes:e.sizes}let r="";const i=e.sizeMapping.slice().sort((e,t)=>e.minWidth-t.minWidth);for(let e=0;e<i.length;e++)n>=i[e].minWidth&&(a=i[e]);return a&&a.sizes?(r=a.sizes,ne(`tag : ${e.targetId} resized based on device width to : ${r}`)):ne(`tag : ${e.targetId} not mapped to any sizes for device width. This request will be suppressed.`),r}(e);if(""===t)return"";e.sizes=t}return!0}function mr(){{const e=document.createElement("iframe");return e.id="appnexus-debug-console-loader",e.height="100%",e.width="100%",e.border="0px",e.hspace="0",e.vspace="0",e.marginWidth="0",e.marginHeight="0",e.style.border="0",e.frameBorder="0",e}}function fr(e){try{return Object.keys(apntag.requests.tags).filter(t=>apntag.requests.tags[t].uuid===e.uuid)[0]}catch(e){return""}}const hr='<span style="color: #ccc">nobid</span>';function yr(e,t){if(e.nobid)return hr;const n=e.ads&&e.ads[0][t];return n||0===n?n:""}function br(e,t,n){se("Buyer was found in list and could detect OM SDK. Setting up imp by view logic."),e.verificationClient=new(window.OmidVerificationClient[Object.keys(window.OmidVerificationClient)[0]]),e.verificationClient&&e.verificationClient.registerSessionObserver(a=>{const{tagId:r,targetId:i}=e;if("sessionError"===a.type){const e=`OMSDK session error for ad target: ${i}, loading impressions the normal way.`;ae(e),Nr(t,n,r),E.trackCustomEvent({type:"omidSessionEvent",sessionMsg:e,targetId:i},r)}else"sessionStart"===a.type&&(e.verificationClient.addEventListener("geometryChange",function(e,t,n){return function(a){if((a&&a.data&&a.data.adView&&a.data.adView.percentageInView)>0&&!e.impressionUrlLoaded){const{tagId:a,targetId:r}=e;Nr(t,n,a),ne(`OMSDK impression event detected for ad tag: ${r}`),E.trackCustomEvent({type:"omidImpression",targetId:r},a),e.impressionUrlLoaded=!0}}}(e,t,n)),E.trackCustomEvent({type:"omidSessionStart",targetId:i},r))},"appnexus.com-omid")}class vr{constructor(e){this.options=e,this.lastClickTime=0,this.pendingClick=!1,this.clickStartTime=0,this.CLICK_THRESHOLD_MS=2e3,this.handleVisibilityChange=()=>{if(!document.hidden&&this.lastClickTime>0){const e=Date.now()-this.lastClickTime;this.options.onReturn(e),this.lastClickTime=0}document.hidden&&this.pendingClick&&Date.now()-this.clickStartTime<this.CLICK_THRESHOLD_MS&&(this.lastClickTime=Date.now(),this.pendingClick=!1)},document.addEventListener("visibilitychange",this.handleVisibilityChange)}recordAdClick(){this.pendingClick=!0,this.clickStartTime=Date.now()}dispose(){document.removeEventListener("visibilitychange",this.handleVisibilityChange)}}const wr=new WeakMap;function Ir(e){return e?wr.get(e):void 0}function kr({targetId:e,wcElement:t}){if(w.skipLogging)return;const n=t||document.getElementById(e);if(!n)return ne(`Ad Element not found for quick back signal: ${e}`),void E.trackCustomEvent({type:"qbsElementNotFound",targetId:e});let a=wr.get(n);if(a)return;const r=t?t.id:e;E.trackCustomEvent({type:"qbsInitialize",targetId:r}),a=new vr({adElement:n,onReturn:e=>{const t=apntag.requests?.tags[r],n=t?rr(t.adResponse):null,a=n?.tagId;ne(`Quick back signal for ${r} with dwellTime: ${e}`),E.trackCustomEvent({type:"dwellTime",targetId:r,dwellTime:e},a)}}),wr.set(n,a)}const Er=B.Ve.D4,Tr=B.Ve.s6,Sr=B.Me.Ve,_r=B.Ve.G_,Cr=B.Me.D4,Ar=B.Me.KB,xr=B.AD.Wy,Dr=B.uK,$r=B.AD.w$,qr=B.AD.JN,Mr=B.ZJ.qv,Rr=B.AI.FF,Or=B.AD.Q9,Pr=B.ZJ.ZH;function Lr(e,t,n,a,r){let i,s,o;if(e.adResponse&&(function(e){if(e.adResponse&&e.adResponse.ads){const t=we(e.adResponse.ads);if(t.banner){const n=e.initCollapsed,a=n&&n.expandBy&&O(Dr).indexOf(n.expandBy)>=0;n&&!a&&ae(`TagID ${e.tagId} initCollapsed is set but expandBy is not recognized, initial size will not be collapsed`),e.initialHeight=a?0:t.banner.height,e.initialWidth=a?0:t.banner.width}}}(e),o=He(e),typeof o===Pr||null===o||typeof o.error!==Pr))return d=e.adResponse,void ce(window.document.body,d[qr],d.uuid);var d;if(e.adResponse&&e.showTagCalled){E.trackCustomEvent({type:"adRenderingData",targetId:e.targetId,sizes:e.sizes,isWebComponent:!!e.wcElement,isSafeFrame:!(!e.enableSafeFrame&&!e.alwaysUseXDomainIframe),batchId:r},e.tagId);{const r=function(e,t){if(t.renderer_url&&t.renderer_id){if(e.usesRenderer=!0,2===t.renderer_id&&e.enableSafeFrame&&(e.safeframe.expansionByPush=!0,e.customIframeProps={style:"overflow:hidden",allow:"autoplay"}),"native"===t.ad_type&&e.trackingManagement&&e.trackingManagement.native&&e.trackingManagement.native.loadViewScriptAt===B.nP.G.D){const n=rr(t);se("Loading native viewability script during native render sequence"),ir(t,n,e.targetId)}if(!e.enableSafeFrame)return function(e,t){{const n=Ge(t);if(typeof n===Pr)return re("No Content Source Found"),void(e.displayed=!1);t[t.ad_type]=n,function(e){e.isMediated||e.isRtbVideoFallback||(e.adResponse.ad=e.adResponse.ads[0])}(e),yt.loadRenderer(e,t)}}(e,t),!0;yt.loadRenderer(e,t)}}(e,o);if(r)return e.targetId;try{if(o[Sr]===Tr&&!e.usesRenderer)return function(e){ne(`Render for the following ad should be handled outside of ast.js :${e.targetId}`),e.displayed=!0;const t=rr(e.adResponse);Pe.emit(B.qY.LOADED,e.targetId,t),ie(`The ${e.targetId} ad is loaded.`)}(e),e.targetId;if(o[Sr]===_r&&!e.usesRenderer)return ae("Response has no renderer for video"),e.displayed=!1,e.targetId;if(o[Sr]===Er||e.usesRenderer){if(o.content_source===Rr&&!e.usesRenderer){const t=o[Rr][Cr];if(N(t)||typeof t!==Mr)return re("Response has no banner object"),e.displayed=!1,e.targetId;if(!me(t,Ar))return re("Response has no banner content"),e.displayed=!1,e.targetId;if(!me(t,"width"))return re("Response has no banner width"),e.displayed=!1,e.targetId;if(!me(t,"height"))return re("Response has no banner height"),e.displayed=!1,e.targetId}let r,d;if(me(n,e.targetId)&&(r=n[e.targetId]),e.alwaysUseXDomainIframe||e.enableSafeFrame){a(),d=e.wcElement?e.wcElement:window.document.getElementById(e.targetId);const t=d.style.height,n=d.style.width;d.style.height=e.initialHeight,d.style.width=e.initialWidth,d.style.height=t,d.style.width=n}const c=lr(t);me(e.safeframe,"expansionByPush")&&(c.expansionByPush=e.safeframe.expansionByPush),me(e.safeframe,"expansionByOverlay")&&(c.expansionByOverlay=e.safeframe.expansionByOverlay),me(e.safeframe,"sandbox")&&(c.sandbox=e.safeframe.sandbox),me(e.safeframe,"meta")&&(c.meta=e.safeframe.meta),e.safeframe=c,s=function(e){{let t;const n=ke(e),a=e.curWindow||window,r=e.wcElement;try{t=r&&r.querySelector(`#${n}`)?r.querySelector(`#${n}`):a.document.getElementById(n)?a.document.getElementById(n):a.document.createElement("div")}catch(t){return re("Error creating Ad Div: ",null,t),void(e.displayed=!1)}return t.style.display="none",t.id=n,t}}(e),(e.alwaysUseXDomainIframe||e.enableSafeFrame)&&(s.style.height=`${e.initialHeight}px`,s.style.width=`${e.initialWidth}px`,s.style.display="block",d.appendChild(s),e.geom=function(e,t){{ne("Geom starting");const n=na(e,t);return 0===ea&&(ea=setInterval(da,1e3)),n}}(e.targetId,s)),i=function(e,t){{const n=function(e,t="3rd party advertisement container"){{const n=e.tagId||e.adResponse.tag_id,a=e.targetId,r=e.adTrackingId,i=performance.now();let s;tt[`${a}_${r}`]=i,E.trackCustomEvent({type:B.eZ.IFRAME_RENDER_START,targetId:a,batchId:e.batchId,performance:i,adTrackingId:r},n);const o=function(e){return`${B.H3.p+e.targetId}_${de()}`}(e),d=ve();return s=null!==d.document.getElementById(o)?d.document.getElementById(o):d.document.createElement("iframe"),s.id=o,s.name=o,s.title=t,s.setAttribute("height",e.initialHeight),s.setAttribute("width",e.initialWidth),s.width=`${e.initialWidth}px`,s.height=`${e.initialHeight}px`,s.border="0",s.hspace="0",s.vspace="0",s.marginWidth="0",s.marginHeight="0",s.style.border="0",s.scrolling="no",s.frameBorder="0",s}}(e);if(e.alwaysUseXDomainIframe||e.enableSafeFrame){let a;ne(`targetId: ${e.targetId} is using safeFrame. Loading this ad into sandboxed iframe`),t.renderer_url?a="\x3c!-- renderer loading in SF--\x3e":e.isBannerMediation?a=apntag.getAdMarkup(e.targetId,e.uuid):e.isVideoMediation?a=e.adResponse.ad[Ke][Qe][et]:(a=it(e),a=a.replace("/&/g","&amp;").replace("/</g","&lt;").replace("/>/g","&gt;").replace('/"/g',"&quot;").replace("/'/g","&#39;"),a=`${a}`);const r=e.curWindow;delete e.curWindow;const i={targetId:e.targetId,ad:a,host:`${r.location.protocol}//${r.location.host}`,geom:e.geom,debug:le(),hasFocus:document.hasFocus(),hostSfSupport:e.safeframe,isMediated:e.isMediated,rendererUrl:t.renderer_url,enableMediationEvents:apntag.requests.enableMediationEvents,expandByCreative:ue(e.targetId),currentTag:e};e.safeframe.meta&&(i.meta=e.safeframe.meta),n.name=JSON.stringify(i),e.curWindow=r,e.safeframe.sandbox&&(n.sandbox="allow-forms allow-modals allow-orientation-lock allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-presentation allow-same-origin allow-scripts")}if(e.renderingManagement&&e.renderingManagement.sandboxAdIframe&&!n.hasAttribute("sandbox")){const t=e.renderingManagement.sandboxAttributes||[];t.length>0&&(se(`renderingManagement.sandboxAdIframe was enabled, enabling sandbox attributes: ${t.join(" ")}`),n.setAttribute("sandbox",t.join(" ")))}return e.customIframeProps&&R(e.customIframeProps,(e,t)=>{n[t]=e}),n}}(e,o);const l=lt.getInstance(),u={};let p=i;if(e.renderingManagement&&e.renderingManagement.insertWrapperDiv){const e=document.createElement("div");e.append(i),p=e,se("renderingManagement.insertWrapperDiv was enabled, creating extra div element around iframe container")}if(u.iframe=i,u.originalWidth=e.initialWidth,u.originalHeight=e.initialHeight,l.add(e.targetId,u),n[e.targetId]=i,typeof r!==Pr&&window.document.getElementById(r.id)?s.replaceChild(p,r):s.appendChild(p),e.displayed=!0,window.document.body)try{!function(e,t,n){{const a=dt.includes("Safari")?"safari":dt.toLowerCase().includes("webkit")?"webkit":dt.toLowerCase().includes("opera")||dt.includes("OPR")?"opera":(ot?st(ot.brands,"google chrome"):dt.includes("Chrome")||dt.includes("CriOS"))?"chrome":(ot?ot.brands&&st(ot.brands,"microsoft edge"):dt.includes("Edg"))?"edge":dt.toLowerCase().includes("firefox")||dt.includes("FxiOS")?"mozilla":dt.includes("MSIE")||dt.includes("Trident")||dt.includes("Trident/7.0")?"msie":"",r=e.curWindow||window,i=e.wcElement?e.wcElement:r.document.getElementById(e.targetId);if(i){e.alwaysUseXDomainIframe||e.enableSafeFrame||(i.appendChild(t),t.style.display="inline"),e.utDivId=t.id,e.utiframeId=n.id,performance.now();let r="";e.adResponse&&1===e.adResponse.ads.length&&(r=e.adResponse.ads[0]?.creative_id),qe(e.targetId)||(a===B.Ss.IE||a===B.Ss.E?function(e,t){if(t.alwaysUseXDomainIframe||t.enableSafeFrame)e.src="sfTreatment"===Ze?B.i$.I2:B.i$.xF;else{let n="";n=it(t);try{e.contentWindow.contents=n}catch(t){e.src=`javascript:document.write('<script>document.domain="${document.domain}"<\/script>')`,e.contentWindow.contents=n}const a=document.getElementsByTagName("base");let r;a.length&&(r=a.target,a[0].target="_self"),e.src='javascript:window["contents"];',a.length&&(a[0].target=r)}}(n,e):function(e,t){if(t.alwaysUseXDomainIframe||t.enableSafeFrame)e.src="sfTreatment"===Ze?B.i$.I2:B.i$.xF;else{let n="";const a=function(e){{let t;try{t=e.contentWindow?e.contentWindow.document:e.contentDocument.document?e.contentDocument.document:e.contentDocument}catch(e){re(`Error getting iframe document: ${e}`)}return t}}(e);n=it(t),a.open("text/html","replace"),a.write(n),a.close()}}(n,e));const s=e.adResponse.ads?e.adResponse.ads[0]:e.adResponse.ad,o=e.tagId||e.adResponse.tag_id;if(void 0===s)return ae("No ad found in response, nothing to display."),void(e.displayed=!1);if(e.alwaysUseXDomainIframe||e.enableSafeFrame||n.addEventListener("load",()=>{n.contentWindow.addEventListener("click",()=>{const t=Ir(e.wcElement||va.document.getElementById(e.targetId));t?.recordAdClick(),E.trackEvent({type:C},o)},!0)},{once:!0}),!e.isMediated&&!e.usesRenderer||e.adResponse.ad&&"rtb"===e.adResponse.ad.content_source)if(((e,t)=>t.bidder_id&&101===t.bidder_id&&(ot?!0===ot.mobile:navigator.userAgent.includes("Mobile")||navigator.userAgent.includes("Android"))&&e.trackingManagement&&e.trackingManagement.mobileOmidImpTracking)(e,s)){const{tagId:t,targetId:a}=e;E.trackCustomEvent({type:"omidTrackingEligible",targetId:a},t),((e,t,n)=>{const{tagId:a,targetId:r}=e;var i;window.om||window.OmidVerificationClient?br(e,t,n):(i=apntag.requests.trackingManagement.scriptLoadPromise,new Promise((e,t)=>{const n=new Promise((e,t)=>{setTimeout(()=>{t(new Error("Timeout exceeded while waiting for script load"))},1e3)});Promise.race([i,n]).then(e).catch(t)})).then(()=>((e,t,n)=>{ne("Successfully loaded the OMID Verification Client script."),br(e,t,n)})(e,t,n)).catch(()=>((e,t,n,a)=>{const r="Script loading failed or timeout exceeded";ne(r),S.trackCriticalError(B.Gy.L.SI,new Error(r)),Nr(n,a,e)})(a,0,t,n))})(e,s,n)}else Nr(s,n,e);const d=Ge(s),c=Number(i.style.width.replace(/[^\d\.\-]/g,""));!isNaN(c)&&c>d.width&&("center"===e.promoAlignment?i.setAttribute("align","center"):i.setAttribute("align","left")),ne(`The ${e.targetId} ad is loaded.`),ie(`The ${e.targetId} ad is loaded.`);const l=rr(e.adResponse);e.usesRenderer||apntag.requests.enableMediationEvents&&e.isMediated||Pe.emit(B.qY.LOADED,e.targetId,l)}else ae(`No div element found for display ad. This ad will not show. Div id: ${e.targetId}`),e.displayed=!1}}(e,s,i)}catch(t){re("Error rendering ad: ",null,t),e.displayed=!1}else re("Error rendering ad: window.document.body is undefined"),e.displayed=!1}else re("Error rendering ad: unknown type"),e.displayed=!1;return e.targetId}catch(t){re(`AST encountered an error while attempting to render tag ${e}.  \nError: ${t}`)}}}}const Nr=(e,t,n)=>{{const a=e[Rr][Or][0][$r],{adResponse:r,targetId:i,tagId:s,enableSafeFrame:o,alwaysUseXDomainIframe:d}=n,c=s||r&&r.tag_id;E.trackEvent({type:_,data:{enableSafeFrame:!(!o&&!d),batchId:n.batchId,performance:performance.now(),adTrackingId:n.adTrackingId}},c);for(let n=0;n<a.length;n++)ce(t.parentElement,a[n],e[xr]);ne(`Impression triggered for ad tag: ${i}`)}},Ur=B.Ve.s6,jr=B.Ve.D4,Fr=B.Ve.G_,Br=B.ZJ.ZH,zr=B.i$.no;function Wr(e,t,n){ne("renderAd is called"),R(apntag.requests.tags,e=>{if(e.uuid===t){e.adResponse=n;try{if(n.ad&&n.ad.ad_type===jr){const t=n.ad.content_source;e.ad={mediatedContent:n.ad[t].banner.content},e.initialHeight=n.ad[t].banner.height,e.initialWidth=n.ad[t].banner.width}}catch(e){re(`Error while setting mediated content for banner in renderAd${e}`)}const t=Lr(e,ya,$a(),ba);ga.push(t)}})}function Vr(e,t){const n=[];return["data","images"].forEach(a=>{Array.isArray(e[a])&&e[a].length>0&&e[a].forEach(e=>{("request"===t&&!0===e.required&&e.id||"response"===t&&e.id)&&n.push(e.id)})}),n}function Hr(e){const t=`Unable to find the matching tag request object in AST for the bid response using uuid: ${e.uuid}.  \nThis may mean the apntag.removeTag call was used to delete a tag before the auction finished.  \nUnable to process or render this bid.`;re(t,null,e),S.trackCriticalError(B.Gy.L.R5,new Error(t))}function Gr(e,t,n,a){if(qe(n))return void Hr(t);if(e.uuid!==t.uuid)return void re("Something went wrong in AST, the UUID for the bid request and the bid response do not match.  Cannot proceed with processing this bid.  RequestTag and ResponseTag provided:",null,e,t);const r=rr(t);r.tagNotFound?Hr(t):(w.addPlacementData(r.tagId,{placementId:r.tagId}),!0!==t.nobid?function(e,t,n,a,r){e.adResponse=t,e.utCalled=!0;const i=Jr(n);if(w.addPlacementData(n.tagId,{adHeight:n.height,adWidth:n.width,creativeId:n.creativeId,bidderId:n.bidderId}),E.trackEvent({type:"adServerRequestFill",data:{batchId:a,targetId:n.targetId,performance:performance.now(),adTrackingId:e?.adTrackingId}},n.tagId),apntag.requests.tags[n.targetId]?.perfTimings&&(apntag.requests.tags[n.targetId].perfTimings.responseTime=performance.now()-apntag.requests.tags[n.targetId].perfTimings.request),kr({targetId:n.targetId}),qe(n.targetId))return void Hr(t);try{$.createStartMark("rendering")}catch(e){}const s=apntag.requests.tags[n.targetId]&&apntag.requests.tags[n.targetId].wcElement;if(Xr(n,a,e.invCode,s,i),Pe.emit(B.qY.AVAILABLE,r,n),!e.prebid&&!e.displayed){const t=Lr(e,ya,$a(),ba,a);ga.push(t)}}(e,t,r,a,n):function(e,t,n,a){ne(`No bid for targetId:${e.targetId}`),E.trackEvent({type:"adServerRequestNoFill",data:{batchId:n,targetId:t.targetId,performance:performance.now(),adTrackingId:e?.adTrackingId}},t.tagId),Pe.emit(B.qY.NO_BID,a,t)}(e,r,a,n))}function Jr(e){let t=e.adType;return"video"===e.adType&&(t=e.renderer_id?function(e){let t;switch(e.renderer_id){case 2:t="video_outstream";break;case 3:t="video_bannerstream";break;default:return"video_unknown_renderer"}return t}(e):"video_no_renderer"),e.renderer_id&&"native"===e.adType&&(t="native_assembly"),t}const Xr=(e,t,n,a,r)=>{const i=e.targetId,s=a||document.getElementById(i);if(!s)return void ne(`Unable to locate ad slot with targetId ${i} for Telemetry logging.`);const o=s._observer;o&&o.disconnect();const d=new MutationObserver((o,d)=>{try{if(s.innerHTML.trim().length>0){const{size:o,position:c}=$e(i,a);ne(`Ad content loaded in ${i} with size ${JSON.stringify(o)} at position ${JSON.stringify(c)}`),E.trackCustomEvent({type:"postRenderAdData",batchId:t,invCode:n,size:o,position:c,targetId:i,isWebComponent:!!a},e.tagId),$.trackMark("rendering",{adType:r}),Pe.emit(B.qY.AD_SLOT_RENDER_START,i,e),Zr(i,t,n,e,s),d.disconnect()}}catch(e){const t=`Error in handleBidResponse.observeAdSlot: ${e.message}`;re(t),S.trackCriticalError(B.Gy.L.NV,new Error(t))}});d.observe(s,{childList:!0,subtree:!0}),s._observer=d},Zr=(e,t,n,a,r)=>{if(!r)return void ne(`Unable to locate ad slot with targetId ${e} for Telemetry logging.`);let i=null;new IntersectionObserver((r,s)=>{try{r.forEach(r=>{r.intersectionRatio>=.5?i||(i=setTimeout(()=>{ne(`Ad slot ${e} is visible`),E.trackEvent({type:"mrcView",data:{batchId:t,invCode:n,targetId:e}},a.tagId),Pe.emit(B.qY.MRC_VIEW,e,a),s.disconnect()},1e3)):i&&(clearTimeout(i),i=null)})}catch(e){const t=`Error in utils.observeAdVisibility: ${e.message}`;re(t),S.trackCriticalError(B.Gy.L.NV,new Error(t))}},{root:null,rootMargin:"0px",threshold:.5}).observe(r)};function Yr(e,t,n){let a=null;apntag.requests.cbCalled=!0;try{if(typeof e===Br||null===e||e.error){const n="Malformed response from ad server",r=e&&e.error?B.Gy.L.R5:B.Gy.L.Ny,i=e&&e.error?e.error:n,s=new Error(i);S.trackCriticalError(r,s),re(`Error response from impbus: ${i}`);let o={};try{o=JSON.parse(t)}catch(e){}return void R(apntag.requests.tags,(e,t)=>{const n={};let r;e&&(a=rr(e.adResponse),r=e.targetId,Object.assign(n,{tagId:t,memberId:e.member,sizes:e.sizes}));const s=Me(i,r,void 0,200,n);R(o.tags,n=>{n.uuid===e.uuid&&Pe.emit(B.qY.BAD_REQUEST,t,s,a)})})}e.debug&&e.debug.debug_info&&function(e){{e='<div style="margin-top:10px;margin-bottom:10px;"><span style="font-weight:bold">AST Dongle Value:</span> <input\n            id="ast-dongle-input"\n            type="text"\n            length="400"\n            style="border-radius:5px;"\n            placeholder="Enter ast_dongle value"\n            value=null\n         /></div>'+(e=e.replace(/(\n)/g,"<br>"));const t=document.body,n=document.createElement("div");n.id="appnexus_debug_window";const a=document.createElement("div");a.style.width="100%",a.style.height="400px",a.style.clear="both",t.insertBefore(a,null);const r=n.style;r.position="fixed",r.bottom="0px",r.left="0px",r.width="100%",r.height="450px",r.overflow="hidden",r["border-top"]="1px solid",r["z-index"]=999999,r.background="white",t.insertBefore(n,null);const i=document.createElement("div");i.style.width="100%",i.style.height="30px";const s=mr();n.appendChild(s);const o=s.contentWindow.document;s.onload=function(){const e=o.getElementsByTagName("br"),t=e.length;let n,a,r=0;for(;r<t-1;r++)n=e[r].nextSibling,a=n&&n.nodeName.toLowerCase(),"br"===a&&(n.style.display="none")};const d="<\/script>";o.open(),o.write(e),o.write(d),o.close()}}(e.debug.debug_info),e.toolkit&&e.toolkit.enabled&&function(e){{const t='<div style="margin-top:10px;margin-bottom:10px;"><span style="font-weight:bold">AST Dongle Value:</span> <input\n            id="ast-dongle-input"\n            type="text"\n            length="400"\n            style="border-radius:5px;"\n            placeholder="Enter ast_dongle value"\n            value=null\n         /></div>'+e.map(e=>`\n      <table style="border: 1px solid black; border-radius: 5px; font-family: sans-serif; margin: 1em; padding: .5em">\n        <tr>\n          <td style="padding-right: 5em;"><b>Target&nbsp;ID</b></td>\n          <td style="width: 100%;">${fr(e)}</td>\n        </tr>\n        <tr>\n          <td><b>Creative ID</b></td>\n          <td>${yr(e,"creative_id")}</td>\n        </tr>\n        <tr>\n          <td><b>Buyer Member ID</b></td>\n          <td>${yr(e,"buyer_member_id")}</td></tr>\n        <tr>\n          <td><b>Creative Size</b></td>\n          <td>${function(e){if(e.nobid)return hr;let t=null,n=null;const a=e.ads&&e.ads.length?e.ads[0]:{};return a.rtb&&a.rtb.banner&&(t=a.rtb.banner.height,n=a.rtb.banner.width),t&&n?`${n} x ${t}`:""}(e)}</td>\n        </tr>\n        <tr>\n          <td><b>Available Sizes</b></td>\n          <td>${function(e){try{const t=fr(e),n=apntag.requests.tags[t].sizes;return JSON.stringify(n)}catch(e){return""}}(e)}</td></tr>\n        <tr>\n          <td><b>Winning Bid</b></td>\n          <td>${yr(e,"cpm")}</td></tr>\n        <tr>\n          <td><b>Demand Source</b></td>\n          <td>${function(e){if(e.nobid)return hr;let t="";const n=function(e){const t=apntag.requests.tags;if(e.ads.length&&e.ads[0].seller_member_id)return e.ads[0].seller_member_id;for(const n in t)if(t.hasOwnProperty(n)&&t[n].uuid===e.uuid)return t[n].member;return null}(e);return t=e.ads[0].csm?"CSM":e.ads[0].buyer_member_id===n||e.ads[0].deal_id?e.ads[0].buyer_member_id!==n&&e.ads[0].deal_id?"Deal":e.ads[0].buyer_member_id===n?"Direct":"":"RTB",t}(e)}</td></tr>\n        <tr>\n          <td><b>Ad Type</b></td>\n          <td>${yr(e,"ad_type")}</td></tr>\n        <tr>\n          <td><b>Media Type</b></td>\n          <td>${yr(e,"media_type_id")}</td></tr>\n        <tr>\n          <td style="color: #555; font-size: smaller; padding-top: .5em;" colspan="2">\n            Console Ad Profile:\n            <a href="${function(e){return`//console.appnexus.com/ad-quality?id=${e.placement?.publisher.id}`}(e)}" target="_blank">${e.ad_profile_id}</a>\n            ${function(e){return e.ads?`| <a href="//ib.adnxs.com/cr?id=${e.ads[0].creative_id}" target="_blank">Creative Preview<a/>`:""}(e)}\n          </td>\n        </tr>\n      </table>\n    `).join(" "),n=document.body,a=document.createElement("div");a.id="appnexus_debug_window";const r=document.createElement("div");r.style.width="100%",r.style.height="400px",r.style.clear="both",n.insertBefore(r,null);const i=a.style;i.position="fixed",i.bottom="0px",i.left="0px",i.width="100%",i.height="450px",i.overflow="hidden",i["border-top"]="1px solid",i["z-index"]=999999,i.background="white",n.insertBefore(a,null);const s=document.createElement("div");s.style.width="100%",s.style.height="30px";const o=mr();a.appendChild(o);const d=o.contentWindow.document;d.open(),d.write(t),d.close()}}(e.tags),R(e.tags,e=>{let t=null,a=null;if(R(apntag.requests.tags,(n,r)=>{n.uuid===e.uuid&&(t=n,a=r)}),t){if(e.error&&t){const n=`There was an exception from targetId:${t.targetId} this usually means there is a setup error on the tag (invalid ID etc)`;re(n,null,e.error),S.trackCriticalError(B.Gy.L.R5,new Error(n));const a=Me(n,t.targetId,void 0,200);return void Pe.emit(B.qY.BAD_REQUEST,t.targetId,a)}if(e.ads&&e.ads.length&&e.ads[0].ad_type===Ur){const t=function(e){let t,n={};R(ha,n=>{n.uuid===e.uuid&&(t=n)}),t&&(n=t.native);const a=[];R(n,(e,t)=>{"custom"!==t&&!0===e.required&&a.push(t)});const r=rr(e),i=[];R(r.native,(e,t)=>{"custom"!==t&&(N(e)||i.push(t))});let s=i.length>0;if(R(a,e=>{s=s&&i.indexOf(e)>-1}),s&&n&&n.custom){const e=Vr(n.custom,"request");if(e.length>0){const t=Vr(r.native&&r.native.custom,"response");s=t.length>0&&e.every(e=>t.includes(e))}}return s}(e);if(!t){const e="required native assets missing from response";return S.trackCriticalError(B.Gy.L.R5,new Error(e)),void re(e)}}!function(e,t,n,a){const r=e.ads,i=function(e){let t=!1;return e&&R(e,e=>{"csm"===e.content_source&&(t=!0)}),t}(r),s=e.rtb_video_fallback,o=rr(e),d=Jr(o);if(w.addPlacementData(o.tagId,{adType:d}),i||s){t.utCalled=!0,i?t.isMediated=!0:t.isRtbVideoFallback=!0;const s=function(e){let t=Be;return Array.isArray(e)&&e.length>0&&e[0][Fe]===ze&&(t=ze),t}(r),d=function(e,t){let n={};return R(e,e=>{e.uuid===t.uuid&&e.mediationOptions&&(n=e.mediationOptions)}),n}(apntag.requests.tags,e);if(s===Fr)t.isVideoMediation=!0,Pe.emit(B.qY.AVAILABLE,n,o),Ve(s,e,d,Wr),E.trackCustomEvent({type:B.qY.LOADED_MEDIATED_VIDEO,batchId:a},o.tagId);else{t.isBannerMediation=!0;const r=function(e,t){{let n="<script>";return n+="var APN_macros = {};",n+=`APN_macros.uuid = "${e}";`,n+=`APN_macros.enableMediationEvents = ${apntag.requests.enableMediationEvents};`,n+=`APN_macros.expandByCreative = ${ue(e)};`,n+="APN_macros.ads = ",n+=`window.parent.apntag.getAdMarkup("${e}", "${t.uuid}");`,n+=";",n+=`document.write('<scr' + 'ipt src="${je}"></scr' + 'ipt>');`,$.addResourceToTrack(We,e=>e.includes(je)),n+="<\/script>",n}}(t.targetId,e);e.ad={ad_type:jr},t.ad={mediatedContent:r},Gr(t,e,n,a),E.trackCustomEvent({type:B.qY.LOADED_MEDIATED,batchId:a},o.tagId)}}else Gr(t,e,n,a)}(e,t,a,n)}else Hr(e)}),apntag.requests.checkDisplay&&Ce();const i=apntag.requests.trackingManagement&&apntag.requests.trackingManagement.userSync;if(i&&!1===i.syncEnabled)se("AST userSync feature was disabled as per setPageOpts.");else if(!0===Ua())se("AST userSync feature was disabled due to TCF consent choices.");else{let e=3e3;if(i&&i.syncDelay&&(e=i.syncDelay),e)return setTimeout(r,e);r()}}catch(e){const t=`Error during handleBidResponse logic: ${e.message}`;re(t)}function r(){{se("AST is loading the userSync URL.");const e=apntag.requests.trackingManagement&&apntag.requests.trackingManagement.userSync;let t=`${zr}?`;e&&(t+="number"==typeof e.sellerId?`seller_id=${e.sellerId}&`:"",t+="number"==typeof e.publisherId?`pub_id=${e.publisherId}&`:""),t=t.substring(0,t.length-1),at({strategy:"WithContentAndAttributes",data:{attributes:{id:Ae()+Math.random().toString(16).substr(2),src:t,sandbox:"allow-scripts allow-same-origin","data-anxtracker-usersync":""}}})}}}let Kr,Qr,ei;const ti={};let ni,ai=[];const ri=B.Oi.eC,ii=ri.BASE,si=ii+ri.DIV,oi=ii+ri.INDEX,di=ii+ri.TAG_ID,ci=ii+ri.INV_CODE,li=",",ui=":";let pi;function gi(e){return ge(e,pi)}function mi(e,t,n){const a=Number(t);if(isNaN(a))re("Force Creative must be a number");else{e.force_creative_id=a;const t=function(e,t){let n=null;return R(t,t=>{t.uuid===e.uuid&&(n=t.targetId)}),n}(e,n);ne(`Force Creative in use for targetId: ${t}`)}}function fi(e){if(!e||"object"!=typeof e)return!1;const t=Object.getPrototypeOf(e);return!(null!==t&&t!==Object.prototype&&null!==Object.getPrototypeOf(t))&&"[object Object]"===Object.prototype.toString.call(e)}function hi(e){return Number.isInteger(e)}const yi="Invalid schain object found: ",bi=" should be a string",vi=" should be an Integer",wi=" should be an object",Ii=" is not a valid schain property",ki={STRICT:"strict",RELAXED:"relaxed",OFF:"off"},Ei=[];R(ki,e=>Ei.push(e));const Ti=B.ZE.An,Si=B.ZE.pF,_i=B.ZE.HX,Ci=B.Oi.d2,Ai=B.Oi.Me,xi=B.Oi.Ux,Di=B.Oi.c8,$i=B.Oi.AI;function qi(e){const t=[];return R(e,(e,n)=>{if(Array.isArray(e)){const t=[];R(e,e=>{(e=ye(`keywords.${n}`,e))&&t.push(e)}),e=t}else{if(!F(e=ye(`keywords.${n}`,e)))return;e=[e]}const a={key:n,value:e};t.push(a)}),t}const Mi=function(e,t,n,a){const r={};if(e.disablePsa&&R(e.tags,e=>{e.disablePsa=!0}),e.msft&&(r.msft=e.msft),e.dsa){const t={};["dsarequired","pubrender","datatopub"].forEach(n=>{U(e.dsa[n])&&(t[n]=e.dsa[n])});const n=e.dsa.transparency;if(Array.isArray(n)&&n.every(e=>fi(e))){const e=[];n.forEach(t=>{F(t.domain)&&Array.isArray(t.dsaparams)&&t.dsaparams.every(e=>U(e))&&e.push(t)}),e.length>0&&(t.transparency=e)}N(t)||(r.dsa=t)}e.gdpr_consent&&(r.gdpr_consent=e.gdpr_consent),e.gpp_consent&&(r.privacy=e.gpp_consent),e.us_privacy&&(r.us_privacy=e.us_privacy),e.geoOverride&&(r.geo_override={country_code:e.geoOverride.countryCode,postal_code:e.geoOverride.zip});const i=[];let s=0;R(e.tags,e=>{if(!e.utCalled&&e.member===t&&function(e){if(!a)return!0;let t=!1;return R(a,n=>{e.targetId===n&&(t=!0)}),t}(e)){const t=function(e){const t={};if(e.uuid=de(),!N(e.sizes)){const n=xe(e.sizes);N(n)||(t.sizes=n,t.primary_size=n[0])}if(!N(e.privateSizes)){const n=xe(e.privateSizes);N(n)||(t.private_sizes=n)}if(e.supplyType&&F(e.supplyType)&&(t.supply_type=e.supplyType),e.pubClick&&F(e.pubClick)&&(t.pubclick={url:e.pubClick}),e.pubClickEnc&&F(e.pubClickEnc)&&(t.pubclickenc={url:e.pubClickEnc}),e.reserve&&(U(e.reserve)||Array.isArray(e.reserve))&&(t.reserve=e.reserve),e.extInvCode&&F(e.extInvCode)&&(t.ext_inv_code=e.extInvCode),t.uuid=e.uuid,e.tagId&&(t.id=e.tagId),e.formats&&(t.formats=e.formats),e.position&&("above"===e.position?t.position=1:"below"===e.position?t.position=2:t.position=0),e.invCode&&(t.code=e.invCode),e.prebid&&(t.prebid=e.prebid),e.externalImpId&&(t.external_imp_id=e.externalImpId),!0===e.allowSmallerSizes?t.allow_smaller_sizes=!0:t.allow_smaller_sizes=!1,!0===e.disablePsa&&(t.disable_psa=!0),e.allowedFormats&&(t.ad_types=e.allowedFormats),!0!==e.usePmtRule&&!1!==e.usePmtRule||(t.use_pmt_rule=e.usePmtRule),e.msft_tag&&F(e.msft_tag.msan_kv)&&(t.msft_tag={msan_kv:e.msft_tag.msan_kv}),"boolean"==typeof e.rewardedAd&&(t.rwdd=e.rewardedAd),F(e.globalPlacementId)&&(t.gpid=e.globalPlacementId),!N(e.video)){const n=e.video,a={};n.id&&(a.id=n.id),N(n.mimes)||(a.mimes=n.mimes),n.maxDuration&&(a.maxduration=n.maxDuration),n.minDuration&&(a.minduration=n.minDuration),n.startDelay&&(a.startdelay=n.startDelay),n.skippable&&(a.skippable=n.skippable),n.skipOffset&&(a.skipoffset=n.skipOffset),N(n.playbackMethod)||(a.playback_method=n.playbackMethod),N(n.frameworks)||(a.frameworks=n.frameworks),t.video=a}if(!N(e.native)){if(!N(e.native.ortb)){const n=function(e){try{e.eventtrackers=[{event:1,methods:[1,2]},{event:555,methods:[2]}];const t=JSON.stringify(e);return{ver:e.ver,request:t}}catch(e){re("invalid ortb native structure, please review setup",tagNativeObj.ortb)}}(e.native.ortb);n&&(t.openrtb_native=n)}const n=e.native,a={};n.renderer_id&&(a.renderer_id=n.renderer_id),n.placement_type&&(a.placement_type=n.placement_type);const r={};if(n.id&&(r.id=n.id),n.title&&(r.title=n.title),n.body&&(r.description=n.body),n.sponsoredBy&&(r.sponsored_by=n.sponsoredBy),n.image&&(r.main_image=n.image,N(r.main_image.sizes)&&(r.main_image.sizes=[{}])),n.icon&&(r.icon=n.icon,N(r.icon.sizes)&&(r.icon.sizes=[{}])),n.cta&&(r.ctatext=n.cta),n.desc2&&(r.desc2=n.desc2),n.rating&&(r.rating=n.rating),n.displayUrl&&(r.displayurl=n.displayUrl),n.likes&&(r.likes=n.likes),n.downloads&&(r.downloads=n.downloads),n.price&&(r.price=n.price),n.salePrice&&(r.saleprice=n.salePrice),n.phone&&(r.phone=n.phone),n.address&&(r.address=n.address),n.video&&(r.video={required:n.video.required||!1,min_duration:n.video.minDuration||0,max_duration:n.video.maxDuration}),n.privacySupported&&(r.privacy_supported=!0),n.customTitle1&&(r.customtitle1=n.customTitle1),n.customTitle2&&(r.customtitle2=n.customTitle2),n.customTitle3&&(r.customtitle3=n.customTitle3),n.customTitle4&&(r.customtitle4=n.customTitle4),n.customTitle5&&(r.customtitle5=n.customTitle5),n.customBody1&&(r.custombody1=n.customBody1),n.customBody2&&(r.custombody2=n.customBody2),n.customBody3&&(r.custombody3=n.customBody3),n.customBody4&&(r.custombody4=n.customBody4),n.customBody5&&(r.custombody5=n.customBody5),n.customCta1&&(r.customctatext1=n.customCta1),n.customCta2&&(r.customctatext2=n.customCta2),n.customCta3&&(r.customctatext3=n.customCta3),n.customCta4&&(r.customctatext4=n.customCta4),n.customCta5&&(r.customctatext5=n.customCta5),n.customDisplayUrl1&&(r.customdisplayurl1=n.customDisplayUrl1),n.customDisplayUrl2&&(r.customdisplayurl2=n.customDisplayUrl2),n.customDisplayUrl3&&(r.customdisplayurl3=n.customDisplayUrl3),n.customDisplayUrl4&&(r.customdisplayurl4=n.customDisplayUrl4),n.customDisplayUrl5&&(r.customdisplayurl5=n.customDisplayUrl5),n.customSocialUrl1&&(r.customsocialurl1=n.customSocialUrl1),n.customSocialUrl2&&(r.customsocialurl2=n.customSocialUrl2),n.customSocialUrl3&&(r.customsocialurl3=n.customSocialUrl3),n.customSocialUrl4&&(r.customsocialurl4=n.customSocialUrl4),n.customSocialUrl5&&(r.customsocialurl5=n.customSocialUrl5),n.customImage1&&(r.customimage1=n.customImage1),n.customImage2&&(r.customimage2=n.customImage2),n.customImage3&&(r.customimage3=n.customImage3),n.customImage4&&(r.customimage4=n.customImage4),n.customImage5&&(r.customimage5=n.customImage5),n.customIcon1&&(r.customicon1=n.customIcon1),n.customIcon2&&(r.customicon2=n.customIcon2),n.customIcon3&&(r.customicon3=n.customIcon3),n.customIcon4&&(r.customicon4=n.customIcon4),n.customIcon5&&(r.customicon5=n.customIcon5),n.customSocialIcon1&&(r.customsocialicon1=n.customSocialIcon1),n.customSocialIcon2&&(r.customsocialicon2=n.customSocialIcon2),n.customSocialIcon3&&(r.customsocialicon3=n.customSocialIcon3),n.customSocialIcon4&&(r.customsocialicon4=n.customSocialIcon4),n.customSocialIcon5&&(r.customsocialicon5=n.customSocialIcon5),!N(n.custom)){let e=100,t=[];Array.isArray(n.custom.data)&&n.custom.data.length>0&&(t=t.concat(n.custom.data)),Array.isArray(n.custom.images)&&n.custom.images.length>0&&(t=t.concat(n.custom.images)),t.forEach(t=>{t.id=e++}),r.custom=n.custom}Object.keys(r).length>0&&(a.layouts=[r]),t.ad_types=t.ad_types||[],-1===t.ad_types.indexOf("native")&&t.ad_types.push("native"),t.native=a}if(!N(e.keywords)){const n=qi(e.keywords);t.keywords=n}if(e.forceCreativeId){const n=Number(e.forceCreativeId);isNaN(n)?re("Force Creative must be a number"):(t.force_creative_id=n,ne(`Force Creative in use for targetId: ${e.targetId}`))}return e.nobidIfUnsold&&(t.nobid_if_unsold=!0),e.trafficSourceCode&&(t.traffic_source_code=e.trafficSourceCode.toString()),e.customPubLog&&(F(e.customPubLog)?t.custom_pub_log=e.customPubLog:re("customPubLog must be a string")),t}(e);e.utCalled=!0,e.tagNumber=s,s++,i.push(t)}}),function(e,t,n){if(!pe().includes(ii))return;let a,r,i,s,o,d;if(!N(gi(oi)))for(ai=gi(oi).split(li),a=0;a<ai.length;a++){o=ai[a].split(ui);const r=Number(o[0]);if(isNaN(r)||void 0===t[r])re(`Invalid ast_override value for index : ${r}`);else{d=null;let a=null;for(s=0;s<n.length;s++)s===r&&(a=n[s].uuid);for(i=0;i<t.length;i++)t[i].uuid===a&&mi(t[i],o[1],e)}}if(!N(gi(si)))for(ai=gi(si).split(li),a=0;a<ai.length;a++){o=ai[a].split(ui);let n=null;const s=Object.keys(e);for(i=0;i<s.length;i++)o[0]===s[i]&&(n=e[s[i]].uuid);if(n)for(r=0;r<t.length;r++)t[r].uuid===n&&mi(t[r],o[1],e);else re(`Invalid ast_override value for target div id : ${o[0]}`)}if(!N(gi(di)))for(ai=gi(di).split(li),a=0;a<ai.length;a++){o=ai[a].split(ui);let n=!1;for(r=0;r<t.length;r++)d=t[r],d.id===Number(o[0])&&(mi(d,o[1],e),n=!0);n||re(`Invalid ast_override value for tag id : ${o[0]}`)}if(!N(gi(ci)))for(ai=gi(ci).split(li),a=0;a<ai.length;a++){o=ai[a].split(ui);let n=!1;for(r=0;r<t.length;r++)d=t[r],d.code===o[0]&&(mi(d,o[1],e),n=!0);n||re(`Invalid ast_override value for invCode : ${o[0]}`)}}(e.tags,i,n),r.referrer_detection=function(e){const t={},n=e.refererInfo;if(n&&(t.rd_ref=n.referer,t.rd_top=n.reachedTop,t.rd_ifs=n.numIframes,t.rd_stk=Array.isArray(n.stack)?n.stack.join(","):null),e.pageUrlOverride){const n=!!(navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(ipad|iphone|ipod)/g)),a=!(!window.webkit||!window.webkit.messageHandlers);(n||a)&&(t.rd_can=e.pageUrlOverride)}return t}(e),r.tags=i,r.uuid=de(),r.member_id=t,r.sdk={source:"ast",version:"1.10.50"};let o=null;if(N(e.keywords)?N(e.targetingParams)||(o=qi(e.targetingParams),r.keywords=o):(o=qi(e.keywords),r.keywords=o),!N(e.user)&&(r.user=function(e){const t={};if(!N(e)){if(e.externalUid&&F(e.externalUid)&&(t.external_uid=e.externalUid),Array.isArray(e.segments)){const n=[];R(e.segments,e=>{U(e)?n.push({id:e}):fi(e)&&e.id&&U(e.id)&&e.value&&U(e.value)&&n.push(e)}),t.segments=n}const n=be("user.age",e.age,Si);t.age=n;const a=be("user.gender",e.gender,Si);t.gender=a;const r=be("user.language",e.language,Ti);t.language=r;const i=be("user.dnt",e.dnt,_i);t.dnt=i;const s=be("user.coppa",e.coppa,_i);t.coppa=s}return t}(e.user),!N(e.user.userIds))){const{eids:t}=function(e){function t(e,t,n,a){t&&(a?e.push({source:n,id:t,rti_partner:a}):e.push({source:n,id:t}))}const n=[];return Array.isArray(e)?R(e,e=>{if(fi(e)&&F(e.type)&&(F(e.id)||Array.isArray(e.eids)))switch(e.type.toLowerCase()){case"criteo":t(n,e.id,"criteo.com",null);break;case"ttd":t(n,e.id,"adserver.org","TDID");break;case"netid":t(n,e.id,"netid.de",null);break;case"liveramp":t(n,e.id,"liveramp.com",null);break;case"uid2":t(n,e.id,"uidapi.com","UID2");break;case"extendedids":R(e.eids,e=>{F(e.source)&&F(e.id)&&n.push({source:e.source,id:e.id})});break;default:n.push(e)}else ae("Invalid userId object",e)}):ae("Invalid userIds",e),{eids:n}}(e.user.userIds);r.eids=t}if(!N(e.content)){const t={},n=be("content.language",e.content.language,Ti);t.language=n,r.request_content=t}if(!N(e.schainConfig)){const t=function(e){let t=ki.STRICT;return void 0!==(n=e)&&(fi(n)||(re(`${yi} the schain config will not be used as it is not an object.`),0))?(F(e.validation)&&-1!==Ei.indexOf(e.validation)&&(t=e.validation),t===ki.OFF||function(e,t){const n=["complete","ver","ext","nodes"],a="Detected something wrong within the schain config:";let r="";function i(e){r+=`\n${e}`}function s(){t===ki.STRICT?re(a+r):ae(a+r)}if(!fi(e)&&(i(`schain.config ${wi}`),s(),t===ki.STRICT))return!1;if(Object.keys(e).forEach(e=>{-1===n.indexOf(e)&&i(`schain.config.${e} ${Ii}`)}),U(e.complete)&&hi(e.complete)||i(`schain.config.complete ${vi}`),F(e.ver)||i(`schain.config.ver ${bi}`),me(e,"ext")&&(fi(e.ext)||i(`schain.object.ext ${wi}`)),Array.isArray(e.nodes)){const t=["asi","sid","hp","rid","name","domain","ext"];e.nodes.forEach((e,n)=>{fi(e)?(Object.keys(e).forEach(e=>{-1===t.indexOf(e)&&i(`schain.config.nodes[${n}].${e} ${Ii}`)}),F(e.asi)||i(`schain.config.nodes[${n}].asi ${bi}`),F(e.sid)||i(`schain.config.nodes[${n}].sid ${bi}`),U(e.hp)&&hi(e.hp)||i(`schain.config.nodes[${n}].hp ${vi}`),me(e,"rid")&&(F(e.rid)||i(`schain.config.nodes[${n}].rid ${bi}`)),me(e,"name")&&(F(e.name)||i(`schain.config.nodes[${n}].name ${bi}`)),me(e,"domain")&&(F(e.domain)||i(`schain.config.nodes[${n}].domain ${bi}`)),me(e,"ext")&&(fi(e.ext)||i(`schain.config.nodes[${n}].ext ${wi}`))):i(`schain.config.nodes[${n}] ${wi}`)})}else if(i("schain.config.nodes  should be an Array"),s(),t===ki.STRICT)return!1;return!(r.length>0&&(s(),t===ki.STRICT))}(e.config,t)?e.config:(re(`${yi} due to 'strict' validation setting, the schain object will not be passed.  See the above error for details.`),null)):null;var n}(e.schainConfig);t&&(r.schain=t)}N(e.device)||(r.device=function(e){const t={},n=e.device;if(!N(n)){N(n.useragent)||(t.useragent=n.useragent),N(n.geo)||(t.geo=n.geo),N(n.ip)||(t.ip=n.ip),N(n.deviceType)||(t.devicetype=n.deviceType),N(n.make)||(t.make=n.make),N(n.model)||(t.model=n.model),N(n.os)||(t.os=n.os),N(n.osVersion)||(t.os_version=n.osVersion),N(n.carrier)||(t.carrier=n.carrier);const e=be("device.connectionType",n.connectionType,Si);t.connectiontype=e,N(n.mcc)||(t.mcc=n.mcc),N(n.mnc)||(t.mnc=n.mnc),N(n.lmt)||(t.lmt=n.lmt),N(n.deviceId)||(t.device_id=n.deviceId);const a=be("device.devTime",n.devTime,Si);t.devtime=a;const r=be("device.devHeight",n.devHeight,Si);t.h=r;const i=be("device.devWidth",n.devWidth,Si);t.w=i;const s=be("device.ppi",n.ppi,Si);t.ppi=s;const o=be("device.pxratio",n.pxratio,Si);t.pxratio=o}return t}(e)),N(e.app)||(r.app=function(e){const t={},n=e.app;return N(n)||N(n.appid)||(t.appid=n.appid),t}(e)),N(e.site)||(r.site=function(e){const t={},n=e.site;return N(n)||N(n.id)||(t.id=n.id),t}(e)),e.publisherId&&(r.publisher_id=e.publisherId),e.auctionTimeout&&(r.auction_timeout_ms=e.auctionTimeout),e.auctionDeadline&&(r.auction_deadline_ms=e.auctionDeadline),r.tags=i;const d=ge(Ci)||apntag.dongle;d&&!apntag.dongle&&(apntag.dongle=d),((ge(Ai)||apntag.toolkit)&&d||!N(e.toolkit))&&(r.toolkit={enabled:!0,dongle:d||e.toolkit.dongle});const c=ge(Di);c&&""!==c&&(apntag.debug_member=c);const l=ge($i);l&&""!==l&&(apntag.debug_bidder=l);const u="TRUE"===ge(xi).toUpperCase();if(u&&""!==u&&(apntag.requests.test=u),apntag.debug&&!N(apntag.dongle)){let e="";apntag.debug_member&&(e=apntag.debug_member);const t=function(e,t,n){const a={};return apntag.debug&&!N(t)&&(a.enabled=!0,e&&(a.member_id=Number(e)),t&&(a.dongle=String(t)),n&&(a.bidder_id=Number(n)),a.debug_timeout=1e3),a}(e,apntag.dongle,apntag.debug_bidder);r.debug=t}return r},Ri=function(e){return function(){try{const t=function(){const t=function(){const t=[];let n;do{try{n=n?n.parent:e;try{t.push({referrer:n.document.referrer||null,location:n.location.href||null,isTop:n===e.top})}catch(a){t.push({referrer:null,location:null,isTop:n===e.top}),ae("Trying to access cross domain iframe. Continuing without referrer and location")}}catch(e){return t.push({referrer:null,location:null,isTop:!1}),t}}while(n!==e.top);return t}(),n=function(){try{if(!e.location.ancestorOrigins)return;return e.location.ancestorOrigins}catch(e){}}();if(n)for(let e=0,a=n.length;e<a;e++)t[e].ancestor=n[e];return t}(),n=t.length-1,a=null!==t[n].location||n>0&&null!==t[n-1].referrer,r=function(e){const t=[];let n,a=null,r=null,i=null,s=null,o=null,d=null;for(n=e.length-1;n>=0;n--){try{r=e[n].location}catch(e){}if(r)a=encodeURIComponent(r),t.push(a),d||(d=a);else if(0!==n){i=e[n-1];try{s=i.referrer,o=i.ancestor}catch(e){}s?(a=encodeURIComponent(s),t.push(a),d||(d=a)):o?(a=encodeURIComponent(o),t.push(a),d||(d=a)):t.push(null)}else t.push(null)}return{stack:t,detectedRefererUrl:d}}(t);return{referer:r.detectedRefererUrl,reachedTop:a,numIframes:n,stack:r.stack}}catch(e){}}}(window);function Oi(e,t,n,a,r,i){Array.isArray(n)&&n.length>0?n.forEach(t=>{Pi(e,t,a,r,i)}):R(ma[t],t=>{Pi(e,t,a,r,i)})}function Pi(e,t,n,a,r){0===n&&(e="Failure to contact endpoint. This can be caused by invalid CORS headers or failure of server to respond.");const i=apntag.requests.tags[t];let s,o;i&&(s=rr(i.adResponse),o=i.tagId);const d=Me(e,t,r,n);Pe.emit(a,t,d,s);const c=new Error(e);r&&r.telemetryData&&(c.telemetryData=r.telemetryData),S.trackCriticalError(B.Gy.L.Ny,c,o)}const Li=function(e,t,n){{const a=va,r=function(e){return`${e.url+(e.url.indexOf("?")+1?"&":"?")}cb=apntag.handleCb&q=${encodeURI(e.data)}`}(e),i=oe(a,r);apntag.requests.utCalled=!0,i.onload=function(){ne("JSONP fallback used instead of POST.")},i.onerror=function(a){if(!apntag.requests.errorReported){const r=`Unknown script error contacting endpoint over JSONP. Endpoint: ${e.url}`;Oi(r,t,n,"-1",B.qY.REQUEST_FAIL,a),re(r)}},i.onreadystatechange=function(a){if(!("loaded"!==i.readyState&&"complete"!==i.readyState||apntag.requests.cbCalled||apntag.requests.errorReported)){apntag.requests.errorReported=!0;const r=`Unknown network error contacting endpoint over JSONP. Endpoint: ${e.url}`;Oi(r,t,n,"-1",B.qY.REQUEST_FAIL,a),re(r)}}}},Ni=(e,t,n)=>{try{((e,t)=>{const n=[];e.forEach(e=>{const{targetId:a,tagId:r,invCode:i,flights:s,isoRTBUsed:o}=e,d=apntag.requests.tags[a]?.adTrackingId,c=performance.now();apntag.requests.tags[a]&&(apntag.requests.tags[a].flights=s||[]),apntag.requests.tags[a]?.perfTimings&&(apntag.requests.tags[a].perfTimings.request=c,apntag.firstRequestTracked||(apntag.requests.tags[a].perfTimings.firstRequest=c,apntag.firstRequestTracked=!0,E.trackCustomEvent({type:"firstRequest",targetId:a,batchId:t,invCode:i,performance:c,adTrackingId:d},r))),w.addPlacementData(r,{placementId:r}),E.trackEvent({type:"adServerRequest",data:{batchId:t,invCode:i,isoRTBUsed:o,targetId:a,performance:performance.now(),adTrackingId:d}},r),n.includes(a)?E.trackCustomEvent({type:"duplicateTargetId",targetId:a,batchId:t},r):n.push(a);let l,u=document.getElementById(a);if(!u&&apntag.requests.tags[a]&&(l=apntag.requests.tags[a].wcElement),!u&&!l){const e=`Unable to locate ad slot with targetId ${a} for Telemetry logging.`;return E.trackCustomEvent({type:"adSlotNotFound",targetId:a,batchId:t,isWebComponent:!!l},r),void ne(e)}u=u||l;const p=(e=>{if(!e)return void re(`Ad slot with targetId ${e.id} not found.`);const t=e.getBoundingClientRect(),n=t.top,a=t.bottom,r=t.height,i=n<window.innerHeight&&a>=0;if(0===r&&i)return!0;const s=i?Math.min(window.innerHeight,a)-Math.max(0,n):0;return i&&s/r>=.5})(u);let g,m;if(!apntag.requests.disableExpander&&!w.skipLogging){const e=(()=>{const e=document.createElement("div");return e.style.all="unset",e.style.display="block",e.style.width="10000px",e.style.height="10000px",e})();u.appendChild(e),({size:g,position:m}=$e(a)),u.removeChild(e)}const{size:f,position:h}=$e(a);E.trackCustomEvent({type:"preRenderAdData",targetId:a,batchId:t,invCode:i,isVisible:p,sizeWithExpander:g,positionWithExpander:m,sizeWithoutExpander:f,positionWithoutExpander:h,isWebComponent:!!l},r)})})(JSON.parse(t.data).tags.map((e,t)=>{const a=(e.keywords||[]).filter(e=>"flight"===e.key).flatMap(e=>e.value),r=!!e.openrtb_native;return{targetId:n[t],tagId:e.id,invCode:e.code,flights:a,isoRTBUsed:r}}),e)}catch(e){const t=`Error logging pre-render telemetry: ${e.message}`;re(t),S.trackCriticalError(B.Gy.L.NV,new Error(t))}},Ui=function(e,t,n){!function(e,t){R(apntag.requests.tags,e=>{e.utCalled||-1===t.indexOf(e.targetId)||Pe.emit(B.qY.REQUEST,e.targetId)}),ie(`Ad is requested for member ${e}`)}(e,t);const a=apntag.requests;let r=Mi(a,e,ha,t);r=function(e){if(ve().context&&"AMP-AD"===ve().context.tagName){e.is_amp=!0,e.referrer_detection&&(e.referrer_detection.rd_can=ve().context.canonicalUrl);const t=ve().context.consentSharedData;if(t){const n={consent_string:t.consentString,consent_required:t.consentRequired};e.gdpr_consent=n}}return e}(r);const i=function(e){const t={},n=(()=>{Ta||(ka===`https://${B.sR.hK}`&&Ua()&&(ka=`https://${B.sR.sp}`),ka!==`https://${B.sR.sp}`||Ua()||(ka=`https://${B.sR.hK}`));let e=ka;Sa&&(e=`https://${B.sR.HM}`);let t=!1;return R(apntag.requests.tags,e=>{e.prebid&&(t=!0)}),t?e+B.sR.VW:e+B.sR.Yh})();return t.url=n,t.data=JSON.stringify(e),t}(r);N(r.tags)?ae("ast.loadTagsByMemberId: no defined tags at this point so no /UT request will be made"):"withCredentials"in new XMLHttpRequest?function(e,t,n,a){const r=e.data,i=new XMLHttpRequest;Ni(a,e,n),i.onload=function(){let e=null;if(200===this.status)try{e=JSON.parse(this.responseText),apntag.handleCb(e,r,a,n)}catch(e){re(`failed to parse ad response from impbus: ${e.message}`),Oi(e.message,t,n,this.status,B.qY.REQUEST_FAIL,e)}else re(`AST encountered an unexpected HTTP response: ${this.status} : ${this.statusText}`),Oi(`AST encountered an unexpected HTTP response: ${this.status} : ${this.statusText}`,t,n,this.status,B.qY.REQUEST_FAIL)};const s=performance.now(),o=function(a,r="error"){const i=a.target||this,o=performance.now()-s,d=function(e,t,n){return"timeout"===e.type||t.timeout>0&&n>=t.timeout?"timeout":"abort"===e.type?"abort":!1===navigator.onLine||0===t.status&&!t.responseURL?"network":"unknown"}(a,i,o),c={readyState:i.readyState,status:i.status,statusText:i.statusText?i.statusText.substring(0,100):"",responseType:i.responseType,timeout:i.timeout,withCredentials:i.withCredentials,networkErrorType:d,elapsedMs:Math.round(o),eventType:a.type||r,responseURL:i.responseURL,onlineStatus:navigator.onLine},l=i.status||0;Oi(`Error contacting impbus endpoint: ${e.url} [${d}] status:${l} readyState:${i.readyState}`,t,n,l,B.qY.REQUEST_FAIL,{originalEvent:a,telemetryData:c})};i.onerror=o,i.ontimeout=function(e){o(e,"timeout")},i.onabort=function(e){o(e,"abort")},$.addResourceToTrack("adRequestUrl",t=>t.includes(e.url),{serverTimings:!0}),i.open("POST",e.url,!0),i.setRequestHeader("Content-Type","text/plain"),apntag.requests.test&&i.setRequestHeader("X-Is-Test",1),i.withCredentials=!0;try{i.send(r),apntag.requests.utCalled=!0}catch(n){re(`Error making POST request: ${n}`),Li(e,t)}}(i,e,t,n):Li(i,e,t)},ji=function(e){R(ma,(t,n)=>{const a=Number(n);if("none"!==n&&isNaN(a))re("Invalid value for member");else{const t="none"===n?n:Number(n),a=280===t&&apntag.requests.use1pEndpoint;Sa=a,apntag.requests.refererInfo=Ri();const r=1e8,i=Math.floor(Math.random()*r);R(e,e=>{const t=apntag.requests.tags[e];if(!t.adTrackingId){const n=Math.floor(Math.random()*r);t.adTrackingId=n,t.batchId=i,E.trackCustomEvent({type:"loadTags",batchId:i,adTrackingId:n,performance:performance.now(),targetId:e}),t.perfTimings={}}}),Ui(t,e,i)}})},Fi=function(e){try{e=e||he(apntag.requests.tags,e=>e.targetId),Array.isArray(e)||(e=[e]);let t=!1,n=!1,a=!1;Zn(apntag.requests,()=>{t=!0,n&&a&&ji(e)}),function(r){Qr=r;const i=()=>{n=!0,t&&a&&ji(e)};let s;function o(e){const t={us_privacy:e?e.uspString:void 0};Qr.us_privacy=t.us_privacy}function d(e){clearTimeout(s),o(),Te(c(e))}function c(e){e&&ae(`${e} Resuming request without CCPA USP consent information.`),i()}if(Qr.consentManagement&&(Qr.consentManagement.disabled||Qr.consentManagement.usp&&Qr.consentManagement.usp.disabled))return se("USP Consent module was disabled."),Te(c());let l=1e4;if(Qr.consentManagement&&U(Qr.consentManagement.timeout)&&(l=Qr.consentManagement.timeout),Kr)return o(Kr),Te(c());s=setTimeout(function(){d("CCPA USP CMP workflow exceeded timeout threshold.")},l),function(e,t){const n={};let a;try{a=window.__uspapi||window.top.__uspapi}catch(e){}if(j(a))a("getUSPData",1,e);else{let a,r=window;for(;!a;){try{r.frames.__uspapiLocator&&(a=r)}catch(e){}if(r===window.top)break;r=r.parent}if(!a)return t("CCPA USP CMP not found.");!function(t){function a(e){const t="string"==typeof e.data&&e.data.includes("uspapiReturn")?JSON.parse(e.data):e.data;if(t.__uspapiReturn){const e=t.__uspapiReturn;n[e.callId](e.returnValue,e.success),delete n[e.callId]}}window.__uspapi=function(e,a,r){const i=`${Math.random()}`,s={__uspapiCall:{command:e,version:a,callId:i}};n[i]=r,t.postMessage(s,"*")},K(window,"message",a,!1),window.__uspapi("getUSPData",1,function(t){Q(window,"message",a,!1),e(t)})}(a)}}(function(e){"object"!=typeof e||null===e||"string"!=typeof e.uspString||""===e.uspString?d(`CCPA USP CMP returned unexpected consentObject during lookup process; returned value was (${e})`):(clearTimeout(s),Kr=e,o(Kr),Te(c()))},d)}(apntag.requests),function(r){ni=r;const i=()=>{a=!0,t&&n&&ji(e)},s="__gpp";let o;function d(e){const t={gpp:e&&""!==e.gppString?e.gppString:void 0};e&&e.applicableSections?t.gpp_sid=e.applicableSections:e&&e.applicableSection?t.gpp_sid=e.applicableSection:t.gpp_sid=ti.applicableSections,t.gpp_sid&&-1===t.gpp_sid[0]&&(t.gpp_sid=void 0),ni.gpp_consent=t}function c(e,t){clearTimeout(o),d(t),Te(l(e))}function l(e){e&&ae(`${e} Resuming request without GPP consent information.`),i()}const u=ni.consentManagement;if(u&&(u.disabled||u.gpp&&u.gpp.disabled))return se("GPP Consnent module was disabled."),Te(l());let p=1e4;u&&U(u.timeout)&&(p=ni.consentManagement.timeout),o=setTimeout(function(){c("GPP CMP workflow exceeded timeout threshold.",ti)},p),function(e,t){function n(e){return e&&Array.isArray(e.applicableSections)&&e.applicableSections.length>0&&0!==e.applicableSections[0]}function a(e){return e&&Array.isArray(e.applicableSection)&&e.applicableSection.length>0&&0!==e.applicableSection[0]}const r={};let i=!1;const{cmpFrame:o,cmpDirectAccess:d}=function(){let e,t=window,n=!1;for(;;){try{if("function"==typeof t[s]){e=t,n=!0;break}}catch(e){}try{if(t.frames.__gppLocator){e=t;break}}catch(e){}if(t===window.top)break;t=t.parent}return{cmpFrame:e,cmpDirectAccess:n}}();if(!o)return t("GPP CMP not found.");if(d&&j(o[s])){se("Detected GPP CMP API is directly accessible, calling it now...");const e=o[s]("ping",(e,n)=>{!0===n&&e&&"1.1"===e.gppVersion?(se("Detected GPP CMP is running version 1.1.  Proceeding with next steps..."),ei="1.1",o[s]("addEventListener",c)):n||t('GPP CMP returned a failed "success" when calling the ping command. Check the state of CMP.')});e&&"1.0"===e.gppVersion&&(se("Detected GPP CMP is running version 1.0.  Proceeding with next steps..."),ei="1.0",o[s]("addEventListener",c))}else se("Detected GPP CMP is outside the current iframe where AST is located, calling it now..."),l("ping",o,e=>{!e||"1.0"!==e.gppVersion&&"1.1"!==e.gppVersion||(se(`Detected GPP CMP is running version${e.gppVersion}.  Proceeding with next steps...`),ei=e.gppVersion,l("addEventListener",o,u))});function c(r){if(r)if(se("Received a response from GPP CMP for eventlistener",r),r.pingData&&"error"===r.pingData.cmpStatus)t("CMP returned with a cmpStatus:error response.  Please check CMP setup.");else if("1.0"===ei){if("sectionChange"===r.eventName||"loaded"===r.pingData.cmpStatus&&"visible"!==r.pingData.cmpDisplayStatus){const t=o[s]("getGPPData");se("Received a response from GPP CMP for getGPPData",t),e(t)}else if(!ti.applicableSections){const e=o[s]("getGPPData");se("Called GPP CMP early to determine the value of applicableSections, value returned from CMP: ",e),n(e)?ti.applicableSections=e.applicableSections:a(e)&&(ti.applicableSections=e.applicableSection)}}else"1.1"===ei&&("sectionChange"===r.eventName||"signalStatus"===r.eventName&&"ready"===r.data||r.pingData&&"loaded"===r.pingData.cmpStatus&&"visible"!==r.pingData.cmpDisplayStatus?(se("Received a desired event response from GPP CMP, pingData was: ",r.pingData),e(r.pingData)):ti.applicableSections||(se("Called GPP CMP early to determine the value of applicableSections, value returned from CMP: ",r.pingData),n(r.pingData)&&(ti.applicableSections=r.pingData.applicableSections)))}function l(e,t,n,a){const o=`${s}Call`;i||(window.addEventListener("message",function(e){const t=`${s}Return`,n="string"==typeof e.data&&e.data.includes(t)?JSON.parse(e.data):e.data;if(n[t]&&n[t].callId){const e=n[t];r.hasOwnProperty(e.callId)&&r[e.callId](e.returnValue)}},!1),i=!0),se("Making a postMessage call to the CMP for command: ",e);const d=Math.random().toString(),c={[o]:{command:e,parameter:a,version:"1.0"===ei?1:ei,callId:d}};r[d]=n,t.postMessage(c,"*")}function u(a){a&&(se("Received a response from GPP CMP for eventlistener",a),"error"===a.pingData.cmpStatus?t("CMP returned with a cmpStatus:error response.  Please check CMP setup."):"1.0"===ei?"sectionChange"===a.eventName||"loaded"===a.pingData.cmpStatus&&"visible"!==a.pingData.cmpDisplayStatus?l("getGPPData",o,g):ti.applicableSections||l("getGPPData",o,p):"1.1"===ei&&("sectionChange"===a.eventName||"signalStatus"===a.eventName&&"ready"===a.data||a.pingData&&"loaded"===a.pingData.cmpStatus&&"visible"!==a.pingData.cmpDisplayStatus?(se("Received a desired event response from GPP CMP, pingData was: ",a.pingData),e(a.pingData)):ti.applicableSections||(se("Called GPP CMP early to determine the value of applicableSections, value returned from CMP: ",a.pingData),n(a.pingData)&&(ti.applicableSections=a.pingData.applicableSections))))}function p(e){se("Called GPP CMP early to determine the value of applicableSections, value returned from CMP: ",e),n(e)?ti.applicableSections=e.applicableSections:a(e)&&(ti.applicableSections=e.applicableSection)}function g(t){se("Received a response from GPP CMP for getGPPData",t),e(t)}}(function(e){e&&"object"==typeof e&&null!==e&&"string"==typeof e.gppString&&(Array.isArray(e.applicableSections)||Array.isArray(e.applicableSection))?(clearTimeout(o),d(e),Te(l())):c(`GPP CMP returned unexpected consentObject during lookup process; returned value was (${e})`)},c)}(apntag.requests)}catch(e){const t=`Error during loadTags() call: ${e.message}`;re(t)}};function Bi(e){if(ne(`getTag called for tag ${e}`),_e(e))return e&&fa[e]?fa[e]:void 0;re(`the ${e} tag is not defined.`,B.$9.Z)}const zi=function(e){const t={};return 0===e.length?apntag.requests.tags:(R(apntag.requests.tags,(n,a)=>{for(let r=0;r<e.length;r++)e[r]===a&&(t[a]=n)}),t)};function Wi(e,t){va.document.querySelectorAll(`[${e}${null!==t?`="${t}"`:""}]`).forEach(e=>e.remove())}const Vi=function(e){const t=zi(e);R(t,(e,n)=>{R(ga,e=>{if(n===e){const a=va.document,r=t[n].wcElement||a.getElementById(e);if(!r)return;for(;r.hasChildNodes();)r.removeChild(r.firstChild)}})}),va.document.querySelectorAll("[data-anxtracker-usersync]").forEach(e=>e.remove()),e.length>0?R(e,e=>{Wi("data-anxtracker",e)}):Wi("data-anxtracker",null)};w.addSessionData({}),(e=>{if(w.inited)throw Error("Telemetry is already inited.");var t;w.setSampleRate(e),w.inited=!0,(t=S).isServiceAlreadyInited("error")||(window.addEventListener("error",e=>{m(e.filename,"ast")&&t.trackCriticalError("unhandled",e)}),window.addEventListener("unhandledrejection",e=>{const n=function(e=""){return e.match(/http(s?):\/\/\S+/)?.[0]}(e.reason instanceof Error?e.reason.stack:void 0);n&&m(n,"ast")&&t.trackCriticalError("unhandled.rejection",e.reason)})),y()?.includes("give_me_error_please")&&setTimeout(()=>{throw new Error("I'm error from the prod")},1e3),$.init(undefined),E.trackEvent({type:"sdkInit",data:void 0})})(.001),E.trackCustomEvent({type:"ast.init",performance:performance.now()});const Hi=B.Ve.s6,Gi=B.Ve.G_,Ji=B.ZJ.ZH,Xi=B.ZJ.uk,Zi=B.AD.JN;K(va,"message",function(e){if(e.origin!==Ee()||"string"!=typeof e.data)return;let t;se("Data sent from creative",e.data);try{t=JSON.parse(e.data)}catch(t){return void("nobid"===e.data?ne("No bid response returned"):re(`Invalid data from creative: ${e.data}`))}if(me(t,"eventType"))"adError"===t.eventType&&window.apntag.recordErrorEvent(t.exception,t.targetId);else switch(t.name){case"expand":!function(e){{ne("Expand iframe started by host");let t,n,a,r,i=!1,s=!1,o=0,d=0,c=0,l=0,u=ve().document.getElementById(B.H3.C+e.targetId);const p=lt.getInstance().getIframe(e.targetId),g=p.iframe.style;u||(u=p.iframe.parentNode);const m=u.style;m.display="";let f=parseInt(m.width,10),h=parseInt(m.height,10);if(isNaN(f)&&(f=0),isNaN(h)&&(h=0),e.bounds.multiDir?(n=be("data.bounds.left",e.bounds.left,Yn),r=be("data.bounds.right",e.bounds.right,Yn),t=be("data.bounds.top",e.bounds.top,Yn),a=be("data.bounds.bottom",e.bounds.bottom,Yn),c=f+n+r,l=h+t+a,t?(d=-1*t,s=!0):d=0,n?(o=-1*n,i=!0):o=0):(o=e.bounds.x,d=e.bounds.y,i=o<0,s=d<0,c=i?f+-1*o:f+o,l=s?h+-1*d:h+d),c<=f&&l<=h)return;g.width=`${c}px`,g.height=`${l}px`,i&&(g.left=`${o}px`),s&&(g.top=`${d}px`),g.zIndex=B.l2.D,g.position="relative",m.position="relative",e.bounds.push?(m.width=`${c}px`,m.height=`${l}px`):(m.width=`${f}px`,m.height=`${h}px`);const y=function(){!function(e,t,n){{const a=n.iframe.contentWindow,r={};r.targetId=t.targetId,r.status=e,r.geom=na(t.targetId,n.iframe),Et(a,JSON.stringify(r),Ee())}}(B.l2.X.gH,e,p)};e.ext&&"number"==typeof e.ext.tweenTime?function(e,t,n,a){{const r=t.style;r.transition=`height ${e.ext.tweenTime}ms ease`,r.height=n,r["overflow-y"]="hidden",K(t,"transitionend",()=>{"function"==typeof a&&a()})}}(e,p.iframe,l,y):y()}}(t);break;case"collapse":!function(e){{ne("Collapse iframe started by host");const t=ve(),n=lt.getInstance().getIframe(e.targetId),a=n.iframe.style;let r=t.document.getElementById(B.H3.C+e.targetId);r||(r=n.iframe.parentNode);const i=r.style;let s=n.originalWidth,o=n.originalHeight;e.ext&&(0===e.ext.width&&(s=0),0===e.ext.height&&(o=0)),a.left="",a.top="0px",i.width=`${s}px`,a.width=`${s}px`,i.height=`${o}px`,a.height=`${o}px`,a.zIndex="";const d=n.iframe.contentWindow,c={};c.targetId=e.targetId,c.geom=na(e.targetId,n.iframe),c.status=B.l2.X.g,Et(d,JSON.stringify(c),Ee())}}(t);break;case"cmp":!function(e){{function t(){const t=apntag.requests.gdpr_consent,n=lt.getInstance().getIframe(e.targetId).iframe.contentWindow,a={targetId:e.targetId,gdpr_consent:t,status:B.l2.X.dl};Et(n,a,Ee())}if(apntag.requests.gdpr_consent)return void t();Zn(apntag.requests,t)}}(t);break;case"resizeAd":apntag.resizeAd(t.targetId,t.cmd);break;case"mediatedNative":apntag.handleMediationBid(t.targetId);break;case"emitEvent":apntag.emitEvent.apply(null,t.cmd);break;case"message":default:break;case"updateRenderStatus":yt.setRendererStatus(`${t.rId}_${t.targetId}`,t.status);break;case"setParentDivStyleDefaultProp":{const e=apntag.requests.tags[`${t.targetId}`].wcElement,n=e?e.querySelector(`#${B.H3.C}${t.targetId}`):document.getElementById(B.H3.C+t.targetId);R(t.cmd,(e,t)=>{""===n.style[t]&&(n.style[t]=e)});break}}}),ya.expansionByPush=!1,ya.expansionByOverlay=!0,ya.readCookie=!1,ya.writeCookie=!1,ya.sandbox=!1,function(){if(ct)try{K(ua.document,"apntag_iTunesLaunch",pa)}catch(e){}}(),K(window,"message",e=>{try{const t=e.data;if("perfObserverError"===t.eventName)return re(`Performance observer error in iframe for ${t.targetId}: ${t.error}`),void S.trackCriticalError(B.Gy.L.im,new Error(`Error in iframe performance observer for ${t.targetId}: ${t.error}`));if(t?.targetId&&t.eventName&&"first-contentful-paint"===t.eventName){const e=t.targetId,n=apntag.requests.tags[e];if(!n)return;const a=n.adTrackingId,r=`${e}_${a}`,i=tt[r];if(nt[r])return;if(se(`Received first-contentful-paint event for targetId: ${e}`),i){const s=performance.now()-i;n.perfTimings&&(n.perfTimings.creativeData={creativeId:n.adResponse.ads[0].creative_id,auctionId:t.auctionId,adomain:t.adomain,buyerMemberId:t.buyerMemberId,msxCreativeId:t.msxCreativeId,bidderId:t.bidderId},n.perfTimings.creativeRenderTime=s),se(`Render time for ${e}: ${s}ms (first-contentful-paint)`),nt[r]=!0;const o=n.tagId||n.adResponse.tag_id;E.trackCustomEvent({type:"creativeRenderTime",targetId:e,adTrackingId:a,batchId:t.batchId,renderTime:s,paintEvent:"first-contentful-paint",performance:performance.now(),adomain:t.adomain,buyerMemberId:t.buyerMemberId,msxCreativeId:t.msxCreativeId,crids:t.crids,auctionId:t.auctionId,bidderId:t.bidderId},o,{sampling:.01});const d=apntag.getPerfTimings(e);d&&E.trackCustomEvent({type:"perfTimings",targetId:e,adTrackingId:a,batchId:t.batchId,performance:performance.now(),...d},o,{sampling:.01}),delete tt[r],setTimeout(()=>{delete nt[r]},6e4)}}}catch(e){re("Error processing paint event message:",e),S.trackCriticalError(B.Gy.L.PL,new Error(`Error processing paint event message: ${e}`))}});try{console.info?console.info("AST library loaded: 1.10.50"):console.log("AST library loaded: 1.10.50")}catch(e){}va.apntag=typeof va.apntag!==Ji?va.apntag:{};const Yi=va.apntag;function Ki(e){e.length>0?(R(e,e=>{e&&!_e(e)&&ae(`${e} is not defined.`,B.$9.Z)}),R(Yi.requests.tags,t=>{const n=t.targetId;if(e.includes(Yi.requests.tags[n].targetId)){const e=Ma(),t=$a();0!==Object.keys(e).length&&(delete e[n],Ra(e)),0!==Object.keys(t).length&&(delete t[n],qa(t)),delete Yi.requests.tags[n],lt.getInstance().removeIframe(n),se(`Removed tag with targetId '${n}' from AST internals.`)}}),0===Object.keys(Yi.requests.tags).length&&(Yi.requests={},Yi.requests.tags={})):(Yi.requests={},Yi.requests.tags={},Ra({}),qa({}),lt.getInstance().resetInstance(),se("Removed all tags from AST internals."))}function Qi(e){let t={};return R(Yi.requests.tags,n=>{e!==n.uuid&&e!==n.targetId||(t=n)}),t}function es(e,t,n="all"){const a=t instanceof Element,r=a?t.id:t,i=a?t:document.getElementById(t),s=Qi(e.uuid);se(`Firing ${n} trackers for ${e.tagId}`),r&&se(`Loading ${n} trackers in DOM element ${r}`),"all"!==n&&"imp"!==n||E.trackEvent({type:_,data:{enableSafeFrame:!(!s.enableSafeFrame&&!s.alwaysUseXDomainIframe),batchId:e.batchId,performance:performance.now(),adTrackingId:s?.adTrackingId}},e.tagId);try{const t=e?.native?.ortb;t&&("all"!==n&&"imp"!==n||ts(t.imptrackers,i),"all"!==n&&"js"!==n||!ns(t.jstracker)||as(t.jstracker,e,i),Array.isArray(t.eventtrackers)&&t.eventtrackers&&t.eventtrackers.forEach(t=>{"all"!==n&&"imp"!==n||1!==t.event||1!==t.method?"all"!==n&&"js"!==n||1!==t.event||2!==t.method||!ns(t.url)||as(t.url,e,i):ts(t.url,i)})),"all"!==n&&"imp"!==n||ts(e?.native?.impressionTrackers,i),"all"!==n&&"js"!==n||!ns(e?.native?.javascriptTrackers)||as(e.native.javascriptTrackers,e,i)}catch(t){re("Encountered error loading imp or js tracker for adObj:",e,t)}("all"===n||"view"===n)&&s&&s.trackingManagement&&s.trackingManagement.native&&s.trackingManagement.native.loadViewScriptAt===B.nP.G.D&&(se(`Loading native viewability script ${"all"===n?"during fireImpressionTrackers":"during fireViewabilityTrackers"} for ${s.targetId}`),ir(s.adResponse.ads[0],e,s.targetId,i))}function ts(e,t){const n=t||va.document.body;Array.isArray(e)&&e.length?e.forEach(e=>{ce(n,e)}):"string"==typeof e&&e&&ce(n,e)}function ns(e){return!("string"!=typeof e||!e)}function as(e,t,n){"string"==typeof e&&e&&at({strategy:"WithContentAndAttributes",data:{content:e,attributes:{"data-anxtracker":t.targetId||""}},domElement:n})}function rs(e,t){const n=(e?.native?.clickTrackers||[]).concat(e?.native?.ortb?.link?.clicktrackers||[]);E.trackEvent({type:C},e.tagId);const a=Ir(t);a?.recordAdClick(),n&&n.length&&(se("Firing click trackers for",e.tagId),n.forEach(e=>{ce(va.document.body,e)}))}Yi.anq=Yi.anq||[],Yi.debug=Yi.debug||!1,Yi.dongle=Yi.dongle||void 0,Yi.loaded=!0,Yi.requests=Yi.requests||{},Yi.requests.keywords=Yi.requests.keywords||{},La(B.sR.hK),Yi.requests.tagsOnPageCount=Yi.requests.tagsOnPageCount||0,Yi.requests.waitOnTagsCount=Yi.requests.waitOnTagsCount||0,Yi.requests.showTagDefinedMap=Yi.requests.showTagDefinedMap||Ma(),Yi.perfTimings=Yi.perfTimings||{sdkInit:performance.now()},Yi.getPerfTimings=function(e){const t=[],n=Yi.perfTimings;if(!Yi.requests.tags||0===Object.keys(Yi.requests.tags).length)return ae("[AST Perf] No tags found to retrieve performance data."),n.sdkInit?[{sdkInit:n.sdkInit,status:"No tags defined."}]:[];if(e){if(!Yi.requests.tags[e])return ae(`[AST Perf] No tag found with targetId: ${e}`),{sdkInit:n.sdkInit,status:`No tag defined for targetId: ${e}`};const t=Yi.requests.tags[e],a={targetId:e,targetElement:t.wcElement||document.getElementById(e),flights:t.flights||[],invCode:t.invCode||"",...n};return t&&t.perfTimings?Object.assign(a,t.perfTimings):a.status="No specific timings recorded yet.",a}for(const e in Yi.requests.tags)if(Object.hasOwnProperty.call(Yi.requests.tags,e)){const a=Yi.requests.tags[e],r={targetId:e,targetElement:a.wcElement||document.getElementById(e),flights:a.flights||[],...n};a&&a.perfTimings?Object.assign(r,a.perfTimings):r.status="No specific timings recorded yet.",t.push(r)}return 0===t.length?(ae("[AST Perf] No performance data found for any tags."),n.sdkInit?[{sdkInit:n.sdkInit,status:"No tag timings found."}]:[]):t},Yi.highlightAd=function(e){if(se("Invoking apntag.highlightAd",arguments),E.trackCustomEvent({type:"apntag.highlightAd"}),e){const t=$a()[e];t&&(t.style.border="3px solid #e67300")}},K(window,"message",e=>{e.data&&e.data.eventName&&Object.values(B.eZ).includes(e.data.eventName)&&Yi.recordTagPerformanceEvent(e.data,e.data.targetId)}),Yi.anq.push=function(e){e.call()},Yi.setEndpoint=function(e,t){se("Invoking apntag.setEndpoint",arguments),E.trackCustomEvent({type:"apntag.setEndpoint"}),La(e,t)},Yi.setPageOpts=function(e){se("Invoking apntag.setPageOpts",arguments),E.trackCustomEvent({type:"apntag.setPageOpts",performance:performance.now()}),(e=>{if(e){if(e.member&&(apntag.requests.member=Number(e.member)),e.use1pEndpoint&&(apntag.requests.use1pEndpoint=!0),e.targetingParams&&(apntag.requests.targetingParams=e.targetingParams,ae("targetingParams will be deprecated soon. Please use keywords instead")),e.keywords&&(apntag.requests.keywords=e.keywords),e.user&&(apntag.requests.user=e.user),e.app&&(apntag.requests.app=e.app),e.device&&(apntag.requests.device=e.device),e.geoOverride){const t=function(e){const t=e.countryCode;if("string"!=typeof t||2!==t.length)return void ae("Ignoring geoOveride options, Invalid country code, it should be of type String and of 2 characters.");const n=e.zip;if(!("string"!=typeof n||n.length<1))return{countryCode:t.toUpperCase(),zip:n};ae("Ignoring geoOveride options, Invalid zip code, it should be of type String and of atleast 1 character.")}(e.geoOverride);t&&(apntag.requests.geoOverride=t)}if(e.site&&(apntag.requests.site=e.site),e.content&&(apntag.requests.content=e.content),e.disablePsa&&(apntag.requests.disablePsa=!0),apntag.requests.enableSafeFrame=!1,e.enableSafeFrame&&(ba(),apntag.requests.enableSafeFrame=!0),e.publisherId&&(apntag.requests.publisherId=e.publisherId),e.consentManagement&&(apntag.requests.consentManagement=e.consentManagement),e.auctionTimeout&&(apntag.requests.auctionTimeout=e.auctionTimeout),e.auctionDeadline&&(apntag.requests.auctionDeadline=e.auctionDeadline),e.enableMediationEvents&&(apntag.requests.enableMediationEvents=!0),e.us_privacy&&(F(e.us_privacy)?apntag.requests.us_privacy=e.us_privacy:ae("Ignoring us_privacy, it should be a string")),e.pageUrl&&(apntag.requests.pageUrlOverride=e.pageUrl),e.test&&(apntag.requests.test=!0),e.schain&&(apntag.requests.schainConfig=e.schain),e.dsa&&(apntag.requests.dsa=e.dsa),e.msft&&(apntag.requests.msft=e.msft),e.loadOutstreamUpgradeUrl&&(apntag.requests.loadOutstreamUpgradeUrl=e.loadOutstreamUpgradeUrl),e.trackingManagement){const t=e.trackingManagement;if(t.native&&t.native.loadViewabilityScriptAt){const e=F(t.native.loadViewabilityScriptAt)?t.native.loadViewabilityScriptAt.toLowerCase():null;!e||e!==B.nP.G.W&&e!==B.nP.G.D?ae('Ignoring trackingManagement.native.loadViewabilityScriptAt, it should be either "impression" or "adResponse"'):(apntag.requests.trackingManagement=apntag.requests.trackingManagement||{},apntag.requests.trackingManagement.native={loadViewScriptAt:e})}if(t.userSync){const e={};U(t.userSync.syncDelay)&&(e.syncDelay=t.userSync.syncDelay),"boolean"==typeof t.userSync.syncEnabled&&(e.syncEnabled=t.userSync.syncEnabled),U(t.userSync.publisherId)&&(e.publisherId=t.userSync.publisherId),U(t.userSync.sellerId)&&(e.sellerId=t.userSync.sellerId),apntag.requests.trackingManagement=apntag.requests.trackingManagement||{},apntag.requests.trackingManagement.userSync=e}}if(sr(e),e.renderingManagement){const t=e.renderingManagement;apntag.requests.renderingManagement=apntag.requests.renderingManagement||{},"boolean"==typeof t.insertWrapperDiv&&(apntag.requests.renderingManagement.insertWrapperDiv=t.insertWrapperDiv),"boolean"==typeof t.sandboxAdIframe&&(apntag.requests.renderingManagement.sandboxAdIframe=t.sandboxAdIframe),Array.isArray(t.sandboxAttributes)&&(apntag.requests.renderingManagement.sandboxAttributes=t.sandboxAttributes)}"disableExpander"in e&&(apntag.requests.disableExpander=e.disableExpander),"boolean"==typeof e.use3pMeasurementScripts&&(t=e.use3pMeasurementScripts,xa=!!t)}var t})(e)},Yi.defineTag=function(e){se("Invoking apntag.defineTag",arguments),w.addPlacementData(e.tagId,{placementId:e.tagId}),E.trackCustomEvent({type:"apntag.defineTag",performance:performance.now()},e.tagId);const t=function(e){const t=function(e){if(e.rid&&(apntag.requests.keywords.rid=e.rid),e.provider_id&&(apntag.requests.keywords.provider_id=e.provider_id),e.debug&&(apntag.debug=e.debug),e.astToolkit&&e.astDongle&&(apntag.requests.toolkit={enabled:!0,dongle:e.astDongle}),e.size)re("Size is deprecated, please use sizes instead.");else if(e.member?e.member=Number(e.member):e.member=apntag.requests.member,e.member||(e.member="none"),e.tagId||e.invCode&&e.member){if(e.sizeMapping&&!gr(e))return void re(`tag not mapped to any sizes for device width: ${e.targetId}`);try{const t=e.targetId,n=function(e,t){const n=e.member;return apntag.requests=apntag.requests||{},apntag.requests.tags=apntag.requests.tags||{},apntag.requests.utCalled=apntag.requests.utCalled||!1,apntag.requests.hasLeft=apntag.requests.hasLeft||!1,apntag.requests.cbCalled=apntag.requests.cbCalled||!1,apntag.requests.enableSafeFrame&&(e.enableSafeFrame=!0),e.safeframe=lr(ya)||{},me(e,"safeframeConfig")&&(me(e.safeframeConfig,"allowExpansionByPush")&&(e.safeframe.expansionByPush=e.safeframeConfig.allowExpansionByPush),me(e.safeframeConfig,"allowExpansionByOverlay")&&(e.safeframe.expansionByOverlay=e.safeframeConfig.allowExpansionByOverlay),me(e.safeframeConfig,"sandbox")&&(e.safeframe.sandbox=e.safeframeConfig.sandbox),me(e.safeframeConfig,"meta")&&(e.safeframe.meta=e.safeframeConfig.meta)),apntag.requests.tags[t]=e,apntag.requests.tags[t].utCalled=apntag.requests.tags[t].utCalled||!1,apntag.requests.tags[t].showTagCalled=apntag.requests.tags[t].showTagCalled||!1,apntag.requests.tags[t].displayed=apntag.requests.tags[t].displayed||!1,apntag.requests.tags[t].initialHeight=1,apntag.requests.tags[t].initialWidth=1,apntag.requests.tags[t].on=apntag.onEvent||void 0,apntag.requests.tags[t].off=apntag.offEvent||void 0,apntag.requests.tags[t].setSizes=apntag.setSizes||void 0,apntag.requests.tags[t].modifyTag=apntag.modifyTag||void 0,apntag.requests.trackingManagement?apntag.requests.tags[t].trackingManagement=apntag.requests.trackingManagement:(apntag.requests.tags[t].trackingManagement={native:{loadViewScriptAt:pr},mobileOmidImpTracking:!1},Te(or)),apntag.requests.tags[t].renderingManagement||(apntag.requests.tags[t].renderingManagement={}),["insertWrapperDiv","sandboxAdIframe","sandboxAttributes"].forEach(n=>{e.renderingManagement&&me(e.renderingManagement,n)?apntag.requests.tags[t].renderingManagement[n]=e.renderingManagement[n]:apntag.requests.renderingManagement&&me(apntag.requests.renderingManagement,n)&&(apntag.requests.tags[t].renderingManagement[n]=apntag.requests.renderingManagement[n])}),apntag.requests.tags[t].refresh=function(){return apntag.refresh(this.targetId)},apntag.requests.tags[t].setKeywords=function(e,t){return apntag.setKeywords(this.targetId,e,t)},ma[n]=typeof ma[n]===ur?[]:ma[n],ma[n].push(e.targetId),Ma()[e.targetId]&&(apntag.requests.tags[t].showTagCalled=!0),apntag.requests.tags[t]}(e,t);return ne(`defineTag called for: ${t}`),apntag.requests&&!0===apntag.requests.utCalled&&!apntag.requests.tags[t].utCalled&&ne("A placement was loaded after ut call was started. These ad calls will not be coordinated"),n}catch(e){re(`buildAdTagContainer: ${e.message}`)}}else re(`tagId or (invCode & memberId) should be defined for targetId: ${e.targetId}`)}(e);if(!t)return void re(`No ad will be requested for targetId: ${e.targetId}`);if(ha.push(t),fa[t.targetId])return fa[t.targetId];const n={targetId:t.targetId,on:t.on,off:t.off,modifyTag:t.modifyTag,setKeywords:t.setKeywords};return fa[t.targetId]=n,n}(e);return t},Yi.getTag=function(e){if(e&&!_e(e))return void re(`${e} is not defined.`,B.$9.Z);let t,n;return e?(n=Bi(e),t=Se(Yi.requests.tags[e],n)):(t={},Yi.requests.tags?Object.keys(Yi.requests.tags).forEach(e=>{n=Bi(e),t[e]=Se(Yi.requests.tags[e],n)}):ae("getTag is called before defineTag function, so the tag object will be empty.")),t},Yi.getAdWrap=function(e){if(se("Invoking apntag.getAdWrap",arguments),E.trackCustomEvent({type:"apntag.getAdWrap",tagId:e}),_e(e))return e&&Yi.requests.tags&&Yi.requests.tags[e]&&Yi.requests.tags[e].adWrap?Yi.requests.tags[e].adWrap:void 0;re(`the ${e} tag is not defined.`,B.$9.Z)},Yi.setSizes=function(e,t){se("Invoking apntag.setSizes",arguments),E.trackCustomEvent({type:"apntag.setSizes"},e),arguments.length<2&&(t=e,e=this.targetId),_e(e)?Yi.requests.tags[e].sizes=t:re(`the ${e} tag is not defined.`,B.$9.Z)},Yi.modifyTag=function(e,t){se("Invoking apntag.modifyTag",arguments),E.trackCustomEvent({type:"apntag.modifyTag"});const n={};arguments.length<2&&(t=e,e=this.targetId),_e(e)?((t.sizes||t.sizeMapping)&&gr(t,e),R(Yi.requests.tags[e],(e,t)=>{n[t]=e}),R(t,(e,t)=>{n[t]=e}),Yi.requests.tags[e]=n):re(`the ${e} tag is not defined.`,B.$9.Z)},Yi.setKeywords=function(e,t,n){se("Invoking apntag.setKeywords",arguments),E.trackCustomEvent({type:"apntag.setKeywords",targetId:e});const a={};"object"==typeof t&&null!==t?_e(e)?(R(Yi.requests.tags[e],(e,t)=>{a[t]=e}),a.keywords=a.keywords||{},"object"==typeof n&&null!==n&&!0===n.overrideKeyValue?R(t,(e,t)=>{a.keywords[t]=e}):R(t,(e,t)=>{me(a.keywords,t)?Array.isArray(a.keywords[t])?a.keywords[t]=a.keywords[t].concat(e):a.keywords[t]=[a.keywords[t]].concat(e):a.keywords[t]=e}),Yi.requests.tags[e]=a):re(`the ${e} tag is not defined.`,B.$9.Z):ae("unable to set keywords it should be an object")},Yi.onEvent=function(e,t,n){if(se("Invoking apntag.onEvent",arguments),2===arguments.length&&"function"==typeof t&&typeof this.targetId===Ji)n=t,t="*";else if(arguments.length<3&&(n=t,t=this.targetId,!_e(t)))return void re(`the ${t} tag is not defined.`,B.$9.Z);Pe.on(e,t,n)},Yi.offEvent=function(e,t,n){if(se("Invoking apntag.offEvent",arguments),1===arguments.length&&typeof this.targetId===Ji)t="*";else if(arguments.length<2&&(t=this.targetId,!_e(t)))return void re(`the ${t} tag is not defined.`,B.$9.Z);if(Array.isArray(e))for(let a=0;a<e.length;a++)Pe.off(e[a],t,n);else Pe.off(e,t,n)},Yi.loadTags=function(e){se("Invoking apntag.loadTags",arguments),E.trackCustomEvent({type:"apntag.loadTags",tagIds:e,performance:performance.now()}),Fi(e)},Yi.getAstSessionId=function(){se("Invoking apntag.getSessionId");const e=w.getSessionData().sessionUuid;return E.trackCustomEvent({type:"apntag.getSessionId"}),e},Yi.refresh=function(e){se("Invoking apntag.refresh",arguments),E.trackCustomEvent({type:"apntag.refresh",targetId:e,performance:performance.now()}),function(e){apntag.requests.utCalled=!1,apntag.requests.hasLeft=!1,apntag.requests.cbCalled=!1,apntag.requests.errorReported=!1,Vi(e),R(zi(e),e=>{e.utCalled=!1,e.displayed=!1,e.isMediated=!1,e.isBannerMediation=!1,e.isVideoMediation=!1,e.ad={},e.adTrackingId="",e.batchId=""});try{Fi()}catch(e){re(`refreshTags ${e.message}`)}}(fe(e))},Yi.clearRequest=function(e){se("Invoking apntag.clearRequest",e||arguments),E.trackCustomEvent({type:"apntag.clearRequest",targetId:e}),Ki(fe(e))},Yi.removeTag=function(e){const t=fe(e);t.forEach(e=>{Yi.requests.tags[e]&&(Yi.requests.tags[e].startRemove=!0)}),se("Invoking apntag.removeTag",e||arguments),E.trackCustomEvent({type:"apntag.removeTag",targetId:e}),Vi(t),Ki(t)},Yi.resizeAd=function(e,t,n={}){se("Invoking apntag.resizeAd",arguments),E.trackCustomEvent({type:"apntag.resizeAd",targetId:e}),function(e,t,n={}){let a=0,r=0;Array.isArray(t)&&2===t.length?(r=t[0],a=t[1]):re("resizeAd must be invoked with a (targetId,[width, height])");const i=$a()[e];if(!i)return void re(`Failed to find target for resizeAd : ${e}`);const{resizeAdParentDiv:s}=n,o=apntag.requests.tags[e].wcElement,d=Bi(e),c=ke(d),l=o?o.querySelector(`#${c}`):va.document.getElementById(c),u=apntag.requests.tags[e];if(!l)return void re(`Failed to find target for resizeAd: ${e}`);let p=!1;if("boolean"==typeof s?p=s:u&&"boolean"==typeof u.resizeAdParentDiv&&(p=u.resizeAdParentDiv),p&&(l.style.height=`${a}px`,l.style.width=`${r}px`,l.style.height=a,l.style.width=r),l.style.height=a,l.style.width=r,i.height=`${a}px`,i.width=`${r}px`,i.height=a,i.width=r,u&&!u.enableSafeFrame&&("none"!==l.style.display&&0===a&&0===r?(u.styleDisplay=l.style.display,l.style.display="none"):"none"===l.style.display&&0!==a&&0!==r&&(l.style.display=u.styleDisplay||"inline")),ne(`ResizeAd successful for targetId: ${e}`),u&&u.isMediated&&i.contentWindow){const e=ve(),t=`${e.location.protocol}//${e.location.host}`,n={name:"resizeAd",size:[r,a]};i.contentWindow.postMessage(JSON.stringify(n),t)}}(e,t,n)},Yi.enableCookieSet=function(){var e,t,n;ae("apntag.enableCookieSet has been depreciated"),E.trackCustomEvent({type:"apntag.enableCookieSet"}),e=window.addEventListener?"addEventListener":"attachEvent",t=window[e],n="attachEvent"==e?"onload":"load","complete"===document.readyState||"interactive"===document.readyState?s():t(n,function(e){s()},!1)},Yi.collapseAd=function(e,t,n){se("Invoking apntag.collapseAd",arguments),ae("apntag.collapseAd has been depreciated, Please use apntag.resizeAd"),E.trackCustomEvent({type:"apntag.collapseAd",targetId:e});let a=0,r=0;const i=Bi(e);if(!i)return void re(`CollapseAd failed to find targetId : ${e}`);const s=ke(i);typeof t===Xi&&(a=t),typeof n===Xi&&(r=n);const o=va.document.getElementById(s);if(null===o)return void re(`CollapseAd failed to find ad div : ${e}`);Yi.resizeAd(e,[r,a]),o.style.height=a,o.style.width=r,o.style.display="none";const d=Yi.requests.tags[e],c=rr(d.adResponse);Pe.emit(B.qY.COLLAPSE,e,c)},Yi.showTag=function(e,t){let n;if(se("Invoking apntag.showTag",arguments),"object"==typeof t&&(t.hasOwnProperty("iframeWindow")||t.hasOwnProperty("wcElement"))){if(n=t.wcElement instanceof Element&&t.wcElement,t.wcElement&&!n)return void re(`wcElement is not a DOM element : ${e}`);t=t.iframeWindow||va}else t=t||va;const a=Yi.requests.tags&&Yi.requests.tags[e];E.trackCustomEvent({type:"apntag.showTag",divId:e,isWebComponent:!!n,performance:performance.now(),batchId:a?.batchId,adTrackingId:a?.adTrackingId}),function(e,t,n){if(ne(`showTag called for ${e}`),kr({targetId:e,wcElement:n}),Ma()[e]=!0,_e(e)){const a=apntag.requests.tags[e];if(a.showTagCalled=!0,a.curWindow=t,a.wcElement=n,a.displayed)return void ae(`Attempting to display ad that is already displayed, will not render this ad again: ${e}`);if(apntag.requests.utCalled)if(a.adResponse){const e=Lr(a,ya,$a(),ba);ga.push(e),apntag.requests.hasLeft&&Ce()}else apntag.requests.checkDisplay=!0;else ae(`${e} : showTag() called before ad request was made. This placement might not display if a subsequent loadTags() call is not made`)}else ne(`the ${e} tag was loaded before the ad placement was available.`,B.$9.Z)}(e,t,n)},Yi.setPageTargeting=function(e,t){se("Invoking apntag.setPageTargeting",arguments),E.trackCustomEvent({type:"apntag.setPageTargeting"}),Yi.requests.targetingParams&&e&&t&&(Yi.requests.targetingParams[e]=t)},Yi.getPageTargeting=function(e){if(se("Invoking apntag.getPageTargeting",arguments),E.trackCustomEvent({type:"apntag.getPageTargeting"}),Yi.requests.targetingParams&&e)return Yi.requests.targetingParams[e]},Yi.clearPageTargeting=function(e){se("Invoking apntag.clearPageTargeting",arguments),E.trackCustomEvent({type:"apntag.clearPageTargeting"}),Yi.requests.targetingParams&&e&&delete Yi.requests.targetingParams[e]},Yi.enableDebug=function(){Yi.debug=!0,se("Invoking apntag.enableDebug",arguments),E.trackCustomEvent({type:"apntag.enableDebug"})},Yi.disableDebug=function(){se("Invoking apntag.disableDebug",arguments),E.trackCustomEvent({type:"apntag.disableDebug"}),Yi.debug=!1},Yi.notify=function(e,t,n){e?(E.trackCustomEvent({type:"apntag.notify",targetId:n}),yt.invokeNotify(e,t,n)):re("apntag.notify must be called with `messageType`")},Yi.registerRenderer=function(e,t){se("Invoking apntag.registerRenderer",arguments),E.trackCustomEvent({type:"apntag.registerRenderer"}),yt.registerRenderer(e,t)},Yi.getAstVersion=function(){return se("Invoking apntag.getAstVersion"),"1.10.50"},Yi.recordErrorEvent=function(e,t){se("Invoking apntag.recordErrorEvent",arguments),"string"==typeof e&&(e=new Error(e)),S.trackCriticalError("recordErrorEvent",e);const n=Yi.requests.tags[t],a=rr(n.adResponse),r=Me(e.message,t,e,200);Pe.emit(B.qY.ERROR,t,r,a)},Yi.recordTagPerformanceEvent=function(e,t){if(se("Invoking apntag.recordTagPerformanceEvent",arguments),Object.values(B.eZ).includes(e.eventName)){const n=Yi.requests.tags[t],a=rr(n.adResponse);E.trackCustomEvent({type:e.eventName,...e,performance:performance.now(),adTrackingId:n?.adTrackingId},a.tagId)}else se("Unhandled performance event",arguments)},Yi.handleCb=function(e,t,n,a){se("Invoking apntag.handleCb",arguments);try{Yr(e,t,n)}catch(e){const t=e.message?e.message:e;re("Internal AST error : ",e),Oi(t,void 0,a,200,B.qY.BAD_REQUEST,e)}},Yi.emitEvent=function(e,t,n){if(n&&n.content_source&&!Yi.requests.enableMediationEvents)return;se("Invoking apntag.emitEvent",arguments);const a=Qi(e);if("impression"===t&&E.trackEvent({type:_,data:{enableSafeFrame:!(!a.enableSafeFrame&&!a.alwaysUseXDomainIframe),batchId:a.batchId,performance:performance.now(),adTrackingId:a.adTrackingId}},a.tagId),"click"===t){const e=Ir(a.wcElement||va.document.getElementById(a.targetId));e?.recordAdClick(),E.trackEvent({type:C},a.tagId)}!function(e,t,n){const a=Qi(e),r=function(e,t,n){const a=e.adResponse&&e.adResponse.ads&&e.adResponse.ads.length,r=a&&e.adResponse.ads[a-1].ad_type===B.Ve.s6;let i;return i=e.isMediated&&r&&!n?rr(e.adResponse,e.adResponse.ads[a-1]):rr(e.adResponse,n),i}(a,0,n);var i;ne(`handling event for DOM ID:  ${r.targetId} eventType : ${t}`),(t=t===B.Sz.S?"adLoaded":t)===B.qY.LOADED||t===B.qY.LOADED_MEDIATED||t===B.qY.NO_BID_MEDIATED?(Pe.emit(t,r.targetId,r),t===B.qY.LOADED_MEDIATED&&E.trackCustomEvent({type:B.qY.LOADED_MEDIATED},r.tagId),t===B.qY.NO_BID_MEDIATED&&E.trackCustomEvent({type:B.qY.NO_BID_MEDIATED},r.tagId)):Pe.emit(t,r.targetId),t===B.qY.NO_BID&&a.isMediated&&(i=a.adResponse,ce(window.document.body,i[Zi],i.uuid))}(e,t,n)},Yi.getAdMarkup=function(e,t){if(E.trackCustomEvent({type:"apntag.getAdMarkup",targetId:e}),Yi.requests.tags&&Yi.requests.tags[e]){const n=Yi.requests.tags[e];if(n.uuid===t)return n.adResponse.ads}},Yi.setSafeFrameConfig=function(e){E.trackCustomEvent({type:"apntag.setSafeFrameConfig"}),me(e,"allowExpansionByPush")&&(ya.expansionByPush=e.allowExpansionByPush),me(e,"allowExpansionByOverlay")&&(ya.expansionByOverlay=e.allowExpansionByOverlay),me(e,"sandbox")&&(ya.sandbox=e.sandbox),me(e,"meta")&&(ya.meta=e.meta)},Yi.setTrkjsEndpoint=function(e){se("Invoking apntag.setTrkjsEndpoint",arguments),E.trackCustomEvent({type:"apntag.setTrkjsEndpoint",trkjsUrl:e}),(e=>{const t=ve();if("string"==typeof e&&e.includes("https://"))try{const n=new URL(t.location.href);n.origin.match(wa)||n.origin.match(Ia)?(Ca=e,ne(`Setting trk.js URL to: ${Ca}`)):ae(`Attempted to override the trk.js URL on an unsupported domain.  Referer was ${t.location.href}`)}catch(e){ae("Encountered an issue when reading the referer of the page",e)}else ae(`Need to set a full secure URL for trk.js; attempted value was: ${e}`)})(e)},Yi.setDvJsOverride=function(e){se("Invoking apntag.setDvJsOverride",arguments),E.trackCustomEvent({type:"apntag.setDvJsOverride",dvJsUrl:e}),(e=>{let t=null;const n=ve();if("string"==typeof e)try{const a=new URL(n.location.href);"https:"===a.protocol&&(a.origin.match(wa)||a.origin.match(Ia))?-1!==e.indexOf("{version}")?(Aa=e,ne(`Setting DV.js URL to: ${Aa}`)):(t=`DV template doesn't contain {version} placeholder; attempted value was: ${e}`,ae(t)):(t=`Attempted to override the DV.js URL on an unsupported domain. Referer was ${n.location.href}`,ae(t))}catch(e){t=`Encountered an issue when reading the referer of the page: ${e.message}`,ae(t,e)}else t=`Provided DV URL template is not a string; attempted value was: ${e}`,ae(t);null!==t&&S.trackCriticalError(B.Gy.L.Qs,{message:t,debugData:{referer:n.location.href,dvScriptUrl:e}})})(e)},Yi.fireImpressionTrackers=function(e,t){e?e.impressionTrackersFired?se("Impression trackers already fired for",e.tagId):e.jsTrackersFired?se("JS trackers already fired for",e.tagId):(se("Invoking apntag.fireImpressionTrackers",arguments),e.impressionTrackersFired=!0,e.jsTrackersFired=!0,es(e,t)):re("adObj is required for apntag.fireImpressionTrackers")},Yi.loadImpressionTrackerUrls=function(e,t){return e?e.impressionTrackersFired?void se("Impression trackers already fired for",e.tagId):(se("Invoking apntag.loadImpressionTrackerUrls",arguments),e.impressionTrackersFired=!0,es(e,t,"imp"),!0):(re("adObj is required for apntag.loadImpressionTrackerUrls"),!1)},Yi.loadJSTrackers=function(e,t){return e?e.jsTrackersFired?void se("JS trackers already fired for",e.tagId):(se("Invoking apntag.loadJSTrackers",arguments),e.jsTrackersFired=!0,es(e,t,"js"),!0):(re("adObj is required for apntag.loadJSTrackers"),!1)},Yi.loadViewabilityScripts=function(e,t){return e?e.viewabilityScriptsLoaded?void se("Viewability scripts already loaded for",e.tagId):(e.viewabilityScriptsLoaded=!0,se("Invoking apntag.loadViewabilityScripts",arguments),es(e,t,"view"),!0):(re("adObj is required for apntag.loadViewabilityScripts"),!1)},Yi.attachClickTrackers=function(e,t){const n=t instanceof Element,a=n?t.id:t,r=n?t:document.getElementById(t);r?(se("Attaching click track handler to",a),K(r,"click",()=>{rs(e,r)})):re(`HTML element with id ${a} not found, click trackers not attached`)},Yi.loadClickTrackerUrls=function(e,t){const n=t instanceof Element?t:document.getElementById(t);return se("Invoking apntag.loadClickTrackerUrls",arguments),rs(e,n),!0},Yi.checkAdAvailable=function(e){return E.trackCustomEvent({type:"apntag.checkAdAvailable",targetId:e}),function(e){const t=apntag.requests.tags[e],n=t&&t.adResponse,a=t&&t.utCalled&&!t.showTagCalled&&n&&rr(n);return function(e){a&&(n.nobid||e.resolve(a),n.nobid&&e.reject())}}(e)},Yi.handleMediationBid=function(e){E.trackCustomEvent({type:"apntag.handleMediationBid",targetId:e});const t=Qi(e);let n=[];try{const e=t.adResponse.ads;n=e[e.length-1]}catch(e){se("Trying to get mediated adresponse for renderer",e)}function a(){Yi.resizeAd(e,[0,0])}if(n.renderer_url)t.displayed=!1,n.targetId=e,n.ad_type===Gi&&(function(e){try{Yi.requests.tags[e].adResponse.ads=[n]}catch(e){se("Trying to set adresponse for video renderer",e)}}(t.targetId),t.enableSafeFrame&&function(e){const t=lt.getInstance().getIframe(e);t&&t.iframe&&(t.iframe.allow="autoplay",t.iframe.style="overflow:hidden")}(t.targetId)),t.enableSafeFrame?function(e){{const t=lt.getInstance().getIframe(e.targetId).iframe.contentWindow;delete e.curWindow;const n={status:"nativeAssembly",targetId:e.targetId};Et(t,JSON.stringify(n),Ee())}}(t):yt.loadRenderer(t,n),a();else{const r=rr(t.adResponse,n);r.adType===Hi&&a(),Pe.emit(B.qY.LOADED,e,r)}};try{const e=window.PerformanceObserver;e&&new e(function(e){e.getEntries().forEach(e=>{const t={};Object.assign(t,{entryType:e.entryType,name:e.name,startTime:e.startTime,perfTimeOrigin:performance.timeOrigin,duration:e.duration,domComplete:e.domComplete,domContentLoadedEventEnd:e.domContentLoadedEventEnd,domContentLoadedEventStart:e.domContentLoadedEventStart,domInteractive:e.domInteractive,loadEventEnd:e.loadEventEnd,loadEventStart:e.loadEventStart,redirectCount:e.redirectCount,type:e.type,unloadEventEnd:e.unloadEventEnd,unloadEventStart:e.unloadEventStart}),E.trackCustomEvent({type:"perfNavigation",data:t})})}).observe({type:"navigation",buffered:!0})}catch(e){re(`Unable to load Navigation Observer ${e}`,B.$9.Z)}ie("AST library loaded"),function(){for(let e=0;e<Yi.anq.length;e++)typeof Yi.anq[e].called===Ji&&(Yi.anq[e].call(),Yi.anq[e].called=!0)}(),Yi.requests.checkDisplay||function(e){let t=!1;function n(){t||(t=!0,e())}if(document.addEventListener)document.addEventListener("DOMContentLoaded",n,!1);else if(document.attachEvent){let e;try{e=null!==window.frameElement}catch(e){}if(document.documentElement.doScroll&&!e){const e=function(){if(!t)try{document.documentElement.doScroll("left"),n()}catch(t){setTimeout(e,10)}};e()}document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&n()})}if(window.addEventListener)window.addEventListener("load",n,!1);else if(window.attachEvent)window.attachEvent("onload",n);else{const e=window.onload;window.onload=function(){e&&e(),n()}}}(Ce),"function"==typeof window.define&&window.define.amd&&window.define("appnexusAst",[],()=>window.apntag)})();